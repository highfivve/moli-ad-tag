"use strict";(self.webpackChunkthe_publisher_ad_tag=self.webpackChunkthe_publisher_ad_tag||[]).push([[2653],{5210:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>l,contentTitle:()=>r,default:()=>h,frontMatter:()=>o,metadata:()=>s,toc:()=>d});const s=JSON.parse('{"id":"guides/performance-optimization","title":"Performance Optimization","description":"This guide covers performance optimization techniques for Moli ad tag integration. Learn how to minimize the impact of ads on your website\'s performance while maximizing revenue.","source":"@site/docs/guides/performance-optimization.md","sourceDirName":"guides","slug":"/guides/performance-optimization","permalink":"/moli-ad-tag/docs/guides/performance-optimization","draft":false,"unlisted":false,"editUrl":"https://github.com/highfivve/moli-ad-tag/docs/guides/performance-optimization.md","tags":[],"version":"current","frontMatter":{"title":"Performance Optimization"},"sidebar":"docs","previous":{"title":"Single Page Applications","permalink":"/moli-ad-tag/docs/guides/single-page-applications"},"next":{"title":"Troubleshooting","permalink":"/moli-ad-tag/docs/guides/troubleshooting"}}');var t=i(4848),a=i(8453);const o={title:"Performance Optimization"},r=void 0,l={},d=[{value:"Overview",id:"overview",level:2},{value:"Script Loading Optimization",id:"script-loading-optimization",level:2},{value:"Asynchronous Loading",id:"asynchronous-loading",level:3},{value:"Preload Critical Resources",id:"preload-critical-resources",level:3},{value:"DNS Prefetching",id:"dns-prefetching",level:3},{value:"Ad Slot Optimization",id:"ad-slot-optimization",level:2},{value:"Reserve Space for Ads",id:"reserve-space-for-ads",level:3},{value:"Use CSS Containment",id:"use-css-containment",level:3},{value:"Optimize Ad Container Sizing",id:"optimize-ad-container-sizing",level:3},{value:"Lazy Loading",id:"lazy-loading",level:2},{value:"Lazy Loading Module",id:"lazy-loading-module",level:3},{value:"React Lazy Loading Component",id:"react-lazy-loading-component",level:3},{value:"Timing Optimization",id:"timing-optimization",level:2},{value:"Delay Non-Critical Ads",id:"delay-non-critical-ads",level:3},{value:"User Interaction Triggers",id:"user-interaction-triggers",level:3},{value:"Core Web Vitals Optimization",id:"core-web-vitals-optimization",level:2},{value:"Cumulative Layout Shift (CLS)",id:"cumulative-layout-shift-cls",level:3},{value:"First Input Delay (FID)",id:"first-input-delay-fid",level:3},{value:"Best Practices Summary",id:"best-practices-summary",level:2},{value:"1. Script Loading",id:"1-script-loading",level:3},{value:"2. Ad Slot Management",id:"2-ad-slot-management",level:3},{value:"3. Timing Optimization",id:"3-timing-optimization",level:3},{value:"4. Performance Monitoring",id:"4-performance-monitoring",level:3},{value:"Tools and Resources",id:"tools-and-resources",level:2},{value:"Performance Testing Tools",id:"performance-testing-tools",level:3},{value:"Monitoring Tools",id:"monitoring-tools",level:3},{value:"Browser DevTools",id:"browser-devtools",level:3}];function c(e){const n={a:"a",admonition:"admonition",code:"code",h2:"h2",h3:"h3",li:"li",p:"p",pre:"pre",ul:"ul",...(0,a.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.p,{children:"This guide covers performance optimization techniques for Moli ad tag integration. Learn how to minimize the impact of ads on your website's performance while maximizing revenue."}),"\n",(0,t.jsx)(n.h2,{id:"overview",children:"Overview"}),"\n",(0,t.jsx)(n.p,{children:"Ad tags can significantly impact website performance. This guide provides strategies to:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Minimize page load time impact"}),"\n",(0,t.jsx)(n.li,{children:"Optimize ad loading and rendering"}),"\n",(0,t.jsx)(n.li,{children:"Reduce layout shifts"}),"\n",(0,t.jsx)(n.li,{children:"Improve Core Web Vitals"}),"\n",(0,t.jsx)(n.li,{children:"Maximize ad viewability and revenue"}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"script-loading-optimization",children:"Script Loading Optimization"}),"\n",(0,t.jsx)(n.h3,{id:"asynchronous-loading",children:"Asynchronous Loading"}),"\n",(0,t.jsx)(n.p,{children:"Always load Moli scripts asynchronously to prevent blocking page rendering:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-html",children:'\x3c!-- \u2705 Good - Asynchronous loading --\x3e\n<script src="https://[publisher-name].h5v.eu/[version]/moli_[hash].js" async><\/script>\n<script src="https://www.googletagservices.com/tag/js/gpt.js" async><\/script>\n\n\x3c!-- \u274c Avoid - Synchronous loading --\x3e\n<script src="https://[publisher-name].h5v.eu/[version]/moli_[hash].js"><\/script>\n<script src="https://www.googletagservices.com/tag/js/gpt.js"><\/script>\n'})}),"\n",(0,t.jsx)(n.h3,{id:"preload-critical-resources",children:"Preload Critical Resources"}),"\n",(0,t.jsx)(n.p,{children:"Preload critical ad resources for better performance:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-html",children:'<head>\n  \x3c!-- Preload critical ad resources --\x3e\n  <link rel="preload" href="https://[publisher-name].h5v.eu/[version]/moli_[hash].js" as="script">\n  <link rel="preload" href="https://www.googletagservices.com/tag/js/gpt.js" as="script">\n  \n  \x3c!-- Preconnect to ad domains --\x3e\n  <link rel="preconnect" href="https://securepubads.g.doubleclick.net">\n  <link rel="preconnect" href="https://www.googletagservices.com">\n  <link rel="preconnect" href="https://[publisher-name].h5v.eu">\n</head>\n'})}),"\n",(0,t.jsx)(n.h3,{id:"dns-prefetching",children:"DNS Prefetching"}),"\n",(0,t.jsx)(n.p,{children:"Prefetch DNS for ad-related domains:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-html",children:'<head>\n  \x3c!-- DNS prefetch for ad domains --\x3e\n  <link rel="dns-prefetch" href="//securepubads.g.doubleclick.net">\n  <link rel="dns-prefetch" href="//www.googletagservices.com">\n  <link rel="dns-prefetch" href="//[publisher-name].h5v.eu">\n  <link rel="dns-prefetch" href="//prebid.a-mo.net">\n  <link rel="dns-prefetch" href="//aax.amazon-adsystem.com">\n</head>\n'})}),"\n",(0,t.jsx)(n.h2,{id:"ad-slot-optimization",children:"Ad Slot Optimization"}),"\n",(0,t.jsx)(n.h3,{id:"reserve-space-for-ads",children:"Reserve Space for Ads"}),"\n",(0,t.jsx)(n.p,{children:"Reserve space for ads to prevent layout shifts:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-css",children:"/* Reserve space for common ad sizes */\n.ad-container {\n  min-height: 250px; /* Reserve space for 300x250 */\n  background: #f0f0f0; /* Placeholder background */\n  display: flex;\n  align-items: center;\n  justify-content: center;\n}\n\n/* Responsive ad containers */\n.header-ad {\n  min-height: 90px; /* Mobile */\n}\n\n@media (min-width: 768px) {\n  .header-ad {\n    min-height: 250px; /* Desktop */\n  }\n}\n\n.sidebar-ad {\n  min-height: 600px; /* 300x600 */\n}\n\n.content-ad {\n  min-height: 250px; /* 300x250 */\n}\n"})}),"\n",(0,t.jsx)(n.h3,{id:"use-css-containment",children:"Use CSS Containment"}),"\n",(0,t.jsx)(n.p,{children:"Use CSS containment to isolate ad rendering:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-css",children:".ad-container {\n  contain: layout style paint;\n  min-height: 250px;\n  overflow: hidden;\n}\n"})}),"\n",(0,t.jsx)(n.h3,{id:"optimize-ad-container-sizing",children:"Optimize Ad Container Sizing"}),"\n",(0,t.jsx)(n.p,{children:"Use responsive sizing to match ad content:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-css",children:"/* Responsive ad sizing */\n.ad-responsive {\n  width: 100%;\n  height: auto;\n  min-height: 250px;\n}\n\n/* Specific ad sizes */\n.ad-300x250 {\n  width: 300px;\n  height: 250px;\n}\n\n.ad-728x90 {\n  width: 728px;\n  height: 90px;\n}\n\n/* Mobile-first responsive */\n@media (max-width: 768px) {\n  .ad-728x90 {\n    width: 320px;\n    height: 50px;\n  }\n}\n"})}),"\n",(0,t.jsx)(n.h2,{id:"lazy-loading",children:"Lazy Loading"}),"\n",(0,t.jsx)(n.p,{children:"Lazy loading is a technique to load ad slots when they are about to become visible.\nThis has a lot of positive effects, like"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"lower load during page load as fewer ads are being loaded"}),"\n",(0,t.jsx)(n.li,{children:"higher viewability for ad slots, as the likelyhood increases the slot is seen by the the user"}),"\n",(0,t.jsx)(n.li,{children:"higher CPMs and fill rates, due to better viewability metrics"}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:"This however comes at a cost. There are now less ad requests being made and thus less opportunities to serve ads.\nMake sure to test properly, which strategy works best."}),"\n",(0,t.jsx)(n.admonition,{type:"note",children:(0,t.jsxs)(n.p,{children:["Slots need to have the loading behaviour ",(0,t.jsx)(n.code,{children:"manual"})," to be loaded manually.\nOr you need to refresh them with ",(0,t.jsx)(n.code,{children:"refreshAdSlot('id-of-slot', { loaded: 'eager' })"}),"."]})}),"\n",(0,t.jsx)(n.h3,{id:"lazy-loading-module",children:"Lazy Loading Module"}),"\n",(0,t.jsxs)(n.p,{children:["The ",(0,t.jsx)(n.a,{href:"/moli-ad-tag/docs/modules/lazy-load",children:"Lazy Load Module"})," offers various configuration options to make a slot lazy."]}),"\n",(0,t.jsx)(n.h3,{id:"react-lazy-loading-component",children:"React Lazy Loading Component"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-tsx",children:"import React, { useEffect, useRef, useState } from 'react';\n\ninterface LazyAdSlotProps {\n  id: string;\n  className?: string;\n  threshold?: number;\n  rootMargin?: string;\n}\n\nconst LazyAdSlot: React.FC<LazyAdSlotProps> = ({ \n  id, \n  className, \n  threshold = 0.1, \n  rootMargin = '50px' \n}) => {\n  const [isVisible, setIsVisible] = useState(false);\n  const [isLoaded, setIsLoaded] = useState(false);\n  const ref = useRef<HTMLDivElement>(null);\n\n  useEffect(() => {\n    const observer = new IntersectionObserver(\n      ([entry]) => {\n        if (entry.isIntersecting && !isLoaded) {\n          setIsVisible(true);\n          setIsLoaded(true);\n          \n          // Load the ad\n          window.moli.que.push(function(moliAdTag) {\n            moliAdTag.refreshAdSlot(id);\n          });\n        }\n      },\n      { threshold, rootMargin }\n    );\n\n    if (ref.current) {\n      observer.observe(ref.current);\n    }\n\n    return () => observer.disconnect();\n  }, [id, isLoaded, threshold, rootMargin]);\n\n  return (\n    <div ref={ref} className={className}>\n      {isVisible && <div id={id} />}\n      {!isVisible && (\n        <div className=\"ad-placeholder\">\n          <div className=\"loading-spinner\" />\n        </div>\n      )}\n    </div>\n  );\n};\n\nexport default LazyAdSlot;\n"})}),"\n",(0,t.jsx)(n.h2,{id:"timing-optimization",children:"Timing Optimization"}),"\n",(0,t.jsx)(n.h3,{id:"delay-non-critical-ads",children:"Delay Non-Critical Ads"}),"\n",(0,t.jsx)(n.p,{children:"Delay loading of below-the-fold ads:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-ts",children:"// Delay loading of non-critical ads\nconst loadAdsWithDelay = () => {\n  // Load above-the-fold ads immediately\n  const aboveFoldAds = ['header-ad', 'top-content-ad'];\n  \n  aboveFoldAds.forEach(adId => {\n    window.moli.que.push(function(moliAdTag) {\n      moliAdTag.refreshAdSlot(adId);\n    });\n  });\n  \n  // Delay below-the-fold ads\n  setTimeout(() => {\n    const belowFoldAds = ['sidebar-ad', 'footer-ad', 'bottom-content-ad'];\n    \n    belowFoldAds.forEach(adId => {\n      window.moli.que.push(function(moliAdTag) {\n        moliAdTag.refreshAdSlot(adId);\n      });\n    });\n  }, 2000); // 2 second delay\n};\n"})}),"\n",(0,t.jsx)(n.h3,{id:"user-interaction-triggers",children:"User Interaction Triggers"}),"\n",(0,t.jsx)(n.p,{children:"Load ads on user interaction:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-ts",children:"// Load ads on user interaction\nconst loadAdsOnInteraction = () => {\n  const interactionEvents = ['scroll', 'click', 'touchstart'];\n  let hasInteracted = false;\n  \n  const loadDelayedAds = () => {\n    if (hasInteracted) return;\n    \n    hasInteracted = true;\n    \n    // Load delayed ads\n    const delayedAds = ['sidebar-ad', 'footer-ad'];\n    delayedAds.forEach(adId => {\n      window.moli.que.push(function(moliAdTag) {\n        moliAdTag.refreshAdSlot(adId);\n      });\n    });\n  };\n  \n  interactionEvents.forEach(event => {\n    window.addEventListener(event, loadDelayedAds, { \n      once: true, \n      passive: true \n    });\n  });\n  \n  // Fallback: load after 5 seconds\n  setTimeout(loadDelayedAds, 5000);\n};\n"})}),"\n",(0,t.jsx)(n.h2,{id:"core-web-vitals-optimization",children:"Core Web Vitals Optimization"}),"\n",(0,t.jsx)(n.h3,{id:"cumulative-layout-shift-cls",children:"Cumulative Layout Shift (CLS)"}),"\n",(0,t.jsx)(n.p,{children:"Minimize layout shifts caused by ads:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-css",children:"/* Prevent layout shifts */\n.ad-container {\n  /* Reserve space */\n  min-height: 250px;\n  \n  /* Prevent layout shifts */\n  contain: layout;\n  \n  /* Smooth transitions */\n  transition: height 0.3s ease;\n}\n\n/* Hide ads until loaded */\n.ad-container:empty {\n  display: none;\n}\n\n/* Show ads when content is ready */\n.ad-container:not(:empty) {\n  display: block;\n}\n"})}),"\n",(0,t.jsx)(n.h3,{id:"first-input-delay-fid",children:"First Input Delay (FID)"}),"\n",(0,t.jsx)(n.p,{children:"Minimize impact on user interactions:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-ts",children:"// Optimize for FID\nconst optimizeFID = () => {\n  // Use requestIdleCallback for non-critical operations\n  requestIdleCallback(() => {\n    window.moli.que.push(function(moliAdTag) {\n      // Set up targeting and request ads\n      moliAdTag.setTargeting('page_type', getPageType());\n      moliAdTag.requestAds();\n    });\n  });\n};\n"})}),"\n",(0,t.jsx)(n.h2,{id:"best-practices-summary",children:"Best Practices Summary"}),"\n",(0,t.jsx)(n.h3,{id:"1-script-loading",children:"1. Script Loading"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Load scripts asynchronously"}),"\n",(0,t.jsx)(n.li,{children:"Use preload and preconnect"}),"\n",(0,t.jsx)(n.li,{children:"DNS prefetch ad domains"}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"2-ad-slot-management",children:"2. Ad Slot Management"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Reserve space for ads"}),"\n",(0,t.jsx)(n.li,{children:"Use CSS containment"}),"\n",(0,t.jsx)(n.li,{children:"Implement lazy loading"}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"3-timing-optimization",children:"3. Timing Optimization"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Delay non-critical ads"}),"\n",(0,t.jsx)(n.li,{children:"Use user interaction triggers"}),"\n",(0,t.jsx)(n.li,{children:"Batch ad requests"}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"4-performance-monitoring",children:"4. Performance Monitoring"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Monitor Core Web Vitals"}),"\n",(0,t.jsx)(n.li,{children:"Track ad performance"}),"\n",(0,t.jsx)(n.li,{children:"Optimize based on metrics"}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"tools-and-resources",children:"Tools and Resources"}),"\n",(0,t.jsx)(n.h3,{id:"performance-testing-tools",children:"Performance Testing Tools"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.a,{href:"https://pagespeed.web.dev/",children:"Google PageSpeed Insights"})}),"\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.a,{href:"https://www.webpagetest.org/",children:"WebPageTest"})}),"\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.a,{href:"https://developers.google.com/web/tools/lighthouse",children:"Lighthouse"})}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"monitoring-tools",children:"Monitoring Tools"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.a,{href:"https://analytics.google.com/",children:"Google Analytics"})}),"\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.a,{href:"https://newrelic.com/",children:"New Relic"})}),"\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.a,{href:"https://www.datadoghq.com/",children:"DataDog"})}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"browser-devtools",children:"Browser DevTools"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Performance tab for timing analysis"}),"\n",(0,t.jsx)(n.li,{children:"Network tab for request optimization"}),"\n",(0,t.jsx)(n.li,{children:"Memory tab for leak detection"}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,a.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(c,{...e})}):c(e)}},8453:(e,n,i)=>{i.d(n,{R:()=>o,x:()=>r});var s=i(6540);const t={},a=s.createContext(t);function o(e){const n=s.useContext(a);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function r(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:o(e.components),s.createElement(a.Provider,{value:n},e.children)}}}]);