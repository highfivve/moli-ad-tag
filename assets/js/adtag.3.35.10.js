(()=>{"use strict";var e={2:function(e,t,r){var i=this&&this.__createBinding||(Object.create?function(e,t,r,i){void 0===i&&(i=r),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,i){void 0===i&&(i=r),e[i]=t[r]}),o=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&i(t,e,r);return o(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.a9RequestBids=t.a9ClearTargetingStep=t.a9PublisherAudiences=t.a9Configure=t.a9Init=void 0;const n=r(157),a=r(569),d=r(255),l=r(793),c=r(879);var u=c.tcfapi.responses.TCPurpose;const g=s(r(643)),p=e=>!!e.moliSlot.a9,f=e=>!e.gdprApplies||e.vendor.consents[793]&&[u.STORE_INFORMATION_ON_DEVICE,u.SELECT_BASIC_ADS,u.CREATE_PERSONALISED_ADS_PROFILE,u.SELECT_PERSONALISED_ADS,u.MEASURE_AD_PERFORMANCE,u.APPLY_MARKET_RESEARCH,u.DEVELOP_IMPROVE_PRODUCTS].every((t=>e.purpose.consents[t]));t.a9Init=(e,t)=>n.mkInitStep("a9-init",(r=>new Promise((i=>{r.window.apstag=r.window.apstag||{_Q:[],init:function(){r.window.apstag._Q.push(["i",arguments])},fetchBids:function(){r.window.apstag._Q.push(["f",arguments])},setDisplayBids:function(){},targetingKeys:function(){},dpa:function(){r.window.apstag._Q.push(["di",arguments])},rpa:function(){r.window.apstag._Q.push(["ri",arguments])},upa:function(){r.window.apstag._Q.push(["ui",arguments])}},f(r.tcData)&&t.loadScript({name:"A9",loadMethod:a.AssetLoadMethod.TAG,assetUrl:e.scriptUrl?e.scriptUrl:"//c.amazon-adsystem.com/aax2/apstag.js"}),i()})))),t.a9Configure=e=>n.mkConfigureStep("a9-configure",((t,r)=>new Promise((r=>{t.window.apstag.init({pubID:e.pubID,adServer:"googletag",bidTimeout:e.timeout,gdpr:{cmpTimeout:e.cmpTimeout}}),r()})))),t.a9PublisherAudiences=e=>n.mkConfigureStepOnce("a9-publisher-audiences",((t,r)=>new Promise((r=>{const i=e.publisherAudience;if(i&&i.enabled){const e={hashedRecords:[{type:"email",record:i.sha256Email}]};if(t.logger.debug("A9","Enable publisher audiences"),t.window.apstag.rpa(e),t.window.__tcfapi){let r=!0;t.window.__tcfapi("addEventListener",2,(i=>{r?r=!1:i.eventStatus===c.tcfapi.status.EventStatus.USER_ACTION_COMPLETE&&(t.logger.debug("A9","Update publisher audience token"),t.window.apstag.upa(e))}))}}r()})))),t.a9ClearTargetingStep=()=>n.mkPrepareRequestAdsStep("a9-clear-targeting",n.LOW_PRIORITY,((e,t)=>0===e.requestId?(e.logger.debug("A9","skip ad slot clearing for first pipeline run"),Promise.resolve()):new Promise((r=>{e.logger.debug("A9","clear a9 targetings"),t.forEach((({adSlot:e})=>{e.getTargetingKeys().filter((e=>"amznp"===e||"amznsz"===e||"amznbid"===e)).forEach((t=>e.clearTargeting(t)))})),r()})))),t.a9RequestBids=e=>n.mkRequestBidsStep("a9-fetch-bids",((t,r)=>new Promise((i=>{if(!f(t.tcData))return t.logger.debug("A9","Skip any due to missing consent"),void i();const o=r.filter(p).filter((e=>{const r="video"===e.moliSlot.a9.mediaType,i=t.labelConfigService.filterSlot(e.moliSlot.a9),o=e.filterSupportedSizes(e.moliSlot.sizes).filter(l.SizeConfigService.isFixedSize).length>0;return i&&(r||o)}));t.logger.debug("A9",`Fetch '${o.length}' A9 slots: ${o.map((e=>`[DomID] ${e.moliSlot.domId} [AdUnitPath] ${e.moliSlot.adUnitPath}`))}`),0===o.length?i():(t.reportingService.markA9fetchBids(t.requestId),t.window.apstag.fetchBids({slots:o.map((({moliSlot:t,priceRule:r,filterSupportedSizes:i})=>{if("video"===t.a9.mediaType)return{slotID:t.domId,mediaType:"video"};{const o=e.supportedSizes?t.sizes.filter((t=>{var r;return null===(r=e.supportedSizes)||void 0===r?void 0:r.some((e=>d.isSizeEqual(e,t)))})):t.sizes;return Object.assign({slotID:t.domId,slotName:g.removeChildId(t.adUnitPath),sizes:i(o).filter(l.SizeConfigService.isFixedSize)},e.enableFloorPrices&&r?{floor:{value:Math.ceil(100*r.floorprice*1.19),currency:e.floorPriceCurrency||"USD"}}:{})}}))},(e=>{t.reportingService.measureAndReportA9BidsBack(t.requestId),t.window.apstag.setDisplayBids(),i()})))}))))},157:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.AdPipeline=t.mkRequestBidsStep=t.mkPrepareRequestAdsStep=t.mkConfigureStepOnce=t.mkConfigureStepOncePerRequestAdsCycle=t.mkConfigureStep=t.mkInitStep=t.LOW_PRIORITY=t.HIGH_PRIORITY=void 0;const i=r(495),o=r(879),s=r(380);var n=o.tcfapi.responses.TCPurpose;t.HIGH_PRIORITY=100,t.LOW_PRIORITY=10,t.mkInitStep=(e,t)=>(Object.defineProperty(t,"name",{value:e}),t),t.mkConfigureStep=(e,t)=>(Object.defineProperty(t,"name",{value:e}),t),t.mkConfigureStepOncePerRequestAdsCycle=(e,r)=>{Object.defineProperty(r,"name",{value:e});let i=0;return t.mkConfigureStep(e,((e,t)=>i!==e.requestAdsCalls?(i=e.requestAdsCalls,r(e,t)):Promise.resolve()))},t.mkConfigureStepOnce=(e,r)=>(Object.defineProperty(r,"name",{value:e}),t.mkConfigureStep(e,((e,t)=>1===e.requestAdsCalls&&1===e.requestId?r(e,t):Promise.resolve()))),t.mkPrepareRequestAdsStep=(e,t,r)=>{const i=Object.assign(r,{priority:t});return Object.defineProperty(r,"name",{value:e}),i},t.mkRequestBidsStep=(e,t)=>(Object.defineProperty(t,"name",{value:e}),t),t.AdPipeline=class{constructor(e,t,r,i,o){this.config=e,this.logger=t,this.window=r,this.reportingService=i,this.slotEventService=o,this.init=null,this.tcData=null,this.requestId=0,this.runPrepareRequestAds=(e,t)=>{const r=new Map;return this.config.prepareRequestAds.forEach((e=>{const t=r.get(e.priority);t?t.push(e):r.set(e.priority,[e])})),Array.from(r.entries()).sort((([e],[t])=>e>t?-1:1)).reduce(((r,[i,o])=>r.then((()=>(e.logger.debug("AdPipeline",e.requestId,`run prepareRequestAds with priority ${i}`),Promise.all(o.map((r=>r(e,t)))))))),Promise.resolve(void 0))}}run(e,t,r){if(0===e.length)return Promise.resolve();this.requestId=this.requestId+1;const o=this.requestId;return this.logger.debug("AdPipeline",`starting run with requestId ${o} on ${r}. call`,e),this.tcData=this.tcData?this.tcData:s.consentReady(this.window,this.logger,t.environment),this.tcData.then((s=>{var a;const d=[...(null===(a=t.targeting)||void 0===a?void 0:a.labels)||[]];s.gdprApplies&&s.purpose.consents[n.STORE_INFORMATION_ON_DEVICE]?d.push("purpose-1"):s.gdprApplies||d.push("purpose-1");const l=new i.LabelConfigService(t.labelSizeConfig||[],d,this.window),c={requestId:o,requestAdsCalls:r,logger:this.logger,env:t.environment||"production",config:t,labelConfigService:l,reportingService:this.reportingService,slotEventService:this.slotEventService,window:this.window,tcData:s};return this.init=this.init?this.init:this.logStage("init",o).then((()=>Promise.all(this.config.init.map((e=>e(c)))))),this.init.then((()=>this.logStage("configure",o).then((()=>Promise.all(this.config.configure.map((t=>t(c,e)))))))).then((()=>this.logStage("defineSlots",o).then((()=>this.config.defineSlots(c,e))))).then((e=>this.logStage("prepareRequestAds",o).then((()=>this.runPrepareRequestAds(c,e))).then((()=>this.logStage("requestBids",o))).then((()=>Promise.all(this.config.requestBids.map((t=>t(c,e)))))).then((()=>this.logStage("requestAds",o))).then((()=>this.config.requestAds(c,e))))).catch((e=>(this.logger.error("AdPipeline","running ad pipeline failed with error",e),Promise.reject(e))))}))}logStage(e,t){return new Promise((r=>{this.logger.debug("AdPipeline",t,`stage: ${e}`),r()}))}}},917:function(e,t,r){var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.AdService=void 0;const o=r(611),s=r(157),n=r(996),a=r(192),d=r(465),l=r(777),c=i(r(297)),u=r(404),g=r(2),p=r(257),f=r(707),m=r(935),h=r(514),S=r(974),v=r(389);class b{constructor(e,t,r){this.assetService=e,this.window=t,this.adPipelineConfig=r,this.requestAdsCalls=0,this.adPipeline=new s.AdPipeline({init:[()=>Promise.reject("AdPipeline not initialized yet")],configure:[],defineSlots:()=>Promise.resolve([]),prepareRequestAds:[],requestBids:[],requestAds:()=>Promise.resolve()},o.getDefaultLogger(),this.window,a.noopReportingService,new n.SlotEventService(o.getDefaultLogger())),this.initialize=(e,t)=>{const r=b.getEnvironment(e);this.logger.setLogger(o.getLogger(e,this.window)),this.logger.debug("AdService",`Initializing with environment ${r}`);const i=e.reporting||{reporters:[],sampleRate:0},p=new a.ReportingService(d.createPerformanceService(this.window),this.slotEventService,i,this.logger,r,this.window),f=[l.gptInit(this.assetService)],m=[l.gptConfigure(e),n.slotEventServiceConfigure(this.slotEventService)];t&&m.push(l.gptDestroyAdSlots(),l.gptResetTargeting());const A=[a.reportingPrepareRequestAds(p),h.passbackPrepareRequestAds(new S.PassbackService(this.logger,this.window)),l.gptLDeviceLabelKeyValue(),l.gptConsentKeyValue()],w=[];if(e.prebid&&"production"===r&&(f.push(u.prebidInit()),m.push(u.prebidConfigure(e.prebid)),t&&m.push(u.prebidRemoveAdUnits()),A.push(u.prebidPrepareRequestAds()),w.push(u.prebidRequestBids(e.prebid,e.targeting))),e.a9&&"production"===r&&(f.push(g.a9Init(e.a9,this.assetService)),m.push(g.a9Configure(e.a9)),m.push(g.a9PublisherAudiences(e.a9)),A.push(g.a9ClearTargetingStep()),w.push(g.a9RequestBids(e.a9))),e.pipeline&&(f.push(...e.pipeline.initSteps),m.push(...e.pipeline.configureSteps),A.push(...e.pipeline.prepareRequestAdsSteps)),"test"===r){const e=v.getDebugDelayFromLocalStorage(this.window);e&&m.push((()=>v.executeDebugDelay(this.window,e)))}return this.adPipeline=new s.AdPipeline({init:f,configure:m,defineSlots:l.gptDefineSlots(),prepareRequestAds:A,requestBids:w,requestAds:l.gptRequestAds()},this.logger,this.window,p,this.slotEventService),new Promise((t=>{c.default(this.window,(()=>{this.logger.debug("DOM","dom ready"),t(e)}))}))},this.requestAds=(e,t)=>{var r;this.requestAdsCalls=this.requestAdsCalls+1,this.logger.info("AdService",`RequestAds[${this.requestAdsCalls}]`,t);try{const i=e.slots.map((r=>this.isLazySlot(r)?(this.logger.debug("AdService",`create lazy loader for ${r.domId}`,r),f.createLazyLoader(r.behaviour.trigger,this.slotEventService,this.window).onLoad().then((()=>{if(this.isSlotAvailable(r))return Promise.resolve();const e=`lazy slot dom element not available: ${r.adUnitPath} / ${r.domId}`;return this.logger.error("AdService",e),Promise.reject(e)})).then((()=>this.adPipeline.run([r],e,this.requestAdsCalls))),null):this.isRefreshableAdSlot(r)?(this.logger.debug("AdService",`create refresh listener for ${r.domId}`,r),m.createRefreshListener(r.behaviour.trigger,r.behaviour.throttle,this.slotEventService,this.window).addAdRefreshListener((()=>this.adPipeline.run([r],e,this.requestAdsCalls))),r.behaviour.lazy?null:r):this.isManualSlot(r)?t.some((e=>e===r.domId))?r:null:r)).filter(p.isNotNull).filter(this.isSlotAvailable);if(null===(r=e.buckets)||void 0===r?void 0:r.enabled){const t=new Map;return i.forEach((e=>{const r=e.behaviour.bucket||"default",i=t.get(r);i?i.push(e):t.set(r,[e])})),Promise.all(Array.from(t.entries()).map((([t,r])=>(this.logger.debug("AdPipeline",`running bucket ${t}, slots:`,r),this.adPipeline.run(r,e,this.requestAdsCalls).then((()=>r)))))).then(p.flatten)}return this.adPipeline.run(i,e,this.requestAdsCalls).then((()=>i))}catch(e){return this.logger.error("AdPipeline","slot filtering failed",e),Promise.reject(e)}},this.getAdPipeline=()=>this.adPipeline,this.setLogger=e=>{this.logger.setLogger(e)},this.isLazySlot=e=>"lazy"===e.behaviour.loaded,this.isRefreshableAdSlot=e=>"refreshable"===e.behaviour.loaded,this.isManualSlot=e=>"manual"===e.behaviour.loaded,this.isSlotAvailable=e=>!!this.window.document.getElementById(e.domId)||"out-of-page-interstitial"===e.position||"out-of-page-top-anchor"===e.position||"out-of-page-bottom-anchor"===e.position,this.logger=new o.ProxyLogger(o.getDefaultLogger()),this.slotEventService=new n.SlotEventService(this.logger),r&&(this.adPipeline=new s.AdPipeline(r,this.logger,t,a.noopReportingService,this.slotEventService))}static getEnvironment(e){return e.environment||"production"}refreshAdSlots(e,t){if(0===e.length)return Promise.resolve();const r=t.slots.filter(this.isManualSlot),i=r.filter((t=>e.some((e=>e===t.domId))));if(e.length!==i.length){const t=e.filter((e=>!r.some((t=>t.domId===e))));this.logger.warn("AdService","Trying to refresh slots that are not available",t)}return this.logger.debug("AdService","refresh ad slots",i,t.targeting),this.adPipeline.run(i,t,this.requestAdsCalls)}}t.AdService=b},643:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.removeChildId=void 0,t.removeChildId=e=>{const[t,r,...i]=e.split("/"),[o,...s]=r.split(",");return 0===s.length?e:["",o,...i].join("/")}},380:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.consentReady=void 0;const i=r(879);var o=i.tcfapi.status.EventStatus,s=i.tcfapi.status.CmpStatus;t.consentReady=(e,t,r)=>"test"===r?Promise.resolve({gdprApplies:!1,eventStatus:o.TC_LOADED,cmpStatus:s.LOADED,cmpId:0,cmpVersion:0,tcfPolicyVersion:void 0,listenerId:null}):new Promise(((r,i)=>{if(e.__tcfapi){const o=o=>{"error"===o.cmpStatus?i(o):"useractioncomplete"!==o.eventStatus&&"tcloaded"!==o.eventStatus||(t.debug("Consent","consent ready",o),r(o),o.listenerId&&e.__tcfapi("removeEventListener",2,(()=>{}),o.listenerId))};e.__tcfapi("addEventListener",2,o)}else i("window.__tcfapi is not defined. Make sure that the stub code is inlined in the head tag")}))},777:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.gptRequestAds=t.gptDefineSlots=t.gptConsentKeyValue=t.gptLDeviceLabelKeyValue=t.gptConfigure=t.gptResetTargeting=t.gptDestroyAdSlots=t.gptInit=void 0;const i=r(157),o=r(793),s=r(257),n=r(569),a=r(879),d=r(249);var l=a.tcfapi.responses.TCPurpose;const c=(e,t)=>{const r=t?t.keyValues:{};Object.keys(r).forEach((t=>{const i=r[t];i&&e.googletag.pubads().setTargeting(t,i)}))},u=e=>!e.gdprApplies||e.vendor.consents[755]&&e.purpose.consents[l.STORE_INFORMATION_ON_DEVICE]&&[l.SELECT_BASIC_ADS,l.MEASURE_AD_PERFORMANCE,l.APPLY_MARKET_RESEARCH,l.DEVELOP_IMPROVE_PRODUCTS].every((t=>e.purpose.consents[t]||e.purpose.legitimateInterests[t]));t.gptInit=e=>{let t;return i.mkInitStep("gpt-init",(r=>(t||(t=new Promise((t=>{r.logger.debug("GAM","init googletag stub"),r.window.googletag=r.window.googletag||{cmd:[]},r.window.googletag.cmd.push(t),e.loadScript({name:"gpt",loadMethod:n.AssetLoadMethod.TAG,assetUrl:u(r.tcData)?"https://securepubads.g.doubleclick.net/tag/js/gpt.js":"https://pagead2.googlesyndication.com/tag/js/gpt.js"})}))),t)))},t.gptDestroyAdSlots=()=>i.mkConfigureStepOncePerRequestAdsCycle("gpt-destroy-ad-slots",(e=>new Promise((t=>{e.logger.debug("GAM","destroy all ad slots"),e.window.googletag.destroySlots(),t()})))),t.gptResetTargeting=()=>i.mkConfigureStepOncePerRequestAdsCycle("gpt-reset-targeting",(e=>new Promise((t=>{"production"===e.env&&(e.logger.debug("GAM","reset top level targeting"),e.window.googletag.pubads().clearTargeting(),c(e.window,e.config.targeting)),t()})))),t.gptConfigure=e=>{let t;return i.mkConfigureStep("gpt-configure",((r,i)=>(t||(t=new Promise((t=>{const i=e.environment||"production";switch(r.logger.debug("GAM","configure googletag"),i){case"production":c(r.window,e.targeting),r.window.googletag.pubads().enableAsyncRendering(),r.window.googletag.pubads().disableInitialLoad(),r.window.googletag.pubads().enableSingleRequest();const i=!u(r.tcData);return r.logger.debug("GAM","use limited ads",i),r.window.googletag.pubads().setPrivacySettings({limitedAds:i}),r.window.googletag.enableServices(),void t();case"test":return r.window.googletag.content().getSlots(),r.window.googletag.enableServices(),void t()}}))),t)))},t.gptLDeviceLabelKeyValue=()=>i.mkPrepareRequestAdsStep("gpt-device-label-keyValue",i.LOW_PRIORITY,(e=>new Promise((t=>{const r=["mobile","tablet","desktop"],i=e.labelConfigService.getSupportedLabels().filter((e=>r.some((t=>t===e))));1===i.length?(e.logger.debug("GAM",'adding "device_label" key-value with values',i),e.window.googletag.pubads().setTargeting("device_label",i)):e.logger.warn("GAM",`Expected one device label, but found ${i.length}`,i),t()})))),t.gptConsentKeyValue=()=>i.mkPrepareRequestAdsStep("gpt-consent-keyValue",i.LOW_PRIORITY,(e=>new Promise((t=>{const r=e.tcData,i=!r.gdprApplies||[l.STORE_INFORMATION_ON_DEVICE,l.SELECT_BASIC_ADS,l.CREATE_PERSONALISED_ADS_PROFILE,l.SELECT_PERSONALISED_ADS,l.CREATE_PERSONALISED_CONTENT_PROFILE,l.SELECT_PERSONALISED_CONTENT,l.MEASURE_AD_PERFORMANCE,l.MEASURE_CONTENT_PERFORMANCE,l.APPLY_MARKET_RESEARCH,l.DEVELOP_IMPROVE_PRODUCTS].every((e=>r.purpose.consents[e]));e.window.googletag.pubads().setTargeting("consent",i?"full":"none"),t()})))),t.gptDefineSlots=()=>(e,t)=>{const r=t.map((t=>{var r;const i=new o.SizeConfigService(t.sizeConfig,e.labelConfigService.getSupportedLabels(),e.window),s=i.filterSupportedSizes;if(!i.filterSlot(t)||!e.labelConfigService.filterSlot(t))return Promise.resolve(null);const n=s(t.sizes),a=("production"===e.env?e.window.googletag.pubads().getSlots():e.window.googletag.content().getSlots()).find((e=>e.getSlotElementId()===t.domId))||(()=>{const r=(()=>{switch(t.position){case"in-page":return e.window.googletag.defineSlot(t.adUnitPath,n,t.domId);case"out-of-page":return e.window.googletag.defineOutOfPageSlot(t.adUnitPath,t.domId);case"out-of-page-interstitial":return e.logger.debug("GAM",`defined web interstitial for ${t.adUnitPath}`),e.window.googletag.defineOutOfPageSlot(t.adUnitPath,e.window.googletag.enums.OutOfPageFormat.INTERSTITIAL);case"out-of-page-bottom-anchor":return e.logger.debug("GAM",`defined bottom anchor for ${t.adUnitPath}`),e.window.googletag.defineOutOfPageSlot(t.adUnitPath,e.window.googletag.enums.OutOfPageFormat.BOTTOM_ANCHOR);case"out-of-page-top-anchor":return e.logger.debug("GAM",`defined top anchor for ${t.adUnitPath}`),e.window.googletag.defineOutOfPageSlot(t.adUnitPath,e.window.googletag.enums.OutOfPageFormat.TOP_ANCHOR)}})();return r&&e.window.googletag.display(r),r})();if(!a){if("out-of-page-interstitial"===t.position||"out-of-page-top-anchor"===t.position||"out-of-page-bottom-anchor"===t.position)return e.logger.warn("GAM",`${t.position} is not supported`),Promise.resolve(null);{const r=`Slot: [DomID] ${t.domId} [AdUnitPath] ${t.adUnitPath} is already defined. You may have called requestAds() multiple times`;return e.logger.error("GAM",r),Promise.reject(new Error(r))}}switch(a.setCollapseEmptyDiv(!1!==(null===(r=t.gpt)||void 0===r?void 0:r.collapseEmptyDiv)),e.env){case"production":return a.addService(e.window.googletag.pubads()),e.logger.debug("GAM",`Register slot: [DomID] ${t.domId} [AdUnitPath] ${t.adUnitPath}`),Promise.resolve({moliSlot:t,adSlot:a,filterSupportedSizes:s});case"test":return e.logger.warn("GAM",`Enabling content service on ${a.getSlotElementId()}`),a.addService(e.window.googletag.content()),Promise.resolve({moliSlot:t,adSlot:a,filterSupportedSizes:s});default:return Promise.reject(`invalid environment: ${e.config.environment}`)}}));return Promise.all(r).then((e=>e.filter(s.isNotNull)))},t.gptRequestAds=()=>(e,t)=>new Promise((r=>{switch(e.logger.debug("GAM","requestAds"),e.env){case"test":d.createTestSlots(e,t);break;case"production":e.window.googletag.pubads().refresh(t.map((e=>e.adSlot))),t.forEach((({moliSlot:t})=>e.reportingService.markRefreshed(t)));const r=t.map((({moliSlot:e})=>`[DomID] ${e.domId} [AdUnitPath] ${e.adUnitPath}`)).join("\n");e.logger.debug("GAM",`Refresh ${t.length} slot(s):\n${r}`)}r()}))},495:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.LabelConfigService=void 0;const i=r(257);t.LabelConfigService=class{constructor(e,t,r){this.labelSizeConfig=e,this.extraLabels=t,this.window=r;const o=e.filter((e=>r.matchMedia(e.mediaQuery).matches));this.isValid=0===e.length||!(e.length>0&&0===o.length);const s=i.flatten(o.map((e=>e.labelsSupported)));this.supportedLabels=[...s,...t].filter(i.uniquePrimitiveFilter)}filterSlot(e){let t=!0;return this.supportedLabels.length>0&&e.labelAll&&e.labelAll.length>0&&(t=e.labelAll.every((e=>this.supportedLabels.indexOf(e)>-1))),this.supportedLabels.length>0&&e.labelAny&&!(e.labelAll&&e.labelAll.length>0)&&(t=e.labelAny.some((e=>this.supportedLabels.indexOf(e)>-1))),t}getSupportedLabels(){return this.supportedLabels}}},707:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createLazyLoader=void 0,t.createLazyLoader=(e,t,r)=>{switch(e.name){case"event":return((e,t,r)=>({onLoad:()=>new Promise(((i,o)=>{try{t.getOrCreateEventSource(e,void 0,r).addCallback({callback:()=>{i()},permanent:!1})}catch(e){o(e)}}))}))(e,t,r);default:return{onLoad:()=>Promise.reject(`Invalid trigger configuration: ${JSON.stringify(e)}`)}}}},414:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createMoliTag=void 0;const i=r(30),o=r(569),s=r(611),n=r(76),a=r(917),d=r(141),l=r(598);t.createMoliTag=e=>{const t=o.createAssetLoaderService(e),r=new a.AdService(t,e),c=e;let u={state:"configurable",initialize:!1,isSinglePageApp:!1,keyValues:{},labels:[],modules:[],moduleMeta:[],reporting:{reporters:[]},refreshSlots:[],hooks:{beforeRequestAds:[],afterRequestAds:[]}};function g(t,r){switch(u.state){case"configurable":u.keyValues[t]=r;break;case"configured":u.config.targeting?u.config.targeting.keyValues[t]=r:u.config=Object.assign(Object.assign({},u.config),{targeting:{keyValues:{[t]:r}}});break;case"spa-finished":case"spa-requestAds":u.keyValues=Object.assign({[t]:r},u.keyValues);break;default:s.getLogger(u.config,e).error("MoliGlobal",`Setting key-value after configuration: ${t} : ${r}`)}}function p(){switch(u.state){case"configurable":return u.initialize=!0,f(),Promise.resolve(u);case"configured":{f();const t=u.config;u.hooks&&u.hooks.beforeRequestAds&&u.hooks.beforeRequestAds.forEach((e=>e(t)));const i=u.hooks.afterRequestAds,{moduleMeta:o,isSinglePageApp:n,refreshSlots:a}=u;if(n){const d=r.initialize(t,n).then((()=>t)),l={state:"spa-requestAds",configFromAdTag:u.configFromAdTag,config:t,initialized:d,href:e.location.href,labels:[],keyValues:{},hooks:u.hooks,refreshSlots:[],moduleMeta:o};return u=l,d.then((()=>r.requestAds(t,a))).then((()=>{if("spa-requestAds"===u.state&&u.href===e.location.href){r.refreshAdSlots(u.refreshSlots,u.config),i.forEach((e=>e("spa-finished")));const e=Object.assign(Object.assign({},u),{state:"spa-finished",refreshSlots:[]});return u=e,e}return"spa-finished"===u.state||"spa-requestAds"===u.state?(s.getLogger(u.config,e).debug("MoliGlobal","A previous requestAds() was slower than the following requestAds() call"),u):Promise.reject(`reached invalid state [${u.state}]`)}))}return u={state:"requestAds",config:t,moduleMeta:o},r.initialize(t,n).then((e=>r.requestAds(e,a))).then((()=>(u={state:"finished",config:t,moduleMeta:o},i.forEach((e=>e("finished"))),Promise.resolve(u)))).catch((r=>(s.getLogger(t,e).error("MoliGlobal",r),u={state:"error",config:t,error:r,moduleMeta:o},i.forEach((e=>e("error"))),Promise.resolve(u))))}case"spa-requestAds":case"spa-finished":{"spa-requestAds"===u.state&&s.getLogger(u.config,e).debug("MoliGlobal","requestAds is being called while the previous requestAds() hasn't finished yet"),f();const{hooks:t,moduleMeta:i}=u,o=u.hooks.afterRequestAds,n=u.hooks.beforeRequestAds,a=u,{initialized:d,href:l,keyValues:c,labels:g,configFromAdTag:p}=u,m="spa-finished"===u.state?u.refreshSlots:[];return u=Object.assign(Object.assign({},a),{state:"spa-requestAds",refreshSlots:[]}),d.then((t=>l===e.location.href?Promise.reject("You are trying to refresh ads on the same page, which is not allowed."):Promise.resolve(t))).then((e=>Object.assign(Object.assign({},e),{targeting:{keyValues:Object.assign(Object.assign({},p.targeting&&p.targeting.keyValues?p.targeting.keyValues:{}),c),labels:[...p.targeting&&p.targeting.labels?p.targeting.labels:[],...g]}}))).then((e=>(n.forEach((t=>t(e))),r.requestAds(e,m).then((()=>e))))).then((s=>("spa-requestAds"===u.state&&r.refreshAdSlots(u.refreshSlots,s),u={state:"spa-finished",configFromAdTag:p,config:s,initialized:d,href:e.location.href,hooks:t,labels:[],keyValues:{},refreshSlots:[],moduleMeta:i},o.forEach((e=>e("spa-finished"))),u)))}case"requestAds":return s.getLogger(u.config,e).error("MoliGlobal","Trying to requestAds twice. Already requesting ads."),Promise.reject();case"finished":return s.getLogger(u.config,e).error("MoliGlobal","Trying to requestAds twice. Already finished."),Promise.reject();case"error":return s.getLogger(u.config,e).error("MoliGlobal","Trying to requestAds twice. Already finished, but with an error.",u.error),Promise.reject()}}function f(){const t="ABtest",r=i.parseQueryString(e.location.search).get(t);g(t,(r?Number(r):Math.floor(100*Math.random())+1).toString())}return{que:{push(e){e(c.moli)}},version:l.packageJson.version,setTargeting:g,addLabel:function(t){switch(u.state){case"configurable":u.labels.push(t);break;case"configured":u.config.targeting&&u.config.targeting.labels?u.config.targeting.labels.push(t):u.config=Object.assign(Object.assign({},u.config),{targeting:{keyValues:u.config.targeting?u.config.targeting.keyValues:{},labels:[t]}});break;case"spa-requestAds":case"spa-finished":u.labels.push(t);break;default:s.getLogger(u.config,e).error("MoliGlobal",`Adding label after configure: ${t}`)}},setLogger:function(e){switch(u.state){case"configurable":u.logger=e;break;case"configured":u.config=Object.assign(Object.assign({},u.config),{logger:e});break;default:e.error("Setting a custom logger is not allowed after configuration")}},setSampleRate:function(t){switch(u.state){case"configurable":u.reporting.sampleRate=t;break;case"configured":u.config=Object.assign(Object.assign({},u.config),{reporting:Object.assign(Object.assign({},u.config.reporting),{sampleRate:t,reporters:u.config.reporting?u.config.reporting.reporters:[]})});break;default:s.getLogger(u.config,e).error("MoliGlobal","Trying to setSampleRate. Already configured.",u.config)}},addReporter:function(t){switch(u.state){case"configurable":u.reporting.reporters.push(t);break;case"configured":u.config=Object.assign(Object.assign({},u.config),{reporting:Object.assign(Object.assign({},u.config.reporting),{sampleRate:u.config.reporting?u.config.reporting.sampleRate:0,reporters:[...u.config.reporting?u.config.reporting.reporters:[],t]})});break;default:s.getLogger(u.config,e).error("MoliGlobal","Trying to setSampleRate. Already configured.",u.config)}},beforeRequestAds:function(t){switch(u.state){case"configurable":case"configured":u.hooks.beforeRequestAds.push(t);break;default:s.getLogger(u.config,e).error("MoliGlobal","Trying to add a hook beforeRequestAds. Already configured.",u.config)}},afterRequestAds:function(t){switch(u.state){case"configurable":case"configured":u.hooks.afterRequestAds.push(t);break;default:s.getLogger(u.config,e).error("MoliGlobal","Trying to add a hook afterRequestAds. Already configured.",u.config)}},getConfig:function(){switch(u.state){case"configurable":return null;case"configured":case"requestAds":return u.config;case"spa-requestAds":case"spa-finished":case"finished":case"error":return u.config}},registerModule:function(t){switch(u.state){case"configurable":return u.modules.push(t),void u.moduleMeta.push(n.metaFromModule(t));default:s.getLogger(u.config,e).error("Registering a module is only allowed within the ad tag before the ad tag is configured")}},configure:function(i){switch(u.state){case"configurable":{const o=u.initialize,a=d.getActiveEnvironmentOverride(e),l=u.modules;"queryParam"===(null==a?void 0:a.source)&&d.setEnvironmentOverrideInStorage(a.environment,e.sessionStorage),l.forEach((o=>{s.getLogger(i,e).debug("MoliGlobal",`initialize ${o.moduleType} module ${o.name}`,o.config()),o.init(i,t,r.getAdPipeline)})),u={state:"configured",configFromAdTag:i,config:Object.assign(Object.assign(Object.assign({},i),a&&{environment:a.environment}),{targeting:{keyValues:Object.assign(Object.assign({},i.targeting&&i.targeting.keyValues?i.targeting.keyValues:{}),u.keyValues),labels:[...i.targeting&&i.targeting.labels?i.targeting.labels:[],...u.labels]},reporting:Object.assign(Object.assign({},i.reporting),{sampleRate:u.reporting.sampleRate?u.reporting.sampleRate:i.reporting&&i.reporting.sampleRate?i.reporting.sampleRate:0,reporters:[...i.reporting?i.reporting.reporters:[],...u.reporting.reporters]}),logger:u.logger||i.logger}),moduleMeta:l.map(n.metaFromModule),hooks:u.hooks,isSinglePageApp:u.isSinglePageApp,refreshSlots:[...u.refreshSlots]},o&&p();break}case"configured":s.getLogger(u.config,e).error("MoliGlobal","Trying to configure moli tag twice. Already configured.",u.config);break;case"requestAds":s.getLogger(u.config,e).error("MoliGlobal","Trying to configure moli tag twice. Already requesting ads.");break;case"finished":s.getLogger(u.config,e).error("MoliGlobal","Trying to configure moli tag twice. Already finished.");break;case"error":s.getLogger(u.config,e).error("MoliGlobal","Trying to configure moli tag twice. Already finished, but with an error.",u.error)}},enableSinglePageApp:function(){switch(u.state){case"configurable":case"configured":u.isSinglePageApp=!0;break;case"spa-requestAds":case"spa-finished":break;default:s.getLogger(u.config,e).error("MoliGlobal","Trying enable single page app. Already configured.",u.config)}},requestAds:p,refreshAdSlot:function(t){const i="string"==typeof t?[t]:t;switch(u.state){case"configurable":case"configured":case"spa-requestAds":return u.refreshSlots.push(...i),Promise.resolve("queued");case"spa-finished":return u.href===e.location.href?r.refreshAdSlots(i,u.config).then((()=>"refreshed")):(u.refreshSlots.push(...i),Promise.resolve("queued"));case"finished":case"requestAds":return r.refreshAdSlots(i,u.config).then((()=>"refreshed"));default:return s.getLogger(u.config,e).error("MoliGlobal",`refreshAdSlot is not allowed in state ${u.state}`,u.config),Promise.reject(`not allowed in state ${u.state}`)}},getModuleMeta:function(){return u.moduleMeta},getState:function(){return u.state},openConsole:function(e){switch(u.state){case"configurable":break;default:t.loadScript({assetUrl:e||"https://ad-tag-console.h5v.eu/moli-debug.min.js",loadMethod:o.AssetLoadMethod.TAG,name:"moli-debugger"})}},getAssetLoaderService:function(){return t}}}},542:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.initAdTag=void 0;const i=r(414);t.initAdTag=e=>{const t=e,r=t.moli&&[...t.moli.que]||[],o=i.createMoliTag(e);return t.moli=o,r.forEach((e=>e(o))),o}},514:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.passbackPrepareRequestAds=void 0;const i=r(157);t.passbackPrepareRequestAds=e=>i.mkPrepareRequestAdsStep("passback-prepare-slots",i.LOW_PRIORITY,((t,r)=>new Promise((i=>{r.filter((e=>e.moliSlot.passbackSupport)).forEach((r=>{t.logger.debug("passback","add passback support for slot",r.moliSlot.domId),e.addAdSlot(r)})),i()}))))},974:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.PassbackService=void 0,t.PassbackService=class{constructor(e,t){this.logger=e,this.window=t,this.isInitialized=!1,this.adSlots={},this.passbackKeyValue="passback",this.passbackOriginKeyValue="passbackOrigin",this.findAdSlot=e=>e.adUnitPath?this.adSlots[e.adUnitPath]:e.domId?this.adSlots[e.domId]:void 0}addAdSlot(e){this.isInitialized||(this.isInitialized=!0,this.initMessageListener()),this.adSlots[e.moliSlot.domId]=e,this.adSlots[e.moliSlot.adUnitPath]=e}initMessageListener(){this.logger.debug("Passback Service","Add message listener"),this.window.addEventListener("message",(e=>{const t=this.parseMessageData(e.data);if(!t)return;this.logger.debug("Passback Service","Received passback message",t);const r=this.findAdSlot(t);r&&(this.logger.debug("Passback Service","Process passback for ad slot"),r.adSlot.setTargeting(this.passbackKeyValue,"true"),r.adSlot.setTargeting(this.passbackOriginKeyValue,t.passbackOrigin),this.window.googletag.pubads().refresh([r.adSlot]),delete this.adSlots[r.moliSlot.domId],delete this.adSlots[r.moliSlot.adUnitPath])}))}parseMessageData(e){if("string"==typeof e)try{const t=JSON.parse(e);return"passback"===t.type&&t.passbackOrigin&&(t.domId||t.adUnitPath)?t:null}catch(e){return null}return null}}},198:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.renderPrebidOutstream=t.prebidOutstreamRenderer=void 0;const i=r(611);t.prebidOutstreamRenderer=(e,r={})=>({url:"https://assets.h5v.eu/prebid-outstream/3/bundle.js",render:i=>t.renderPrebidOutstream(i,e,r),backupOnly:!0}),t.renderPrebidOutstream=(e,t,r={})=>{e.renderer?e.renderer.push((()=>{var i;return null===(i=window.outstreamPlayer)||void 0===i?void 0:i.call(window,e,t,r)})):i.getDefaultLogger().error("Can not initialize prebid outstream player, because bid.renderer is not defined")}},935:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createRefreshListener=void 0,t.createRefreshListener=(e,t,r,i)=>{switch(e.name){case"event":return((e,t,r,i)=>({addAdRefreshListener(o){r.getOrCreateEventSource(e,t,i).addCallback({callback:o,permanent:!0})}}))(e,t,r,i);default:throw new Error(`Unsupported trigger ${e.name}`)}}},192:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.noopReportingService=t.ReportingService=t.reportingPrepareRequestAds=void 0;const i=r(157);t.reportingPrepareRequestAds=e=>i.mkPrepareRequestAdsStep("reporting-enabled",i.HIGH_PRIORITY,((t,r)=>(1===t.requestId&&(t.logger.debug("Reporting","initialize reporting",r),e.initialize(r.map((e=>e.moliSlot)))),Promise.resolve())));class o{constructor(e,t,r,i,o,s){this.performanceService=e,this.slotEventService=t,this.config=r,this.logger=i,this.env=o,this.window=s,this.slotRenderEndedEvent={},this.adUnitRegex=r.adUnitRegex||/\/\d*\//i;try{this.pageRequestId=this.uuidv4(),this.isSample=Math.random()<=r.sampleRate,i.debug("AdPerformanceService",`isSample ${this.isSample} (${r.sampleRate}) | pageRequestId ${this.pageRequestId}`)}catch(e){this.pageRequestId="00000000-0000-0000-0000-000000000000",this.isSample=!1,i.error("[ReportingService] Initializing failed",e)}}static getSingleMeasurementMetricMeasureName(e){switch(e){case"cmpLoad":return"cmp_load_time";case"dfpLoad":return"dfp_load_time";case"prebidLoad":return"prebid_load_time";case"a9Load":return"a9_load_time";case"ttfa":return"dfp_time_to_first_ad";case"ttfr":return"dfp_time_to_first_render"}}initialize(e){this.performanceService.mark("dfp_load_start"),this.measureAndReportFirstAdRenderTime(),this.measureAndReportFirstAdLoadTime(),this.initAdSlotMetrics(),this.slotEventService.awaitAllAdSlotsRendered(e).then((e=>this.reportAdSlotsMetric(e))).then((()=>this.measureAndReportDfpLoadTime()))}markRefreshed(e){this.performanceService.mark(`${this.minimalAdUnitName(e.adUnitPath)}_refreshed`)}markPrebidSlotsRequested(e){this.performanceService.mark(`prebid_requested_${e}`)}measureAndReportPrebidBidsBack(e){const t=o.getSingleMeasurementMetricMeasureName("prebidLoad");this.performanceService.measure(`${t}_${e}`,`prebid_requested_${e}`,`prebid_bids_back_${e}`),1===e&&this.performanceService.measure(t,`prebid_requested_${e}`,`prebid_bids_back_${e}`);const r=this.performanceService.getMeasure(`${t}_${e}`);r&&this.report({type:"prebidLoad",pageRequestId:this.pageRequestId,measurement:r})}markA9fetchBids(e){this.performanceService.mark(`a9_requested_${e}`)}measureAndReportA9BidsBack(e){const t=o.getSingleMeasurementMetricMeasureName("a9Load");this.performanceService.measure(`${t}_${e}`,`a9_requested_${e}`,`a9_bids_back_${e}`);const r=this.performanceService.getMeasure(`${t}_${e}`);1===e&&this.performanceService.measure(t,`a9_requested_${e}`,`a9_bids_back_${e}`),r&&this.report({type:"a9Load",pageRequestId:this.pageRequestId,measurement:r})}markCmpInitialization(){this.performanceService.mark("cmp_load_start")}measureCmpLoadTime(){const e=o.getSingleMeasurementMetricMeasureName("cmpLoad");this.performanceService.mark("cmp_load_end"),this.performanceService.measure(e,"cmp_load_start","cmp_load_end");const t=this.performanceService.getMeasure(e);t&&this.report({type:"cmpLoad",pageRequestId:this.pageRequestId,measurement:t})}shouldTrack(){return this.isSample}report(e){this.shouldTrack()&&this.config.reporters.forEach((t=>t(e)))}measureAndReportFirstAdRenderTime(){switch(this.env){case"production":new Promise((e=>{let t=!1;this.window.googletag.pubads().addEventListener("slotRenderEnded",(()=>{t||(e(),t=!0)}))})).then((()=>{const e=o.getSingleMeasurementMetricMeasureName("ttfr");this.performanceService.measure(e,"dfp_load_start","dfp_time_to_first_render_end");const t=this.performanceService.getMeasure(e);t&&this.report({type:"ttfr",pageRequestId:this.pageRequestId,measurement:t})}));break;case"test":this.logger.warn("ReportingService","In test environment no time-to-first-render will be reported")}}measureAndReportFirstAdLoadTime(){switch(this.env){case"production":new Promise((e=>{let t=!1;this.window.googletag.pubads().addEventListener("slotOnload",(()=>{t||(e(),t=!0)}))})).then((()=>{const e=o.getSingleMeasurementMetricMeasureName("ttfa");this.performanceService.measure(e,"dfp_load_start","dfp_time_to_first_ad_end");const t=this.performanceService.getMeasure(e);t&&this.report({type:"ttfa",pageRequestId:this.pageRequestId,measurement:t})}));break;case"test":this.logger.warn("In test environment no time-to-first-loads will be reported")}}awaitAdSlotContentLoaded(e){return e.isEmpty||!e.slot?Promise.resolve(e):new Promise((t=>{this.window.googletag.pubads().addEventListener("slotOnload",(r=>{r.slot.getAdUnitPath()===e.slot.getAdUnitPath()&&t(r)}))}))}measureAndReportDfpLoadTime(){const e=o.getSingleMeasurementMetricMeasureName("dfpLoad");this.performanceService.measure(e,"dfp_load_start","dfp_load_end");const t=this.performanceService.getMeasure(e);t&&this.report({type:"dfpLoad",pageRequestId:this.pageRequestId,measurement:t})}initAdSlotMetrics(){this.window.googletag.pubads().addEventListener("slotRenderEnded",(e=>{const t=this.minimalAdUnitName(e.slot.getAdUnitPath());this.performanceService.measure(`${t}_rendered`,"dfp_load_start",`${t}_rendered`),this.slotRenderEndedEvent[e.slot.getSlotElementId()]=e})),this.window.googletag.pubads().addEventListener("slotOnload",(e=>{const t=this.minimalAdUnitName(e.slot.getAdUnitPath());this.performanceService.mark(`${t}_content_loaded`),this.performanceService.measure(`${t}_render_content_loaded`,`${t}_rendered`,`${t}_content_loaded`),this.performanceService.measure(`${t}_content_loaded_total`,"dfp_load_start",`${t}_content_loaded`);const r=this.slotRenderEndedEvent[e.slot.getSlotElementId()],i=this.performanceService.getMeasure(`${t}_rendered`),o=this.performanceService.getMeasure(`${t}_render_content_loaded`),s=this.performanceService.getMeasure(`${t}_content_loaded_total`),n=this.performanceService.getMark(`${t}_refreshed`);if(!(s&&o&&i&&n&&r))return;delete this.slotRenderEndedEvent[e.slot.getSlotElementId()];const a={type:"adSlot",pageRequestId:this.pageRequestId,adUnitName:t,advertiserId:r.advertiserId,campaignId:r.campaignId,lineItemId:r.lineItemId||r.sourceAgnosticLineItemId,refresh:n,rendered:i,rendering:o,loaded:s};this.report(a)}))}minimalAdUnitName(e){return e.replace(this.adUnitRegex,"")}reportAdSlotsMetric(e){const t={type:"adSlots",numberAdSlots:e.length,numberEmptyAdSlots:e.filter((e=>e.isEmpty)).length};return this.report(t),e}uuidv4(){return"crypto"in this.window&&"getRandomValues"in this.window.crypto?([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,(e=>(e^this.window.crypto.getRandomValues(new Uint8Array(1))[0]&15>>e/4).toString(16))):"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(e=>{var t=16*Math.random()|0;return("x"==e?t:3&t|8).toString(16)}))}}t.ReportingService=o,t.noopReportingService={initialize:()=>{},markRefreshed:()=>{},markPrebidSlotsRequested:()=>{},measureAndReportPrebidBidsBack:()=>{},markA9fetchBids:()=>{},measureAndReportA9BidsBack:()=>{},markCmpInitialization:()=>{},measureCmpLoadTime:()=>{}}},793:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.SizeConfigService=void 0;const i=r(257),o=r(255);t.SizeConfigService=class{constructor(e,t,r){this.sizeConfig=e,this.supportedLabels=t,this.window=r,this.filterSupportedSizes=e=>this.isValid?0===this.supportedSizes.length?e:this.supportedSizes.filter((t=>e.some((e=>"fluid"===t?"fluid"===e:"fluid"!==e&&o.isSizeEqual(e,t))))):[];const s=0!==e.length?e.filter((e=>r.matchMedia(e.mediaQuery).matches&&(!e.labelAll||e.labelAll.every((e=>t.some((t=>t===e))))))):[];this.isValid=0===e.length||!(e.length>0&&0===s.length),this.supportedSizes=i.flatten(s.map((e=>e.sizesSupported))).map((e=>JSON.stringify(e))).filter(i.uniquePrimitiveFilter).map((e=>JSON.parse(e)))}static isFixedSize(e){return"fluid"!==e}filterSlot(e){return!e.sizes||0===e.sizes.length||this.filterSupportedSizes(e.sizes).length>0}}},996:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.SlotEventService=t.slotEventServiceConfigure=void 0;const i=r(157);t.slotEventServiceConfigure=e=>{let t;return i.mkConfigureStep("slot-event-service-configure",(r=>(t||(t=new Promise((t=>{e.initialize(r.window.googletag,r.env),t()}))),t)))},t.SlotEventService=class{constructor(e){this.logger=e,this.slotRenderEndedEventCallbacks=new Set,this.eventSources={window:{},document:{},element:{}}}initialize(e,t){switch(t){case"production":e.pubads().addEventListener("slotRenderEnded",(e=>{this.slotRenderEndedEventCallbacks.forEach((t=>t(e)))}))}}awaitAllAdSlotsRendered(e){return new Promise((t=>{const r=new Set(e.map((e=>e.adUnitPath))),i=[],o=e=>{r.delete(e.slot.getAdUnitPath()),i.push(e),0===r.size&&(t(i),this.slotRenderEndedEventCallbacks.delete(o))};this.slotRenderEndedEventCallbacks.add(o)}))}getOrCreateEventSource(e,t,r){const i=this.getEventSourceDictionary(e,r),o=i[e.event]||{eventSource:this.createEventSource(e,t,r),trigger:e};return i[e.event]=o,o.eventSource}removeEventSource(e,t){this.logger.debug("SlotEventService","remove EventSource configured by",e);const r=e.source,i=e.event;if("string"==typeof r){const o=this.eventSources.element[i];delete this.eventSources.element[i];const s=t.document.querySelector(r);o&&s&&s.removeEventListener(e.event,o.eventSource)}else if(r===t){const e=this.eventSources.window[i];delete this.eventSources.window[i],e&&t.removeEventListener(i,e.eventSource)}else{const e=this.eventSources.document[i];delete this.eventSources.document[i],e&&t.document.removeEventListener(i,e.eventSource)}}removeAllEventSources(e){this.logger.debug("SlotEventService","remove all EventSources"),Object.keys(this.eventSources.window).forEach((t=>{const r=this.eventSources.window[t];r&&e.removeEventListener(t,r.eventSource)})),Object.keys(this.eventSources.document).forEach((t=>{const r=this.eventSources.document[t];r&&e.document.removeEventListener(t,r.eventSource)})),Object.keys(this.eventSources.element).forEach((t=>{const r=this.eventSources.element[t];if(r&&"string"==typeof r.trigger.source){const i=e.document.querySelector(r.trigger.source);i&&i.removeEventListener(t,r.eventSource)}})),this.eventSources={window:{},document:{},element:{}}}getEventSourceDictionary(e,t){const r=e.source;return"string"==typeof r?this.eventSources.element:r===t?this.eventSources.window:this.eventSources.document}createEventSource(e,t,r){this.logger.debug("SlotEventService","create EventSource for trigger",e);const i=new o(t);if("string"==typeof e.source){const t=r.document.querySelector(e.source);if(!t)throw new Error(`Invalid query selector for refresh listener trigger: ${e.source}`);t.addEventListener(e.event,i,{passive:!0})}else e.source.addEventListener(e.event,i,{passive:!0});return i}};class o{constructor(e){this.throttleDuration=e,this.isNotThrottled=!0,this.callbacks=[]}handleEvent(e){this.throttleDuration?this.isNotThrottled&&(this.fireCallbacksAndClean(e),this.isNotThrottled=!1,setTimeout((()=>{this.isNotThrottled=!0}),1e3*this.throttleDuration)):this.fireCallbacksAndClean(e)}addCallback(e){this.callbacks.push(e)}fireCallbacksAndClean(e){this.callbacks=this.callbacks.filter((({callback:t,permanent:r})=>(t(e),r)))}}},598:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.packageJson=void 0,t.packageJson={version:"3.35.10"}},885:function(e,t,r){var i=this&&this.__createBinding||(Object.create?function(e,t,r,i){void 0===i&&(i=r),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,i){void 0===i&&(i=r),e[i]=t[r]}),o=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||i(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),o(r(95),t),o(r(193),t),o(r(76),t),o(r(81),t),o(r(955),t),o(r(879),t),o(r(542),t),o(r(414),t),o(r(157),t),o(r(643),t),o(r(198),t),o(r(996),t),o(r(569),t),o(r(257),t),o(r(611),t)},95:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},193:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.googletag=void 0,function(e){let t;!function(e){let t;!function(e){e[e.TOP_ANCHOR=2]="TOP_ANCHOR",e[e.BOTTOM_ANCHOR=3]="BOTTOM_ANCHOR",e[e.REWARDED=4]="REWARDED",e[e.INTERSTITIAL=5]="INTERSTITIAL"}(t=e.OutOfPageFormat||(e.OutOfPageFormat={}))}(t=e.enums||(e.enums={}))}(t.googletag||(t.googletag={}))},76:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.metaFromModule=void 0,t.metaFromModule=e=>({moduleType:e.moduleType,name:e.name,description:e.description,config:e.config()})},81:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},955:(e,t)=>{var r;Object.defineProperty(t,"__esModule",{value:!0}),t.prebidjs=void 0,(r=t.prebidjs||(t.prebidjs={})).Adform="adf",r.AdUp="aduptech",r.Criteo="criteo",r.AppNexusAst="appnexusAst",r.AppNexus="appnexus",r.EmxDigital="emx_digital",r.ImproveDigital="improvedigital",r.IndexExchange="ix",r.NanoInteractive="nanointeractive",r.JustPremium="justpremium",r.PubMatic="pubmatic",r.OpenX="openx",r.SmartAdServer="smartadserver",r.Unruly="unruly",r.Teads="teads",r.Triplelift="triplelift",r.Yieldlab="yieldlab",r.Spotx="spotx",r.ShowHeroes="showheroesBs",r.Xaxis="xhb",r.DSPX="dspx",r.Rubicon="rubicon",r.Recognified="rads",r.Visx="visx",r.Vlyby="vlyby",r.JustPremiumPushUpBillboard="pu",r.JustPremiumPushDownBillboard="pd",r.JustPremiumFloorAd="fa",r.JustPremiumClassicFloorAd="cf",r.JustPremiumSideAd="sa",r.JustPremiumWallpaper="wp",r.JustPremiumMobileScroller="is",r.JustPremiumMobileSkin="mt",r.JustPremiumCascadeAd="ca",r.JustPremiumVideoWallpaper="wv",r.JustPremiumVideoFloorAd="fv"},879:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.tcfapi=void 0,function(e){let t,r;!function(e){let t,r;!function(e){e[e.STORE_INFORMATION_ON_DEVICE=1]="STORE_INFORMATION_ON_DEVICE",e[e.SELECT_BASIC_ADS=2]="SELECT_BASIC_ADS",e[e.CREATE_PERSONALISED_ADS_PROFILE=3]="CREATE_PERSONALISED_ADS_PROFILE",e[e.SELECT_PERSONALISED_ADS=4]="SELECT_PERSONALISED_ADS",e[e.CREATE_PERSONALISED_CONTENT_PROFILE=5]="CREATE_PERSONALISED_CONTENT_PROFILE",e[e.SELECT_PERSONALISED_CONTENT=6]="SELECT_PERSONALISED_CONTENT",e[e.MEASURE_AD_PERFORMANCE=7]="MEASURE_AD_PERFORMANCE",e[e.MEASURE_CONTENT_PERFORMANCE=8]="MEASURE_CONTENT_PERFORMANCE",e[e.APPLY_MARKET_RESEARCH=9]="APPLY_MARKET_RESEARCH",e[e.DEVELOP_IMPROVE_PRODUCTS=10]="DEVELOP_IMPROVE_PRODUCTS"}(t=e.TCPurpose||(e.TCPurpose={})),function(e){e[e.NOT_ALLOWED=0]="NOT_ALLOWED",e[e.REQUIRE_CONSENT=1]="REQUIRE_CONSENT",e[e.REQUIRE_LI=2]="REQUIRE_LI"}(r=e.RestrictionType||(e.RestrictionType={}))}(t=e.responses||(e.responses={})),function(e){let t,r,i;!function(e){e.VISIBLE="visible",e.HIDDEN="hidden",e.DISABLED="disabled"}(t=e.DisplayStatus||(e.DisplayStatus={})),function(e){e.STUB="stub",e.LOADING="loading",e.LOADED="loaded",e.ERROR="error"}(r=e.CmpStatus||(e.CmpStatus={})),function(e){e.TC_LOADED="tcloaded",e.CMP_UI_SHOWN="cmpuishown",e.USER_ACTION_COMPLETE="useractioncomplete"}(i=e.EventStatus||(e.EventStatus={}))}(r=e.status||(e.status={}))}(t.tcfapi||(t.tcfapi={}))},257:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.isNotNull=t.uniquePrimitiveFilter=t.flatten=void 0,t.flatten=function(e){return e.reduce(((e,t)=>e.concat(t)),[])},t.uniquePrimitiveFilter=function(e,t,r){return r.indexOf(e)===t},t.isNotNull=function(e){return null!=e}},569:function(e,t,r){var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.createAssetLoaderService=t.AssetLoaderService=t.AssetLoadMethod=void 0;const o=i(r(297)),s=r(465);var n;!function(e){e[e.FETCH=0]="FETCH",e[e.TAG=1]="TAG"}(n=t.AssetLoadMethod||(t.AssetLoadMethod={}));class a{constructor(e,t){this.performanceService=e,this.window=t}loadScript(e,t=this.window.document.head){return this.awaitDomReady().then((()=>this.startPerformance(e.name))).then((()=>{switch(e.loadMethod){case n.FETCH:return this.loadAssetViaFetch(e,t);case n.TAG:return this.loadAssetViaTag(e,t)}})).then((()=>this.measurePerformance(e.name)))}loadJson(e,t){return this.startPerformance(e),this.window.fetch(t,{method:"GET",mode:"cors",headers:{"Content-Type":"application/json"}}).then((t=>(this.measurePerformance(e),t.ok?t.json():t.text().then((e=>Promise.reject(`${t.statusText}: ${e}`)))))).catch((t=>(this.measurePerformance(e),Promise.reject(t))))}loadAssetViaFetch(e,t){return this.window.fetch(e.assetUrl).then((e=>e.ok?Promise.resolve(e):Promise.reject(e))).then((e=>e.text())).then((e=>this.scriptTagWithBody(e))).then((e=>t.appendChild(e)))}scriptTagWithBody(e){const t=this.window.document.createElement("script");return t.type="text/javascript",t.async=!0,t.text=e,t}loadAssetViaTag(e,t){const r=this.scriptTagWithSrc(e.assetUrl);return new Promise(((e,i)=>{r.onload=e,r.onerror=i,t.appendChild(r)}))}scriptTagWithSrc(e){const t=this.window.document.createElement("script");return t.type="text/javascript",t.async=!0,t.src=e,t}awaitDomReady(){return new Promise((e=>{o.default(this.window,e)}))}startPerformance(e){this.performanceService.mark(`${e}_load_start`)}measurePerformance(e){this.performanceService.mark(`${e}_load_stop`),this.performanceService.measure(`${e}_load_time`,`${e}_load_start`,`${e}_load_stop`)}}t.AssetLoaderService=a,t.createAssetLoaderService=e=>new a(s.createPerformanceService(e),e)},818:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.BrowserStorageKeys=void 0,t.BrowserStorageKeys={moliEnv:"moli-env",testSlotSize:e=>`moli-test-slot-size-${e}`,debugDelay:"moli-debug-delay"}},389:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.setDebugDelayToLocalStorage=t.getDebugDelayFromLocalStorage=t.executeDebugDelay=void 0;const i=r(818),o=r(463);t.executeDebugDelay=(e,t)=>t?new Promise((r=>e.setTimeout(r,t))):Promise.resolve(),t.getDebugDelayFromLocalStorage=e=>Number(o.getBrowserStorageValue(i.BrowserStorageKeys.debugDelay,e.localStorage))||void 0,t.setDebugDelayToLocalStorage=(e,t)=>{t?o.setBrowserStorageValue(i.BrowserStorageKeys.debugDelay,t.toString(),e.localStorage):o.removeBrowserStorageValue(i.BrowserStorageKeys.debugDelay,e.localStorage)}},297:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.default=(e,t)=>{let r,i=[],o="object"==typeof e.document&&e.document,s=o&&o.documentElement.doScroll,n="DOMContentLoaded",a=o&&(s?/^loaded|^c/:/^loaded|^i|^c/).test(o.readyState);!a&&o&&o.addEventListener(n,r=()=>{if(o)for(o.removeEventListener(n,r),a=!0;r=i.shift();)r()}),a?setTimeout(t,0):i.push(t)}},141:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.resetEnvironmentOverrides=t.setEnvironmentOverrideInStorage=t.getAllEnvironmentOverrides=t.getActiveEnvironmentOverride=void 0;const i=r(257),o=r(818),s=r(463),n=r(30),a=r(570);t.getActiveEnvironmentOverride=e=>t.getAllEnvironmentOverrides(e)[0]||void 0,t.getAllEnvironmentOverrides=e=>[{source:"queryParam",environment:n.parseQueryString(e.location.search).get(a.QueryParameters.moliEnv)},{source:"sessionStorage",environment:s.getBrowserStorageValue(o.BrowserStorageKeys.moliEnv,e.sessionStorage)},{source:"localStorage",environment:s.getBrowserStorageValue(o.BrowserStorageKeys.moliEnv,e.localStorage)}].map((({source:e,environment:t})=>t&&(e=>!!["production","test"].find((t=>t===e)))(t)?{source:e,environment:t}:void 0)).filter(i.isNotNull),t.setEnvironmentOverrideInStorage=(e,t)=>s.setBrowserStorageValue(o.BrowserStorageKeys.moliEnv,e,t),t.resetEnvironmentOverrides=e=>{s.removeBrowserStorageValue(o.BrowserStorageKeys.moliEnv,e.sessionStorage),s.removeBrowserStorageValue(o.BrowserStorageKeys.moliEnv,e.localStorage),e.location.replace(n.updateQueryString(a.QueryParameters.moliEnv,void 0))}},463:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.removeBrowserStorageValue=t.setBrowserStorageValue=t.getBrowserStorageValue=void 0;const i=r(611);t.getBrowserStorageValue=(e,t=localStorage)=>{try{return t.getItem(e)}catch(r){return i.getDefaultLogger().debug(`Could not read value with key ${e} from browser storage`,t),null}},t.setBrowserStorageValue=(e,t,r=localStorage)=>{try{r.setItem(e,t)}catch(o){i.getDefaultLogger().debug(`Could not set key ${e} with value ${t} to browser storage`,r)}},t.removeBrowserStorageValue=(e,t=localStorage)=>{try{t.removeItem(e)}catch(r){i.getDefaultLogger().debug(`Could not remove key ${e} from browser storage`,t)}}},611:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ProxyLogger=t.getLogger=t.getDefaultLogger=void 0;const i=r(30);function o(e){return`background:${e}; color:#FFF; padding:3px; margin:3px; border-radius:5px; line-height: 15px;`}function s(e){switch(e){case"debug":return o("#49A0CC");case"info":return o("#61A172");case"warn":return o("#FFC300");case"error":return o("#C70039")}}function n(e){switch(e){case"AdPipeline":return o("#74ABC6");case"GAM":return o("#BA0E5F");case"Faktor CMP":return o("#9374C6");case"MoliGlobal":return o("#403073");case"SlotEventService":case"Prebid":return o("#4357AD");case"AdVisibilityService":return o("#d5ba3c");case"UserActivityService":return o("#19ad0e");default:return o("#052E53")}}function a(){return{debug(e,t,...r){console.debug(`%c[DEBUG]%c${e}%c${t}`,s("debug"),n(e),"",...r)},info(e,t,...r){console.info(`%c[INFO]%c${e}%c${t}`,s("info"),n(e),"",...r)},warn(e,t,...r){console.warn(`%c[WARN]%c${e}%c${t}`,s("warn"),n(e),"",...r)},error(e,t,...r){console.error(`%c[ERROR]%c${e}%c${t}`,s("error"),n(e),"",...r)}}}t.getDefaultLogger=a,t.getLogger=function(e,t){return function(e){const t=i.parseQueryString(e.location.search).get("moliDebug");return!!t&&"true"===t.toLowerCase()}(t)?a():(null==e?void 0:e.logger)?e.logger:function(){const e=()=>{};return{debug:e,info:e,warn:e,error:console.error}}()},t.ProxyLogger=class{constructor(e){this.logger=e,this.setLogger=e=>{this.logger=e}}debug(e,...t){this.logger.debug(e,...t)}error(e,...t){this.logger.error(e,...t)}info(e,...t){this.logger.info(e,...t)}warn(e,...t){this.logger.warn(e,...t)}}},465:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createPerformanceService=void 0;class r{mark(e){performance.mark(e)}measure(e,t,r){this.getMark(r)||performance.mark(r),performance.measure(e,t,r)}getMeasure(e){return performance.getEntriesByName(e,"measure")[0]}getMark(e){return performance.getEntriesByName(e,"mark")[0]}}class i{mark(e){}measure(e,t,r){}getMeasure(e){}getMark(e){}}t.createPerformanceService=e=>e&&"performance"in e&&"mark"in e.performance&&"measure"in e.performance&&"getEntriesByName"in e.performance?new r:new i},30:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.updateQueryString=t.parseQueryString=void 0;const r=e=>{const t=e.indexOf("=");return t>=0?[decodeURIComponent(e.slice(0,t)),decodeURIComponent(e.slice(t+1))]:[decodeURIComponent(e),""]};t.parseQueryString=e=>{const t=e.startsWith("?")?e.slice(1):e;return t.length>0?new Map(t.split("&").filter((e=>e.length>0)).map(r)):new Map},t.updateQueryString=(e,r,i,o)=>{i=i||[location.protocol,"//",location.host,location.pathname].join(""),o=o||window.location.search;const s=Array.from(t.parseQueryString(o).set(e,r||"").entries()).filter((e=>""!==e[1])).map((([e,t])=>`${e}=${t}`)).join("&");return[i,s?"?":"",s].join("")}},570:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.QueryParameters=void 0,t.QueryParameters={moliEnv:"moliEnv"}},255:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.isSizeEqual=void 0,t.isSizeEqual=(e,t)=>e[0]===t[0]&&e[1]===t[1]},249:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.removeTestSlotSizeFromLocalStorage=t.createTestSlots=void 0;const i=r(793),o=r(257),s=r(818),n=r(463),a=e=>`${e}__container`;t.createTestSlots=(e,t)=>{const r=d(e,t);return r.forEach((({slot:e,container:t})=>{t.appendChild(c(e))})),r},t.removeTestSlotSizeFromLocalStorage=e=>n.removeBrowserStorageValue(s.BrowserStorageKeys.testSlotSize(e.domId));const d=(e,t)=>(t.forEach((t=>{const{adSlot:r,moliSlot:i}=t,o=a(i.domId),s=document.createElement("div");s.id=o,e.window.googletag.content().setContent(r,s.outerHTML),e.logger.debug("GAM",`Set content for slot: [DomID] ${i.domId} [AdUnitPath] ${i.adUnitPath}`)})),l(t)),l=e=>e.map((e=>{const t=document.getElementById(a(e.moliSlot.domId));return t?{slot:e,container:t}:void 0})).filter(o.isNotNull),c=e=>{const t=u(e),r=g(e.moliSlot,t);if("hidden"===r)return document.createElement("div");{const i=document.createElement("div"),[o,s]=r;i.style.cssText=`\n      position: relative; display: inline-flex; flex-direction: column; align-items: center; justify-content: center;\n      width: ${o}px; height: ${s}px; padding: 6px; border: 2px dotted gray; background-color: #fff;\n      background-image: linear-gradient(90deg, transparent 79px, #abced4 79px, #abced4 81px, transparent 81px), linear-gradient(#eee .1em, transparent .1em);\n      background-size: 100% 1.2em;\n    `;const n=document.createElement("h4");n.innerHTML=`<strong>${e.moliSlot.domId}</strong>`,i.appendChild(n);const a=document.createElement("span");a.style.color="#656565";const d=([e,t])=>a.innerText=`(${e}x${t})`;d([o,s]),n.appendChild(a);const l=document.createElement("div");l.style.cssText="position: absolute; top: 5px; left: 5px",i.appendChild(l);const c=(t,r)=>{if("hidden"===t)i.style.display="none";else{const[e,o]=t;i.style.width=`${e}px`,i.style.height=`${o}px`,d(t),S(r)}p(e.moliSlot,t)},u="1px dotted white",g="1px solid black",f=document.createElement("button");f.innerText="hide",f.title="Once hidden, it can only be restored using the moli console (or by clearing local storage manually)",f.style.cssText=`font-size: 10px; background: #656565; color: white; border: ${u};`,f.addEventListener("click",(()=>c("hidden",f)));const h=[...t.map((e=>{const[t,i]=e,o=m(r,e),s=document.createElement("button");return s.innerText=`${t}x${i}`,s.style.cssText=`font-size: 10px; background: #00a4a6; color: white; border: ${o?g:u};`,s.addEventListener("click",(()=>c(e,s))),s})),f];h.forEach((e=>l.appendChild(e)));const S=e=>{h.forEach((e=>e.style.border=u)),e.style.border=g};return i}},u=e=>e.filterSupportedSizes(e.moliSlot.sizes).filter(i.SizeConfigService.isFixedSize).filter((([e,t])=>e>1&&t>1)),g=(e,t)=>{const r=f(e);if(r&&("hidden"===r||h(t,r)))return r;{const e=Math.floor(Math.random()*t.length);return 0===t.length?[300,250]:t[e]}},p=(e,t)=>n.setBrowserStorageValue(s.BrowserStorageKeys.testSlotSize(e.domId),JSON.stringify(t)),f=e=>{const t=n.getBrowserStorageValue(s.BrowserStorageKeys.testSlotSize(e.domId));if(t)try{const e=JSON.parse(t);return(e=>"hidden"===e||Array.isArray(e)&&2===e.length&&"number"==typeof e[0]&&"number"==typeof e[1])(e)?e:void 0}catch(e){return}},m=(e,t)=>{const[r,i]=e,[o,s]=t;return r===o&&i===s},h=(e,t)=>e.some((e=>m(e,t)))},404:(e,t,r)=>{function i(e){return function(e){if(Array.isArray(e))return o(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return o(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?o(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function o(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,i=new Array(t);r<t;r++)i[r]=e[r];return i}function s(){return(s=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e}).apply(this,arguments)}Object.defineProperty(t,"__esModule",{value:!0}),t.prebidRequestBids=t.prebidPrepareRequestAds=t.prebidConfigure=t.prebidRemoveAdUnits=t.prebidInit=void 0;var n=r(157),a=r(793),d=function(e){return new Promise((function(t,r){e.setTimeout((function(){return r("Prebid did not resolve in time. Maybe you forgot to import the prebid distribution in the ad tag")}),5e3)}))},l=function(e){return new Promise((function(t){e.pbjs=e.pbjs||{que:[]},e.pbjs.que.push(t)}))},c=function(e){return!!e.moliSlot.prebid};t.prebidInit=function(){return n.mkInitStep("prebid-init",(function(e){return Promise.race([l(e.window),d(e.window)])}))},t.prebidRemoveAdUnits=function(){return n.mkConfigureStep("prebid-remove-adunits",(function(e){return new Promise((function(t){e.window.pbjs=e.window.pbjs||{que:[]};var r=e.window.pbjs.adUnits;r&&(e.logger.debug("Prebid","Destroying prebid adUnits",r),r.forEach((function(t){return e.window.pbjs.removeAdUnit(t.code)}))),t()}))}))},t.prebidConfigure=function(e){var t;return n.mkConfigureStep("prebid-configure",(function(r,i){return t||(t=new Promise((function(t){e.bidderSettings&&(r.window.pbjs.bidderSettings=e.bidderSettings),r.window.pbjs.setConfig(e.config),t()}))),t}))},t.prebidPrepareRequestAds=function(){return n.mkPrepareRequestAdsStep("prebid-prepare-adunits",n.LOW_PRIORITY,(function(e,t){return new Promise((function(r){var o=t.filter(c).map((function(t){var r=t.moliSlot,i=t.priceRule,o=t.filterSupportedSizes,n=e.config.targeting,d=n&&n.keyValues?n.keyValues:{},l=i?i.floorprice:void 0,c=e.labelConfigService.getSupportedLabels();return e.logger.debug("Prebid",e.requestId,"Price Rule",i,r.domId),function(e,t){if("function"==typeof t){var r=t(e);return Array.isArray(r)?r:[r]}return Array.isArray(t)?t:[t]}({keyValues:d,floorPrice:l,priceRule:i,labels:c,isMobile:-1===c.indexOf("desktop")},r.prebid).map((function(t){var i=t.adUnit.mediaTypes.banner,n=t.adUnit.mediaTypes.video,d=t.adUnit.mediaTypes.native,l=i?o(i.sizes).filter(a.SizeConfigService.isFixedSize):[],c=n?u(n.playerSize,o):[],g=t.adUnit.bids.filter((function(t){return e.labelConfigService.filterSlot(t)})).map((function(e){return{bidder:e.bidder,params:e.params}})),p=c.length>0&&!(null==n?void 0:n.w)&&!(null==n?void 0:n.h)?{w:c[0][0],h:c[0][1]}:{},f=n?{video:s(s(s({},n),{playerSize:0===c.length?void 0:c}),p)}:void 0,m=i&&l.length>0?{banner:s(s({},i),{sizes:l})}:void 0,h=d?{native:s({},d)}:void 0;return s(s({},t.adUnit),{code:t.adUnit.code||r.domId,mediaTypes:s(s(s({},f),m),h),bids:g})})).filter((function(t){return t.bids.length>0&&t.mediaTypes&&(t.mediaTypes.banner||t.mediaTypes.video||t.mediaTypes.native)&&!function(e,t){return!!t.pbjs.adUnits&&t.pbjs.adUnits.some((function(t){return e.code===t.code}))}(t,e.window)}))})).reduce((function(e,t){return[].concat(i(e),i(t))}),[]);o.forEach((function(t){e.logger.debug("Prebid",e.requestId,"Prebid add ad unit: [Code] ".concat(t.code),t)})),e.window.pbjs.addAdUnits(o),r()}))}))},t.prebidRequestBids=function(e,t){return n.mkRequestBidsStep("prebid-request-bids",(function(r,i){return new Promise((function(o){var s=i.filter(c).map((function(e){return e.moliSlot.domId}));if(0===s.length)return r.logger.debug("Prebid","skip request bids. All slots were filtered.",i.map((function(e){return e.moliSlot}))),o();var n=!1;r.logger.debug("Prebid","Prebid request bids: \n\t\t\t".concat(s.join("\n\t\t\t"))),r.reportingService.markPrebidSlotsRequested(r.requestId),r.window.pbjs.requestBids({adUnitCodes:s,bidsBackHandler:function(a,d,l){r.logger.info("Prebid",l,a,i.map((function(e){return e.moliSlot.domId})));try{if(n)return void r.logger.warn("Prebid","ad server request already sent [".concat(r.requestId,"]"),l,i.map((function(e){return e.moliSlot})));if(!a)return r.logger.warn("Prebid","Undefined bid response map for ad unit codes: ".concat(s.join(", "))),o();if(n=!0,r.reportingService.measureAndReportPrebidBidsBack(r.requestId),e.listener){var c=t&&t.keyValues?t.keyValues:{},u="function"==typeof e.listener?e.listener({keyValues:c}):e.listener;if(u.preSetTargetingForGPTAsync)try{u.preSetTargetingForGPTAsync(a,d,i)}catch(e){r.logger.error("Prebid","Failed to execute prebid preSetTargetingForGPTAsync listener. ".concat(e))}}r.window.pbjs.setTargetingForGPTAsync(s),s.forEach((function(e){var t=a[e];t?r.logger.debug("Prebid",l,"Prebid bid response: [DomID]: ".concat(e," \n\t\t\t").concat(t.bids.map((function(e){return"[bidder] ".concat(e.bidder," [width] ").concat(e.width," [height] ").concat(e.height," [cpm] ").concat(e.cpm)})))):r.logger.debug("Prebid",l,"Prebid bid response: [DomID] ".concat(e," ---\x3e no bid response"))})),o()}catch(e){r.logger.error("Prebid","DfpService:: could not resolve bidsBackHandler"+JSON.stringify(e)),o()}}})}))}))};var u=function(e,t){var r;return e?t((r=e,r&&2===r.length&&"number"==typeof r[0]&&"number"==typeof r[1]?[e]:e)).filter(a.SizeConfigService.isFixedSize):[]}}},t={};(function r(i){var o=t[i];if(void 0!==o)return o.exports;var s=t[i]={exports:{}};return e[i].call(s.exports,s,s.exports,r),s.exports})(885).initAdTag(window)})();