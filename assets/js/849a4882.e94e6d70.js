"use strict";(self.webpackChunkthe_publisher_ad_tag=self.webpackChunkthe_publisher_ad_tag||[]).push([[9527],{8453:(e,n,l)=>{l.d(n,{R:()=>t,x:()=>r});var s=l(6540);const i={},d=s.createContext(i);function t(e){const n=s.useContext(d);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function r(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:t(e.components),s.createElement(d.Provider,{value:n},e.children)}},9906:(e,n,l)=>{l.r(n),l.d(n,{assets:()=>o,contentTitle:()=>r,default:()=>h,frontMatter:()=>t,metadata:()=>s,toc:()=>c});const s=JSON.parse('{"id":"modules/cleanup","title":"cleanup","description":"Classes","source":"@site/docs/modules/cleanup.md","sourceDirName":"modules","slug":"/modules/cleanup","permalink":"/moli-ad-tag/docs/modules/cleanup","draft":false,"unlisted":false,"editUrl":"https://github.com/highfivve/moli-ad-tag/docs/modules/cleanup.md","tags":[],"version":"current","frontMatter":{},"sidebar":"Modules","previous":{"title":"blocklist-url","permalink":"/moli-ad-tag/docs/modules/blocklist-url"},"next":{"title":"confiant","permalink":"/moli-ad-tag/docs/modules/confiant"}}');var i=l(4848),d=l(8453);const t={},r="cleanup",o={},c=[{value:"Classes",id:"classes",level:2},{value:"Cleanup",id:"cleanup-1",level:3},{value:"Integration",id:"integration",level:2},{value:"Dspx Skin",id:"dspx-skin",level:2},{value:"Implements",id:"implements",level:4},{value:"Constructors",id:"constructors",level:4},{value:"new Cleanup()",id:"new-cleanup",level:5},{value:"Returns",id:"returns",level:6},{value:"Properties",id:"properties",level:4},{value:"description",id:"description",level:5},{value:"Implementation of",id:"implementation-of",level:6},{value:"moduleType",id:"moduletype",level:5},{value:"Implementation of",id:"implementation-of-1",level:6},{value:"name",id:"name",level:5},{value:"Implementation of",id:"implementation-of-2",level:6},{value:"Methods",id:"methods",level:4},{value:"cleanUp()",id:"cleanup-2",level:5},{value:"Parameters",id:"parameters",level:6},{value:"Returns",id:"returns-1",level:6},{value:"config__()",id:"config__",level:5},{value:"Returns",id:"returns-2",level:6},{value:"Implementation of",id:"implementation-of-3",level:6},{value:"configureSteps__()",id:"configuresteps__",level:5},{value:"Returns",id:"returns-3",level:6},{value:"Implementation of",id:"implementation-of-4",level:6},{value:"configure__()",id:"configure__",level:5},{value:"Parameters",id:"parameters-1",level:6},{value:"Returns",id:"returns-4",level:6},{value:"Implementation of",id:"implementation-of-5",level:6},{value:"initSteps__()",id:"initsteps__",level:5},{value:"Returns",id:"returns-5",level:6},{value:"Implementation of",id:"implementation-of-6",level:6},{value:"prepareRequestAdsSteps__()",id:"preparerequestadssteps__",level:5},{value:"Returns",id:"returns-6",level:6},{value:"Implementation of",id:"implementation-of-7",level:6}];function a(e){const n={a:"a",blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",h5:"h5",h6:"h6",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,d.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"cleanup",children:"cleanup"})}),"\n",(0,i.jsx)(n.h2,{id:"classes",children:"Classes"}),"\n",(0,i.jsx)(n.h3,{id:"cleanup-1",children:"Cleanup"}),"\n",(0,i.jsx)(n.h1,{id:"cleanup-module",children:"Cleanup Module"}),"\n",(0,i.jsx)(n.p,{children:"Cleans up special formats if enabled (on user navigation and ad reload), especially developed for SPAs."}),"\n",(0,i.jsx)(n.p,{children:"The configs can either provide CSS selectors of the html elements that are part of the special/out-of-page formats and should be deleted\nor JS as single strings that contain the logic to remove the special format."}),"\n",(0,i.jsx)(n.p,{children:"Please note: if you want to execute more than one statement/line of JS, please provide each line as separate string in the array.\nLike this we make sure that each line is tried to be executed and if one fails, the next one is still executed.\nOnly global variables can be accessed in the JS strings!"}),"\n",(0,i.jsx)(n.h2,{id:"integration",children:"Integration"}),"\n",(0,i.jsxs)(n.p,{children:["In your ",(0,i.jsx)(n.code,{children:"index.ts"})," import the Cleanup module and register the module."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-js",children:"moli.registerModule(new CleanupModule({\n    enabled: true,\n    configs: [\n      {\n        bidder: 'seedtag',\n        domId: 'wallpaper-pixel',\n        deleteMethod: {\n          cssSelectors: ['div[data-seedtag-format=\"inscreen\"]']\n        }\n      },\n      {\n        bidder: 'dspx',\n        domId: 'lazy-loading-adslot-1',\n        deleteMethod: {\n          jsAsString: ['window.dspx_start_called.dspxPageSkin.unload();', 'window.dspx_start_called.counter = 0;']\n        }\n      }\n    }]));\n"})}),"\n",(0,i.jsx)(n.h2,{id:"dspx-skin",children:"Dspx Skin"}),"\n",(0,i.jsxs)(n.p,{children:["The dspx wallpaper can be cleaned as shown in the example above. The ",(0,i.jsx)(n.code,{children:"dspx_start_called.dspxPageSkin.unload()"})," function is called to remove the wallpaper from the page."]}),"\n",(0,i.jsxs)(n.p,{children:["Dspx itself also sets a global variable ",(0,i.jsx)(n.code,{children:"dspx_start_called.counter"})," on the window object. This variable is used to count the number of times the skin has been loaded.\nDspx unloads the skin itself, if the counter holds a value greater than 1 in order to prevent multiple loads on the page."]}),"\n",(0,i.jsx)(n.p,{children:"In SPAs, a value greater than 1 can happen as soon as a user navigates to a sub-page where the wallpaper ad slot is available and refreshed.\nIf we try to unload() a second time, the dspx script crashes. Therefore we have to reset the counter to 0 after each clean-up."}),"\n",(0,i.jsx)(n.h4,{id:"implements",children:"Implements"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.code,{children:"IModule"})}),"\n"]}),"\n",(0,i.jsx)(n.h4,{id:"constructors",children:"Constructors"}),"\n",(0,i.jsx)(n.h5,{id:"new-cleanup",children:"new Cleanup()"}),"\n",(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"new Cleanup"}),"(): ",(0,i.jsx)(n.a,{href:"/moli-ad-tag/docs/modules/cleanup#cleanup",children:(0,i.jsx)(n.code,{children:"Cleanup"})})]}),"\n"]}),"\n",(0,i.jsx)(n.h6,{id:"returns",children:"Returns"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.a,{href:"/moli-ad-tag/docs/modules/cleanup#cleanup",children:(0,i.jsx)(n.code,{children:"Cleanup"})})}),"\n",(0,i.jsx)(n.h4,{id:"properties",children:"Properties"}),"\n",(0,i.jsx)(n.h5,{id:"description",children:"description"}),"\n",(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"readonly"})," ",(0,i.jsx)(n.strong,{children:"description"}),": ",(0,i.jsx)(n.code,{children:"string"})," = ",(0,i.jsx)(n.code,{children:"'cleanup out-of-page formats on navigation or ad-reload'"})]}),"\n"]}),"\n",(0,i.jsx)(n.h6,{id:"implementation-of",children:"Implementation of"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.code,{children:"IModule.description"})}),"\n",(0,i.jsx)(n.h5,{id:"moduletype",children:"moduleType"}),"\n",(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"readonly"})," ",(0,i.jsx)(n.strong,{children:"moduleType"}),": ",(0,i.jsx)(n.code,{children:"ModuleType"})," = ",(0,i.jsx)(n.code,{children:"'creatives'"})]}),"\n"]}),"\n",(0,i.jsx)(n.h6,{id:"implementation-of-1",children:"Implementation of"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.code,{children:"IModule.moduleType"})}),"\n",(0,i.jsx)(n.h5,{id:"name",children:"name"}),"\n",(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"readonly"})," ",(0,i.jsx)(n.strong,{children:"name"}),": ",(0,i.jsx)(n.code,{children:"string"})," = ",(0,i.jsx)(n.code,{children:"'cleanup'"})]}),"\n"]}),"\n",(0,i.jsx)(n.h6,{id:"implementation-of-2",children:"Implementation of"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.code,{children:"IModule.name"})}),"\n",(0,i.jsx)(n.h4,{id:"methods",children:"Methods"}),"\n",(0,i.jsx)(n.h5,{id:"cleanup-2",children:"cleanUp()"}),"\n",(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"cleanUp"}),"(",(0,i.jsx)(n.code,{children:"context"}),", ",(0,i.jsx)(n.code,{children:"configs"}),"): ",(0,i.jsx)(n.code,{children:"void"})]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"Public for testing and spying purposes"}),"\n",(0,i.jsx)(n.h6,{id:"parameters",children:"Parameters"}),"\n",(0,i.jsxs)(n.p,{children:["\u2022 ",(0,i.jsx)(n.strong,{children:"context"}),": ",(0,i.jsx)(n.code,{children:"AdPipelineContext"})]}),"\n",(0,i.jsxs)(n.p,{children:["\u2022 ",(0,i.jsx)(n.strong,{children:"configs"}),": ",(0,i.jsx)(n.code,{children:"CleanupConfig"}),"[]"]}),"\n",(0,i.jsx)(n.h6,{id:"returns-1",children:"Returns"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.code,{children:"void"})}),"\n",(0,i.jsx)(n.h5,{id:"config__",children:"config__()"}),"\n",(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"config__"}),"(): ",(0,i.jsx)(n.code,{children:"null"})," | ",(0,i.jsx)(n.code,{children:"Object"})]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"If the module has some sort of configuration this can be fetched with this method"}),"\n",(0,i.jsx)(n.h6,{id:"returns-2",children:"Returns"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"null"})," | ",(0,i.jsx)(n.code,{children:"Object"})]}),"\n",(0,i.jsx)(n.h6,{id:"implementation-of-3",children:"Implementation of"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.code,{children:"IModule.config__"})}),"\n",(0,i.jsx)(n.h5,{id:"configuresteps__",children:"configureSteps__()"}),"\n",(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"configureSteps__"}),"(): ",(0,i.jsx)(n.code,{children:"ConfigureStep"}),"[]"]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"Returns a list of steps that should be executed in the ad pipeline."}),"\n",(0,i.jsx)(n.h6,{id:"returns-3",children:"Returns"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"ConfigureStep"}),"[]"]}),"\n",(0,i.jsx)(n.h6,{id:"implementation-of-4",children:"Implementation of"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.code,{children:"IModule.configureSteps__"})}),"\n",(0,i.jsx)(n.h5,{id:"configure__",children:"configure__()"}),"\n",(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"configure__"}),"(",(0,i.jsx)(n.code,{children:"modulesConfig"}),"?): ",(0,i.jsx)(n.code,{children:"void"})]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"Initialize the module with the given module configuration.\nDepending on the configuration the module may become active or inactive."}),"\n",(0,i.jsx)(n.h6,{id:"parameters-1",children:"Parameters"}),"\n",(0,i.jsxs)(n.p,{children:["\u2022 ",(0,i.jsx)(n.strong,{children:"modulesConfig?"}),": ",(0,i.jsx)(n.code,{children:"ModulesConfig"})]}),"\n",(0,i.jsx)(n.h6,{id:"returns-4",children:"Returns"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.code,{children:"void"})}),"\n",(0,i.jsx)(n.h6,{id:"implementation-of-5",children:"Implementation of"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.code,{children:"IModule.configure__"})}),"\n",(0,i.jsx)(n.h5,{id:"initsteps__",children:"initSteps__()"}),"\n",(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"initSteps__"}),"(): ",(0,i.jsx)(n.code,{children:"InitStep"}),"[]"]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"Returns a list of steps that should be executed in the ad pipeline."}),"\n",(0,i.jsx)(n.h6,{id:"returns-5",children:"Returns"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"InitStep"}),"[]"]}),"\n",(0,i.jsx)(n.h6,{id:"implementation-of-6",children:"Implementation of"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.code,{children:"IModule.initSteps__"})}),"\n",(0,i.jsx)(n.h5,{id:"preparerequestadssteps__",children:"prepareRequestAdsSteps__()"}),"\n",(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"prepareRequestAdsSteps__"}),"(): ",(0,i.jsx)(n.code,{children:"PrepareRequestAdsStep"}),"[]"]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"Returns a list of steps that should be executed in the ad pipeline."}),"\n",(0,i.jsx)(n.h6,{id:"returns-6",children:"Returns"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"PrepareRequestAdsStep"}),"[]"]}),"\n",(0,i.jsx)(n.h6,{id:"implementation-of-7",children:"Implementation of"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.code,{children:"IModule.prepareRequestAdsSteps__"})})]})}function h(e={}){const{wrapper:n}={...(0,d.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(a,{...e})}):a(e)}}}]);