/* ad tag library 5.8.12 by highfivve.com */
"use strict";(()=>{var Jr=Object.defineProperty,Xr=Object.defineProperties;var Qr=Object.getOwnPropertyDescriptors;var Ve=Object.getOwnPropertySymbols;var wt=Object.prototype.hasOwnProperty,qt=Object.prototype.propertyIsEnumerable;var Bt=(t,e,i)=>e in t?Jr(t,e,{enumerable:!0,configurable:!0,writable:!0,value:i}):t[e]=i,v=(t,e)=>{for(var i in e||(e={}))wt.call(e,i)&&Bt(t,i,e[i]);if(Ve)for(var i of Ve(e))qt.call(e,i)&&Bt(t,i,e[i]);return t},w=(t,e)=>Xr(t,Qr(e));var Dt=(t,e)=>{var i={};for(var r in t)wt.call(t,r)&&e.indexOf(r)<0&&(i[r]=t[r]);if(t!=null&&Ve)for(var r of Ve(t))e.indexOf(r)<0&&qt.call(t,r)&&(i[r]=t[r]);return i};var Ne=(t,e,i)=>new Promise((r,o)=>{var n=d=>{try{a(i.next(d))}catch(u){o(u)}},s=d=>{try{a(i.throw(d))}catch(u){o(u)}},a=d=>d.done?r(d.value):Promise.resolve(d.value).then(n,s);a((i=i.apply(t,e)).next())});var je=(t,e)=>{let i=[],r,o=typeof t.document=="object"&&t.document,n=o&&o.documentElement.doScroll,s="DOMContentLoaded",a=o&&(n?/^loaded|^c/:/^loaded|^i|^c/).test(o.readyState);!a&&o&&o.addEventListener(s,r=()=>{if(o)for(o.removeEventListener(s,r),a=!0;r=i.shift();)r()}),a?setTimeout(e,0):i.push(e)};var vt=class{constructor(e){this.window=e}loadScript(e,i=this.window.document.head){return this.awaitDomReady().then(()=>{switch(e.loadMethod){case 0:return this.loadAssetViaFetch(e,i);case 1:return this.loadAssetViaTag(e,i)}})}loadJson(e,i){return this.window.fetch(i,{method:"GET",mode:"cors",headers:{"Content-Type":"application/json"}}).then(r=>r.ok?r.json():r.text().then(o=>Promise.reject(`${r.statusText}: ${o}`))).catch(r=>Promise.reject(r))}loadAssetViaFetch(e,i){return this.window.fetch(e.assetUrl).then(r=>r.ok?Promise.resolve(r):Promise.reject(r)).then(r=>r.text()).then(r=>this.scriptTagWithBody(r)).then(r=>i.appendChild(r))}scriptTagWithBody(e){let i=this.window.document.createElement("script");return i.type="text/javascript",i.async=!0,i.text=e,i}loadAssetViaTag(e,i){let r=this.scriptTag(e);return new Promise((o,n)=>{r.onload=o,r.onerror=n,i.appendChild(r)})}scriptTag(e){let i=this.window.document.createElement("script");return e.type==="module"?i.type="module":e.type==="nomodule"?(i.type="text/javascript",i.setAttribute("nomodule","")):e.assetUrl.endsWith("mjs")?i.type="module":i.type="text/javascript",i.async=!0,i.src=e.assetUrl,i}awaitDomReady(){return new Promise(e=>{je(this.window,e)})}},ze=t=>new vt(t);var Zr=t=>{let e=t.indexOf("=");if(e>=0){let i=decodeURIComponent(t.slice(0,e)),r=decodeURIComponent(t.slice(e+1));return[i,r]}else return[decodeURIComponent(t),""]},Pe=t=>{try{let e=t.startsWith("?")?t.slice(1):t;return e.length>0?new Map(e.split("&").filter(i=>i.length>0).map(Zr)):new Map}catch(e){return console.error(e),new Map}};function en(t){try{let e="moliDebug";return!!Pe(t.location.search).get(e)||!!t.sessionStorage.getItem(e)||!!t.localStorage.getItem(e)}catch(e){return!1}}function tn(){let t=()=>{};return{debug:t,info:t,warn:t,error:console.error}}function ae(t){return`background:${t}; color:#FFF; padding:3px; margin:3px; border-radius:5px; line-height: 15px;`}function Fe(t){switch(t){case"debug":return ae("#49A0CC");case"info":return ae("#61A172");case"warn":return ae("#FFC300");case"error":return ae("#C70039")}}function Ge(t){switch(t){case"AdPipeline":return ae("#74ABC6");case"GAM":return ae("#BA0E5F");case"MoliGlobal":return ae("#403073");case"Prebid":return ae("#4357AD");case"AdVisibilityService":return ae("#d5ba3c");case"UserActivityService":return ae("#19ad0e");case"Adex DMP":return ae("#003E74");default:return ae("#052E53")}}function ce(){return{debug(t,e,...i){console.debug(`%c[DEBUG]%c${t}%c${e}`,Fe("debug"),Ge(t),"",...i)},info(t,e,...i){console.info(`%c[INFO]%c${t}%c${e}`,Fe("info"),Ge(t),"",...i)},warn(t,e,...i){console.warn(`%c[WARN]%c${t}%c${e}`,Fe("warn"),Ge(t),"",...i)},error(t,e,...i){console.error(`%c[ERROR]%c${t}%c${e}`,Fe("error"),Ge(t),"",...i)}}}function j(t,e){return en(e)?ce():t&&t.logger?t.logger:tn()}var We=class{constructor(e){this.logger=e;this.setLogger=e=>{this.logger=e}}debug(e,...i){this.logger.debug(e,...i)}error(e,...i){this.logger.error(e,...i)}info(e,...i){this.logger.info(e,...i)}warn(e,...i){this.logger.warn(e,...i)}};var $e=(t,e,i,r)=>{let o=t.slots.find(n=>n.domId===e);if(o){let n=w(v({},o),{domId:i});return w(v({},t),{slots:[...t.slots,n]})}else return r.error("MoliGlobal","no infinite ad slot configured!",t),t};function Ie(t){return t.reduce((e,i)=>e.concat(i),[])}function Z(t,e,i){return i.indexOf(t)===e}function G(t){return t!=null}var ht=["mobile","desktop","android","ios"],xe=(t,e,i)=>{let r=e.some(l=>ht.indexOf(l)>-1),o=t.filter(l=>i.matchMedia(l.mediaQuery).matches),n=[...r?[]:Ie(o.map(l=>l.labelsSupported)),...e].filter(Z);return{filterSlot:l=>{var p,g;let c=!0;return n.length&&((p=l.labelAll)!=null&&p.length)&&(c=l.labelAll.every(m=>n.indexOf(m)>-1)),n.length&&l.labelAny&&!((g=l.labelAll)!=null&&g.length)&&(c=l.labelAny.some(m=>n.indexOf(m)>-1)),c},getSupportedLabels:()=>n,getDeviceLabel:()=>n.find(l=>ht.indexOf(l)>-1)||"mobile",addLabel:l=>{ht.includes(l)||n.push(l)}}},St=(t,e,i,r)=>xe(i!=null?i:[],[...(r==null?void 0:r.labels)||[],...e.labels],t).getDeviceLabel();var x;(i=>{let t;(n=>{let r;(I=>(I[I.STORE_INFORMATION_ON_DEVICE=1]="STORE_INFORMATION_ON_DEVICE",I[I.SELECT_BASIC_ADS=2]="SELECT_BASIC_ADS",I[I.CREATE_PERSONALISED_ADS_PROFILE=3]="CREATE_PERSONALISED_ADS_PROFILE",I[I.SELECT_PERSONALISED_ADS=4]="SELECT_PERSONALISED_ADS",I[I.CREATE_PERSONALISED_CONTENT_PROFILE=5]="CREATE_PERSONALISED_CONTENT_PROFILE",I[I.SELECT_PERSONALISED_CONTENT=6]="SELECT_PERSONALISED_CONTENT",I[I.MEASURE_AD_PERFORMANCE=7]="MEASURE_AD_PERFORMANCE",I[I.MEASURE_CONTENT_PERFORMANCE=8]="MEASURE_CONTENT_PERFORMANCE",I[I.APPLY_MARKET_RESEARCH=9]="APPLY_MARKET_RESEARCH",I[I.DEVELOP_IMPROVE_PRODUCTS=10]="DEVELOP_IMPROVE_PRODUCTS",I[I.USE_LIMITED_DATA_TO_SElECT_CONTENT=11]="USE_LIMITED_DATA_TO_SElECT_CONTENT"))(r=n.TCPurpose||(n.TCPurpose={}));let o;(u=>(u[u.NOT_ALLOWED=0]="NOT_ALLOWED",u[u.REQUIRE_CONSENT=1]="REQUIRE_CONSENT",u[u.REQUIRE_LI=2]="REQUIRE_LI"))(o=n.RestrictionType||(n.RestrictionType={}))})(t=i.responses||(i.responses={}));let e;(s=>{let r;(l=>(l.VISIBLE="visible",l.HIDDEN="hidden",l.DISABLED="disabled"))(r=s.DisplayStatus||(s.DisplayStatus={}));let o;(c=>(c.STUB="stub",c.LOADING="loading",c.LOADED="loaded",c.ERROR="error"))(o=s.CmpStatus||(s.CmpStatus={}));let n;(l=>(l.TC_LOADED="tcloaded",l.CMP_UI_SHOWN="cmpuishown",l.USER_ACTION_COMPLETE="useractioncomplete"))(n=s.EventStatus||(s.EventStatus={}))})(e=i.status||(i.status={}))})(x||(x={}));var rn=x.status.EventStatus,nn=x.status.CmpStatus,on=[x.responses.TCPurpose.STORE_INFORMATION_ON_DEVICE,x.responses.TCPurpose.SELECT_BASIC_ADS,x.responses.TCPurpose.CREATE_PERSONALISED_ADS_PROFILE,x.responses.TCPurpose.SELECT_PERSONALISED_ADS,x.responses.TCPurpose.CREATE_PERSONALISED_CONTENT_PROFILE,x.responses.TCPurpose.SELECT_PERSONALISED_CONTENT,x.responses.TCPurpose.MEASURE_AD_PERFORMANCE,x.responses.TCPurpose.MEASURE_CONTENT_PERFORMANCE,x.responses.TCPurpose.APPLY_MARKET_RESEARCH,x.responses.TCPurpose.DEVELOP_IMPROVE_PRODUCTS],sn=t=>!!t.gdprApplies&&on.some(e=>!t.purpose.consents[e]),Lt=(t,e,i,r)=>(r==="test"&&i.info("gdprApplies is set to false in test mode!"),r==="test"||t.enabled===!1?Promise.resolve({gdprApplies:!1,eventStatus:rn.TC_LOADED,cmpStatus:nn.LOADED,cmpId:0,cmpVersion:0,tcfPolicyVersion:void 0,listenerId:null}):new Promise((o,n)=>{if(e.__tcfapi){let s=a=>{a.cmpStatus==="error"?n(a):(a.eventStatus==="useractioncomplete"||a.eventStatus==="tcloaded")&&(i.debug("Consent","consent ready",a),t.disableLegitimateInterest&&sn(a)?n("user consent is missing for some purposes"):o(a),a.listenerId&&e.__tcfapi("removeEventListener",2,()=>{},a.listenerId))};e.__tcfapi("addEventListener",2,s)}else n("window.__tcfapi is not defined. Make sure that the stub code is inlined in the head tag")}));var he=t=>{if(t){let[e,i,r]=t.split(".").reverse();switch(`${i}.${e}`){case"co.uk":case"com.br":case"com.mx":case"com.au":return`${r}.${i}.${e}`;default:return i?`${i}.${e}`:e}}else return};var He=t=>{let[e,i,...r]=t.split("/"),[o,...n]=i.split(",");return n.length===0?t:["",o,...r].join("/")},K=(t,e)=>{let i=/[^{]+(?=})/g,r=/([A-Za-z0-9\_]+)/g,o=t.match(i);return!e||!o?t:(o.forEach(n=>{if(!n.match(r))throw new SyntaxError(`invalid variable "${n}" in path`);if(!e[n])throw new ReferenceError(`path variable "${n}" is not defined`)}),t.replace(new RegExp(Object.keys(e).map(n=>`{${n}}`).join("|"),"g"),n=>e[n.substr(1,n.length-2)]))},Ut=(t,e)=>t.split("/").slice(0,e+1).join("/"),_t=(t,e,i,r)=>v({device:e,domain:r||he(t)||"unknown"},i);var Nt=t=>{var e;return typeof((e=t.crypto)==null?void 0:e.randomUUID)=="function"?t.crypto.randomUUID():"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,i=>{let r=Math.random()*16|0;return(i==="x"?r:r&3|8).toString(16)})};var an=x.responses.TCPurpose,Ke=100,J=10,z=(t,e)=>(Object.defineProperty(e,"name",{value:t}),e),W=(t,e)=>(Object.defineProperty(e,"name",{value:t}),e),te=(t,e)=>{Object.defineProperty(e,"name",{value:t});let i=0;return W(t,(r,o)=>i!==r.f?(i=r.f,e(r,o)):Promise.resolve())},jt=(t,e)=>(Object.defineProperty(e,"name",{value:t}),W(t,(i,r)=>i.f===1&&i.g===1?e(i,r):Promise.resolve())),$=(t,e,i)=>{let r=Object.assign(i,{priority:e});return Object.defineProperty(i,"name",{value:t}),r},Ye=(t,e)=>(Object.defineProperty(e,"name",{value:t}),e),Ce=class{constructor(e,i,r,o){this.config=e;this.logger=i;this.window=r;this.auction=o;this.init=null;this.tcData=null;this.requestId=0;this.runPrepareRequestAds=(e,i)=>{let r=new Map;return this.config.prepareRequestAds.forEach(o=>{let n=r.get(o.priority);n?n.push(o):r.set(o.priority,[o])}),Array.from(r.entries()).sort(([o],[n])=>o>n?-1:1).reduce((o,[n,s])=>o.then(()=>(e.t.debug("AdPipeline",e.g,`run prepareRequestAds with priority ${n}`),Promise.all(s.map(a=>a(e,i))))),Promise.resolve(void 0))}}run(e,i,r,o,n){this.requestId=this.requestId+1;let s=this.requestId,a=Nt(this.window);this.logger.debug("AdPipeline",`starting run with requestId ${s} on ${o}. call. AuctionId ${a}`,e);let d=i.consent||{};return this.tcData=this.tcData?this.tcData:Lt(d,this.window,this.logger,r.environment),this.tcData.then(u=>{var C,R,O;let l=[...((C=i.targeting)==null?void 0:C.labels)||[],...r.labels];u.gdprApplies&&u.purpose.consents[an.STORE_INFORMATION_ON_DEVICE]?l.push("purpose-1"):u.gdprApplies||l.push("purpose-1");let c=xe(i.labelSizeConfig||[],l,this.window),p=n==null?void 0:n.bucketName,g=p&&((R=i.buckets)!=null&&R.bucket)&&i.buckets.bucket[p]?i.buckets.bucket[p]:null,m=_t(this.window.location.hostname,c.getDeviceLabel(),(O=i.targeting)==null?void 0:O.adUnitPathVariables,i.domain),h=v(v({},m),r.adUnitPathVariables),f={v:a,g:s,f:o,t:this.logger,r:r.environment||"production",i,l:r,u:c,e:this.window,n:u,b:g,m:h,p:this.auction,c:ze(this.window),S:n};this.init=this.init?this.init:this.logStage("init",s).then(()=>Promise.all(this.config.init.map(S=>S(f))));let I="rejected-no-slots-after-filtering";return this.init.then(()=>this.logStage("configure",s).then(()=>Promise.all(this.config.configure.map(S=>S(f,e))))).then(()=>this.logStage("defineSlots",s).then(()=>this.config.defineSlots(f,e))).then(S=>S.length?this.logStage("prepareRequestAds",s).then(()=>this.runPrepareRequestAds(f,S)).then(()=>this.logStage("requestBids",s)).then(()=>Promise.all(this.config.requestBids.map(k=>k(f,S)))).then(()=>this.logStage("requestAds",s)).then(()=>this.config.requestAds(f,S)):Promise.reject(I)).catch(S=>{switch(S){case I:return Promise.resolve();default:return this.logger.error("AdPipeline","running ad pipeline failed with error",S),Promise.reject(S)}})})}getAuction(){return this.auction}logStage(e,i){return new Promise(r=>{this.logger.debug("AdPipeline",i,`stage: ${e}`),r()})}};var Je=(t,e)=>t[0]===e[0]&&t[1]===e[1];var oe=class{constructor(e,i,r){this.sizeConfig=e;this.supportedLabels=i;this.window=r;this.filterSupportedSizes=e=>this.isValid?this.supportedSizes.length===0?e:e.filter(i=>this.supportedSizes.some(r=>r==="fluid"?i==="fluid":i==="fluid"?!1:Je(i,r))):[];this.areLabelsMatching=(e,i)=>(!e.labelAll||e.labelAll.every(r=>i.some(o=>o===r)))&&(!e.labelNone||!e.labelNone.some(r=>i.some(o=>o===r)));let o=e.length!==0?e.filter(n=>r.matchMedia(n.mediaQuery).matches&&this.areLabelsMatching(n,i)):[];this.isValid=e.length===0||!(e.length>0&&o.length===0),this.supportedSizes=Ie(o.map(n=>n.sizesSupported)).map(n=>JSON.stringify(n)).filter(Z).map(n=>JSON.parse(n))}static isFixedSize(e){return e!=="fluid"}filterSlot(e){return!e.sizes||e.sizes.length===0||this.filterSupportedSizes(e.sizes).length>0}};var se={moliEnv:"moli-env",moliPubCode:"moli-pub-code",moliVersion:"moli-version",testSlotSize:t=>`moli-test-slot-size-${t}`,debugDelay:"moli-debug-delay",abTest:"moli-ab-test"};var de=(t,e=localStorage)=>{try{return e.getItem(t)}catch(i){return ce().debug(`Could not read value with key ${t} from browser storage`,e),null}},ke=(t,e,i=localStorage)=>{try{i.setItem(t,e)}catch(r){ce().debug(`Could not set key ${t} with value ${e} to browser storage`,i)}};var dn=t=>t==="hidden"||Array.isArray(t)&&t.length===2&&typeof t[0]=="number"&&typeof t[1]=="number",Ft=t=>`${t}__container`,Xe=(t,e)=>{let i=un(t,e);return i.forEach(({slot:r,container:o})=>{o.innerHTML="",o.appendChild(cn(r))}),i};var ln=(t,e)=>{let i=document.getElementById(t);i&&(i.innerHTML=e)},un=(t,e)=>(e.forEach(i=>{let{moliSlot:r}=i,o=Ft(r.domId),n=document.createElement("div");n.id=o;let s=document.getElementById(r.domId);s&&s.setAttribute("data-google-query-id","test"),ln(r.domId,n.outerHTML),t.t.debug("GAM",`Set content for slot: [DomID] ${r.domId} [AdUnitPath] ${r.adUnitPath}`)}),pn(e)),pn=t=>t.map(e=>{let i=document.getElementById(Ft(e.moliSlot.domId));return i?{slot:e,container:i}:void 0}).filter(G),cn=t=>{let e=mn(t),i=gn(t.moliSlot,e);if(i==="hidden")return document.createElement("div");{let r=document.createElement("div"),[o,n]=i;r.style.cssText=`
      position: relative; display: inline-flex; flex-direction: column; align-items: center; justify-content: center;
      width: ${o}px; height: ${n}px; padding: 6px; border: 2px dotted gray; background-color: #fff;
      background-image: linear-gradient(90deg, transparent 79px, #abced4 79px, #abced4 81px, transparent 81px), linear-gradient(#eee .1em, transparent .1em);
      background-size: 100% 1.2em; box-sizing: border-box;
    `;let s=document.createElement("h4");s.innerHTML=`<strong>${t.moliSlot.domId}</strong>`,r.appendChild(s);let a=document.createElement("span");a.style.color="#656565";let d=([f,I])=>a.innerText=`(${f}x${I})`;d([o,n]),s.appendChild(a);let u=document.createElement("div");u.style.cssText="position: absolute; top: 5px; left: 5px",r.appendChild(u);let l=(f,I)=>{if(f==="hidden")r.style.display="none";else{let[C,R]=f;r.style.width=`${C}px`,r.style.height=`${R}px`,d(f),h(I)}fn(t.moliSlot,f)},c="1px dotted white",p="1px solid black",g=document.createElement("button");g.innerText="hide",g.title="Once hidden, it can only be restored using the moli console (or by clearing local storage manually)",g.style.cssText=`font-size: 10px; background: #656565; color: white; width: auto important!; border: ${c};`,g.addEventListener("click",()=>l("hidden",g));let m=[...e.map(f=>{let[I,C]=f,R=Gt(i,f),O=document.createElement("button");return O.innerText=`${I}x${C}`,O.style.cssText=`font-size: 10px; background: #00a4a6; color: white; width: auto important!; border: ${R?p:c};`,O.addEventListener("click",()=>l(f,O)),O}),g];m.forEach(f=>u.appendChild(f));let h=f=>{m.forEach(I=>I.style.border=c),f.style.border=p};return r}},mn=t=>t.filterSupportedSizes(t.moliSlot.sizes).filter(oe.isFixedSize).filter(([e,i])=>e>1&&i>1),gn=(t,e)=>{let i=yn(t);if(i&&(i==="hidden"||bn(e,i)))return i;{let r=Math.floor(Math.random()*e.length);return e.length===0?[300,250]:e[r]}},fn=(t,e)=>ke(se.testSlotSize(t.domId),JSON.stringify(e)),yn=t=>{let e=de(se.testSlotSize(t.domId));if(e)try{let i=JSON.parse(e);return dn(i)?i:void 0}catch(i){return}},Gt=(t,e)=>{let[i,r]=t,[o,n]=e;return i===o&&r===n},bn=(t,e)=>t.some(i=>Gt(i,e));var me="f",Wt="100";var In=(t,e)=>({setCollapseEmptyDiv(){},addService(i){},getSlotElementId(){return t},getAdUnitPath(){return e},setTargeting(i,r){return this},getTargeting(i){return[]},getTargetingKeys(){return[]},clearTargeting(i){},getResponseInformation(){return null},setConfig(i){},getConfig(i){}}),$t=(t,e,i)=>{var n;let r=i?i.keyValues:{},o=(n=i==null?void 0:i.adManagerExcludes)!=null?n:[];[r,e].forEach(s=>{Object.keys(s).filter(a=>!o.includes(a)).forEach(a=>{let d=s[a];d&&t.googletag.pubads().setTargeting(a,d)})})},Ht=(t,e)=>(e==null?void 0:e.useLimitedAds)===!1?!0:!t.gdprApplies||t.vendor.consents[755]&&t.purpose.consents[x.responses.TCPurpose.STORE_INFORMATION_ON_DEVICE]&&[x.responses.TCPurpose.SELECT_BASIC_ADS,x.responses.TCPurpose.MEASURE_AD_PERFORMANCE,x.responses.TCPurpose.APPLY_MARKET_RESEARCH,x.responses.TCPurpose.DEVELOP_IMPROVE_PRODUCTS].every(i=>t.purpose.consents[i]||t.purpose.legitimateInterests[i]),Kt=()=>{let t;return z("gpt-init",e=>e.r==="test"?Promise.resolve():(t||(t=new Promise(i=>{e.t.debug("GAM","init googletag stub"),e.e.googletag=e.e.googletag||{},e.e.googletag.cmd=e.e.googletag.cmd||[],e.e.googletag.cmd.push(i),e.c.loadScript({name:"gpt",loadMethod:1,assetUrl:Ht(e.n,e.i.consent)?"https://securepubads.g.doubleclick.net/tag/js/gpt.js":"https://pagead2.googlesyndication.com/tag/js/gpt.js"}).catch(r=>e.t.error("failed to load gpt.js",r))})),t))},Yt=()=>{let t=0;return W("gpt-destroy-ad-slots",(e,i)=>{var s,a;if(e.r==="test")return Promise.resolve();let r=(a=(s=e.i.spa)==null?void 0:s.cleanup)!=null?a:{slots:"all"},o=d=>d.length===0?(e.t.debug("GAM","no ad slots to destroy"),Promise.resolve()):(e.t.debug("GAM",`destroy ${d.length} ad slots`,d),e.e.googletag.destroySlots(d),Promise.resolve()),n=t!==e.f;switch(t=e.f,e.t.debug("GAM",`destroy ${r.slots} ad slots`),r.slots){case"all":return n&&e.e.googletag.destroySlots(),Promise.resolve();case"requested":let d=e.e.googletag.pubads().getSlots(),u=i.map(l=>d.find(c=>c.getSlotElementId()===l.domId)).filter(G);return o(u);case"excluded":if(n){let l=e.e.googletag.pubads().getSlots().filter(c=>!r.slotIds.includes(c.getSlotElementId()));return o(l)}return Promise.resolve();default:return Promise.resolve()}})},Jt=()=>te("gpt-reset-targeting",t=>new Promise(e=>{t.r==="production"&&(t.t.debug("GAM","reset top level targeting"),t.e.googletag.setConfig({targeting:null}),$t(t.e,t.l.keyValues,t.i.targeting)),e()})),Xt=()=>{let t;return W("gpt-configure",(e,i)=>(t||(t=new Promise(r=>{var n;let o=e.l.environment||"production";switch(e.t.debug("GAM","configure googletag"),o){case"production":$t(e.e,e.l.keyValues,e.i.targeting),e.e.googletag.pubads().enableAsyncRendering(),e.e.googletag.pubads().disableInitialLoad(),e.e.googletag.pubads().enableSingleRequest(),(n=e.i.gpt)!=null&&n.pageSettingsConfig&&e.e.googletag.setConfig(e.i.gpt.pageSettingsConfig);let s=!Ht(e.n,e.i.consent);e.t.debug("GAM","use limited ads",s),e.e.googletag.pubads().setPrivacySettings({limitedAds:s}),e.e.googletag.enableServices(),r();return;case"test":r();return}})),t))},Qt=()=>$("gpt-device-label-keyValue",J,t=>t.r==="test"?Promise.resolve():new Promise(e=>{let i=t.u.getDeviceLabel();t.t.debug("GAM",'adding "device_label" key-value with values',i),t.e.googletag.pubads().setTargeting("device_label",i),e()})),Zt=()=>$("gpt-consent-keyValue",J,t=>t.r==="test"?Promise.resolve():new Promise(e=>{let i=t.n,r=!i.gdprApplies||[x.responses.TCPurpose.STORE_INFORMATION_ON_DEVICE,x.responses.TCPurpose.SELECT_BASIC_ADS,x.responses.TCPurpose.CREATE_PERSONALISED_ADS_PROFILE,x.responses.TCPurpose.SELECT_PERSONALISED_ADS,x.responses.TCPurpose.CREATE_PERSONALISED_CONTENT_PROFILE,x.responses.TCPurpose.SELECT_PERSONALISED_CONTENT,x.responses.TCPurpose.MEASURE_AD_PERFORMANCE,x.responses.TCPurpose.MEASURE_CONTENT_PERFORMANCE,x.responses.TCPurpose.APPLY_MARKET_RESEARCH,x.responses.TCPurpose.DEVELOP_IMPROVE_PRODUCTS].every(o=>i.purpose.consents[o]);t.e.googletag.pubads().setTargeting("consent",r?"full":"none"),e()})),ei=()=>(t,e)=>{let i=e.map(r=>{let o=new oe(r.sizeConfig,t.u.getSupportedLabels(),t.e),n=o.filterSupportedSizes;if(!(o.filterSlot(r)&&t.u.filterSlot(r)))return Promise.resolve(null);let s=n(r.sizes),a=K(r.adUnitPath,t.m),d=m=>{if(!t.e.document.getElementById(m)){let h=t.e.document.createElement("div");h.id=m,h.setAttribute("data-h5v-position",r.position),h.style.setProperty("display","none"),t.e.document.body.appendChild(h)}},u=()=>{switch(r.position){case"in-page":return[t.e.googletag.defineSlot(a,s,r.domId),null];case"interstitial":switch(d(r.domId),t.p.interstitialChannel()){case"gam":return[t.e.googletag.defineOutOfPageSlot(a,t.e.googletag.enums.OutOfPageFormat.INTERSTITIAL),t.e.googletag.enums.OutOfPageFormat.INTERSTITIAL];case"c":default:return[t.e.googletag.defineSlot(a,s,r.domId),null]}case"out-of-page":return d(r.domId),[t.e.googletag.defineOutOfPageSlot(a,r.domId),null];case"out-of-page-interstitial":return[t.e.googletag.defineOutOfPageSlot(a,t.e.googletag.enums.OutOfPageFormat.INTERSTITIAL),t.e.googletag.enums.OutOfPageFormat.INTERSTITIAL];case"out-of-page-bottom-anchor":return[t.e.googletag.defineOutOfPageSlot(a,t.e.googletag.enums.OutOfPageFormat.BOTTOM_ANCHOR),t.e.googletag.enums.OutOfPageFormat.BOTTOM_ANCHOR];case"out-of-page-top-anchor":return[t.e.googletag.defineOutOfPageSlot(a,t.e.googletag.enums.OutOfPageFormat.TOP_ANCHOR),t.e.googletag.enums.OutOfPageFormat.TOP_ANCHOR]}},l=()=>{if(t.r==="test")return null;let[m,h]=u();return m&&(h?m.setTargeting(me,h.toString()):r.position==="interstitial"?t.p.interstitialChannel()==="c"&&m.setTargeting(me,Wt):m.clearTargeting(me),t.e.googletag.display(m)),m},p=(t.r==="test"?[]:t.e.googletag.pubads().getSlots()).find(m=>m.getSlotElementId()===r.domId),g=p||l();switch(t.r){case"production":if(g)return r.gpt&&(g.setConfig(r.gpt),t.t.debug("GAM",`Add slot settings: [AdSlot] ${g.getSlotElementId()}`,r.gpt)),g.addService(t.e.googletag.pubads()),t.t.debug("GAM",`Register slot: [DomID] ${r.domId} [AdUnitPath] ${r.adUnitPath}`),Promise.resolve({moliSlot:r,adSlot:g,filterSupportedSizes:n});if(r.position==="out-of-page-interstitial"||r.position==="out-of-page-top-anchor"||r.position==="out-of-page-bottom-anchor")return t.t.warn("GAM",`${r.position} is not supported`),Promise.resolve(null);{let m=`Slot: [DomID] ${r.domId} [AdUnitPath] ${r.adUnitPath} is already defined. You may have called requestAds() multiple times`;return t.t.error("GAM",m),Promise.reject(new Error(m))}case"test":return Promise.resolve({moliSlot:r,adSlot:In(r.domId,r.adUnitPath),filterSupportedSizes:n});default:return Promise.reject(`invalid environment: ${t.l.environment}`)}});return Promise.all(i).then(r=>r.filter(G))},vn=(t,e)=>{let i=t.find(({moliSlot:r})=>r.position==="interstitial");if(i&&e.p.interstitialChannel()==="gam"){let r=v({},i.adSlot.getConfig("targeting").targeting);e.e.googletag.destroySlots([i.adSlot]);let o=e.e.googletag.defineOutOfPageSlot(K(i.moliSlot.adUnitPath,e.m),e.e.googletag.enums.OutOfPageFormat.INTERSTITIAL);if(o)return e.t.debug("GAM","Display out-of-page-interstitial slot"),o.addService(e.e.googletag.pubads()),o.setConfig({targeting:w(v({},r),{[me]:e.e.googletag.enums.OutOfPageFormat.INTERSTITIAL.toString()})}),e.e.googletag.display(o),[...t.filter(({moliSlot:n})=>n.position!=="interstitial"),w(v({},i),{adSlot:o})];e.t.error("GAM","Failed to define out-of-page-interstitial slot")}return t},ti=()=>(t,e)=>new Promise(i=>{switch(t.t.debug("GAM","requestAds"),t.r){case"test":Xe(t,e);break;case"production":let r=e.filter(({adSlot:s})=>!t.p.isSlotThrottled(s));if(r.length===0)break;let o=vn(r,t);t.e.googletag.pubads().refresh(o.map(({adSlot:s})=>s));let n=o.map(({moliSlot:s})=>`[DomID] ${s.domId} [AdUnitPath] ${s.adUnitPath}`).join(`
`);t.t.debug("GAM",`Refresh ${e.length} slot(s):
${n}`);break}i()});var ii=(t,e)=>{var i;return w(v({},t),{ext:w(v({},t.ext),{prebid:w(v({},(i=t.ext)==null?void 0:i.prebid),{storedrequest:e})})})};var Oe={version:"5.8.12"};var ri=(t,e,i={})=>({url:e,render:r=>hn(r,t,i),backupOnly:!0}),hn=(t,e,i={})=>{if(!t.renderer){ce().error("Can not initialize prebid outstream player, because bid.renderer is not defined");return}t.renderer.push(()=>{var r;return(r=window.outstreamPlayer)==null?void 0:r.call(window,t,e,i)})};var Se=(t,e)=>{let[i]=t.getTargeting(me);return!!i&&i===e.googletag.enums.OutOfPageFormat.INTERSTITIAL.toString()},ni=(t,e,i,r)=>{var h;let o="h5v_intstl",n=(h=t.ttlStorage)!=null?h:18e5,s=i(),a=t.adUnitPath,d={priority:t.priority,updatedAt:s};try{let f=e.sessionStorage.getItem(o);if(f){let I=JSON.parse(f);s-I.updatedAt<n?d=I:d.updatedAt=s}}catch(f){r.error("interstitial","failed to load interstitial state from session storage",f)}t.priority.length===0&&r.error("interstitial","no interstitial priority configured");let u=()=>{d.updatedAt=i();try{window.sessionStorage.setItem(o,JSON.stringify(d))}catch(f){r.error("interstitial","failed to persist interstitial state to session storage",f)}},l=f=>f.length===0?[]:[...f.slice(1),f[0]];return{interstitialChannel:()=>d.priority[0],onSlotRenderEnded:f=>{f.slot.getAdUnitPath()===a&&f.isEmpty&&(d.priority=l(d.priority),u())},onImpressionViewable:f=>{f.slot.getAdUnitPath()===a&&Se(f.slot,e)&&(d.priority=l(d.priority),u())},onAuctionEnd:f=>{var C,R;if(!f.adUnitCodes.includes(t.domId))return;let I=(C=f.bidsReceived)==null?void 0:C.filter(O=>O.adUnitCode===t.domId);((R=I==null?void 0:I.length)!=null?R:0)===0&&(d.priority=l(d.priority),u())},interstitialState:()=>d,updateAdUnitPaths:f=>{a=K(t.adUnitPath,f)}}};var oi=(t,e,i)=>r=>{var s,a,d,u,l;if(!(((s=e==null?void 0:e.userIds)==null?void 0:s.find(c=>c.name==="criteo"))!==void 0))return r;let n=[];return((d=(a=t.audience)==null?void 0:a.hem)==null?void 0:d.sha256)!==void 0&&n.push({id:t.audience.hem.sha256,atype:3,ext:{stype:"hemsha256"}}),((l=(u=t.audience)==null?void 0:u.hem)==null?void 0:l.sha256ofMD5)!==void 0&&n.push({id:t.audience.hem.sha256ofMD5,atype:3,ext:{stype:"hemsha256md5"}}),n.length===0?r:[...r.filter(c=>!c.options.bidders.every(p=>p==="criteo")),{options:{bidders:["criteo"],config:{ortb2:{user:{ext:{data:{eids:[{source:i,uids:n}]}}}}}},merge:!0}]};var Sn=t=>{var o,n;let e=(n=(o=t.audience)==null?void 0:o.hem)==null?void 0:n.sha256;if(!e)return null;let r=Object.entries({1:e}).map(([s,a])=>`${s}=${encodeURIComponent(a)}`).join("&");return btoa(r)},si=(t,e)=>e==null?void 0:e.map(i=>{if(i.name==="id5Id"){let r=Sn(t);return w(v({},i),{params:v(v({},i.params),r&&{pd:r})})}return i});var An=t=>new Promise((e,i)=>{t.e.setTimeout(()=>i("Prebid did not resolve in time. Maybe you forgot to import the prebid distribution in the ad tag"),5e3)}),Pn=t=>new Promise(e=>t.pbjs.que.push(e)),ai=t=>!!t.moliSlot.prebid,Cn=(t,e)=>e.pbjs.adUnits?e.pbjs.adUnits.some(i=>t.code===i.code):!1,di=(t,e,i)=>i.filter(ai).map(({moliSlot:o,priceRule:n,filterSupportedSizes:s})=>{var d,u;let a=n?{floors:{currency:(u=(d=e.config.currency)==null?void 0:d.adServerCurrency)!=null?u:"EUR",schema:{delimiter:"|",fields:["mediaType"]},values:{"*":n.floorprice}}}:null;return t.t.debug("Prebid",t.g,"Price Rule",n,o.domId,a),Rn(o.prebid).map(l=>{var E,P,T,U;let c=l.adUnit.mediaTypes.banner,p=l.adUnit.mediaTypes.video,g=l.adUnit.mediaTypes.native,m=c?s(c.sizes).filter(oe.isFixedSize):[],h=p?En(p.playerSize,s):[],f=l.adUnit.bids.filter(D=>t.u.filterSlot(D)).filter(D=>!D.bidder||D.bidder&&!t.p.isBidderDisabled(o.domId,D.bidder)&&!t.p.isBidderFrequencyCappedOnSlot(o.domId,D.bidder)).map(D=>{let q=D,{labelAny:re,labelAll:b}=q;return Dt(q,["labelAny","labelAll"])}),I=h.length>0&&!(p!=null&&p.w)&&!(p!=null&&p.h)?{w:h[0][0],h:h[0][1]}:{},C=e.backupVideoRenderer,R=p?{video:v(v(w(v({},p),{playerSize:h.length===0?void 0:h}),I),C?{renderer:ri(o.domId,C.url)}:{})}:void 0,O=c&&m.length>0?{banner:w(v({},c),{sizes:m})}:void 0,S=g?{native:v({},g)}:void 0,k=w(v({},l.adUnit.pubstack),{adUnitPath:K(((E=l.adUnit.pubstack)==null?void 0:E.adUnitPath)||o.adUnitPath,t.m)}),A=(U=(T=(P=l.adUnit.ortb2Imp)==null?void 0:P.ext)==null?void 0:T.prebid)==null?void 0:U.storedrequest,y=A&&A.id?w(v({},A),{id:K(A.id,t.m)}):null;return v(w(v(w(v(v({},l.adUnit),A&&y&&{ortb2Imp:ii(l.adUnit.ortb2Imp,y)}),{code:l.adUnit.code||o.domId}),l.adUnit.pubstack?{pubstack:k}:{}),{mediaTypes:v(v(v({},R),O),S),bids:f}),a)}).filter(l=>l.bids.length>0&&l.mediaTypes&&(l.mediaTypes.banner||l.mediaTypes.video||l.mediaTypes.native)&&!Cn(l,t.e))}).reduce((o,n)=>[...o,...n],[]),li=t=>z("prebid-init",e=>{var r,o;e.e.pbjs=e.e.pbjs||{que:[]};let i=(r=e.i.prebid)==null?void 0:r.analyticAdapters;return i&&i.length>0&&e.e.pbjs.que.push(()=>{e.e.pbjs.enableAnalytics(i)}),e.e.pbjs.libLoaded?Promise.resolve():(o=e.i.prebid)!=null&&o.distributionUrl?(t.loadScript({name:"prebid",assetUrl:e.i.prebid.distributionUrl,loadMethod:1}),Promise.resolve()):Promise.race([Pn(e.e),An(e)])}),ui=t=>W("prebid-remove-adunits",e=>new Promise(i=>{if(t.ephemeralAdUnits!==!0){e.e.pbjs=e.e.pbjs||{que:[]};let r=e.e.pbjs.adUnits;r&&e.e.pbjs.que.push(()=>{e.t.debug("Prebid","Destroying prebid adUnits",r),r.forEach(o=>e.e.pbjs.removeAdUnit(o.code))})}i()})),pi=()=>te("prebid-clear-auction",t=>new Promise(e=>{t.e.pbjs=t.e.pbjs||{que:[]},t.e.pbjs.que.push(()=>{t.t.debug("Prebid","Clearing prebid auctions"),t.e.pbjs.clearAllAuctions()}),e()})),ci=(t,e)=>{let i,r=o=>({validation:"relaxed",config:{ver:"1.0",complete:1,nodes:o}});return W("prebid-configure",(o,n)=>(i||(i=new Promise(s=>{t.bidderSettings&&(o.e.pbjs.bidderSettings=t.bidderSettings),o.e.pbjs.que.push(()=>{var l;t.config.s2sConfig&&(Array.isArray(t.config.s2sConfig)?t.config.s2sConfig:[t.config.s2sConfig]).forEach(p=>{var m,h;let g=(h=(m=p.extPrebid)==null?void 0:m.analytics)==null?void 0:h.h5v;g&&(g.configLabel=o.e.moli.configLabel,g.moliVersion=Oe.version)});let d=si(o.l,(l=t.config.userSync)==null?void 0:l.userIds);o.e.pbjs.setConfig(w(v({},t.config),{schain:r([e.supplyChainStartNode]),floors:t.config.floors||{},userSync:t.config.userSync?w(v({},t.config.userSync),{userIds:d}):t.config.userSync})),oi(o.l,t.config.userSync,o.e.location.host)(t.bidderConfigs||[]).forEach(({options:c,merge:p})=>{o.e.pbjs.setBidderConfig(c,p)}),t.schain.nodes.forEach(({bidder:c,node:p,appendNode:g})=>{let m=[e.supplyChainStartNode];g&&m.push(p),o.e.pbjs.setBidderConfig({bidders:[c],config:{schain:r(m)}},!0)}),o.e.pbjs.registerSignalSources&&o.e.pbjs.registerSignalSources()}),s()})),i))},Rn=t=>Array.isArray(t)?t:[t],mi=t=>$("prebid-prepare-adunits",J,(e,i)=>new Promise(r=>{t.ephemeralAdUnits||e.e.pbjs.que.push(()=>{let o=di(e,t,i);o.forEach(n=>{e.t.debug("Prebid",e.g,`Prebid add ad unit: [Code] ${n.code}`,n)}),e.e.pbjs.addAdUnits(o)}),r()})),gi=(t,e)=>Ye("prebid-request-bids",(i,r)=>{var a,d;let o=Math.max(((a=t.config.bidderTimeout)!=null?a:2e3)+3e3,(d=t.failsafeTimeout)!=null?d:0),n=new Promise(u=>i.e.setTimeout(u,o)),s=new Promise(u=>{var h;let l=r.filter(f=>!i.p.isSlotThrottled(f.adSlot)&&(!Se(f.adSlot,i.e)||i.p.interstitialChannel()!=="gam")),c=t.ephemeralAdUnits?{adUnits:di(i,t,l)}:{adUnitCodes:l.filter(ai).map(f=>f.moliSlot.domId)},p=c.adUnitCodes||((h=c.adUnits)==null?void 0:h.map(f=>f.code).filter(G).filter(Z))||[];if(p.length===0)return i.t.debug("Prebid","skip request bids. All slots were filtered.",l.map(f=>f.moliSlot)),u();let g=!1;i.t.debug("Prebid",`Prebid request bids: 
			${p.join(`
			`)}`);let m=(f,I,C)=>{i.t.info("Prebid",C,f,r.map(R=>R.moliSlot.domId));try{if(g){i.t.warn("Prebid",`ad server request already sent [${i.g}]. AuctionId ${C}`);return}if(!f)return i.t.warn("Prebid",`Undefined bid response map for ad unit codes: ${p.join(", ")}`),u();g=!0,e==="gam"&&(i.l.adPipelineConfig.prebidBidsBackHandler.forEach(R=>R(i,f,r)),i.e.pbjs.setTargetingForGPTAsync(p)),u()}catch(R){i.t.error("Prebid","DfpService:: could not resolve bidsBackHandler"+JSON.stringify(R)),u()}};i.e.pbjs.que.push(()=>{var f;i.e.pbjs.requestBids(w(v({},c),{auctionId:i.v,timeout:(f=i.b)==null?void 0:f.timeout,bidsBackHandler:m}))})});return Promise.race([n,s])}),fi=()=>(t,e)=>{let i=e.map(r=>{let o=new oe(r.sizeConfig,t.u.getSupportedLabels(),t.e),n=o.filterSupportedSizes;if(!(o.filterSlot(r)&&t.u.filterSlot(r)))return Promise.resolve(null);let s={getAdUnitPath:()=>r.adUnitPath};switch(t.r){case"production":return Promise.resolve({moliSlot:r,adSlot:s,filterSupportedSizes:n});case"test":return Promise.resolve({moliSlot:r,adSlot:s,filterSupportedSizes:n});default:return Promise.reject(`invalid environment: ${t.l.environment}`)}});return Promise.all(i).then(r=>r.filter(G))},yi=()=>(t,e)=>new Promise((i,r)=>{t.t.debug("Prebid","start rendering");try{switch(t.r){case"test":t.t.debug("Prebid","Rendering test slots"),Xe(t,e);break;case"production":t.e.pbjs.getHighestCpmBids().filter(o=>o&&o.adId).forEach(o=>{var s;let n=t.e.document.getElementById(o.adUnitCode);if(n){let a=document.createElement("div");a.style.setProperty("border","0pt none");let d=document.createElement("iframe");d.scrolling="no",d.frameBorder="0",d.marginHeight="0",d.marginHeight="0",d.name=`prebid_ads_iframe_${o.adUnitCode}`,d.title="3rd party ad content",d.sandbox.add("allow-forms","allow-popups","allow-popups-to-escape-sandbox","allow-same-origin","allow-scripts","allow-top-navigation-by-user-activation"),d.setAttribute("aria-label","Advertisment"),d.style.setProperty("border","0"),d.style.setProperty("margin","0"),d.style.setProperty("overflow","hidden"),a.appendChild(d),n.appendChild(a);let u=(s=d.contentWindow)==null?void 0:s.document;if(u){t.e.pbjs.renderAd(u,o.adId);let l="/*! normalize.css v8.0.1 | MIT License | github.com/necolas/normalize.css */button,hr,input{overflow:visible}progress,sub,sup{vertical-align:baseline}[type=checkbox],[type=radio],legend{box-sizing:border-box;padding:0}html{line-height:1.15;-webkit-text-size-adjust:100%}body{margin:0}details,main{display:block}h1{font-size:2em;margin:.67em 0}hr{box-sizing:content-box;height:0}code,kbd,pre,samp{font-family:monospace,monospace;font-size:1em}a{background-color:transparent}abbr[title]{border-bottom:none;text-decoration:underline;text-decoration:underline dotted}b,strong{font-weight:bolder}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative}sub{bottom:-.25em}sup{top:-.5em}img{border-style:none}button,input,optgroup,select,textarea{font-family:inherit;font-size:100%;line-height:1.15;margin:0}button,select{text-transform:none}[type=button],[type=reset],[type=submit],button{-webkit-appearance:button}[type=button]::-moz-focus-inner,[type=reset]::-moz-focus-inner,[type=submit]::-moz-focus-inner,button::-moz-focus-inner{border-style:none;padding:0}[type=button]:-moz-focusring,[type=reset]:-moz-focusring,[type=submit]:-moz-focusring,button:-moz-focusring{outline:ButtonText dotted 1px}fieldset{padding:.35em .75em .625em}legend{color:inherit;display:table;max-width:100%;white-space:normal}textarea{overflow:auto}[type=number]::-webkit-inner-spin-button,[type=number]::-webkit-outer-spin-button{height:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}[type=search]::-webkit-search-decoration{-webkit-appearance:none}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}summary{display:list-item}[hidden],template{display:none}",c=u.createElement("style");c.appendChild(u.createTextNode(l)),u.head.appendChild(c)}else t.t.error("Prebid",`No access to iframe contentWindow for ad unit${o.adUnitCode}`)}else t.t.error("Prebid",`Could not locate ad slot with id ${o.adUnitCode}`)});break}i()}catch(o){r(o)}}),En=(t,e)=>{let i=r=>!!r&&r.length===2&&typeof r[0]=="number"&&typeof r[1]=="number";return t?e(i(t)?[t]:t).filter(oe.isFixedSize):[]};var Mn=t=>!!t.moliSlot.a9,bi=t=>!t.gdprApplies||t.vendor.consents[793]&&[x.responses.TCPurpose.STORE_INFORMATION_ON_DEVICE,x.responses.TCPurpose.SELECT_BASIC_ADS,x.responses.TCPurpose.CREATE_PERSONALISED_ADS_PROFILE,x.responses.TCPurpose.SELECT_PERSONALISED_ADS,x.responses.TCPurpose.MEASURE_AD_PERFORMANCE,x.responses.TCPurpose.APPLY_MARKET_RESEARCH,x.responses.TCPurpose.DEVELOP_IMPROVE_PRODUCTS].every(e=>t.purpose.consents[e]),Ii=(t,e)=>z("a9-init",i=>new Promise(r=>{i.e.apstag=i.e.apstag||{_Q:[],init:function(){i.e.apstag._Q.push(["i",arguments])},fetchBids:function(){i.e.apstag._Q.push(["f",arguments])},setDisplayBids:function(){},targetingKeys:function(){},dpa:function(){i.e.apstag._Q.push(["di",arguments])},rpa:function(){i.e.apstag._Q.push(["ri",arguments])},upa:function(){i.e.apstag._Q.push(["ui",arguments])}};let o=!t.labelAll||t.labelAll.every(n=>i.u.getSupportedLabels().includes(n));i.r!=="test"&&bi(i.n)&&t.enabled!==!1&&o&&e.loadScript({name:"A9",loadMethod:1,assetUrl:t.scriptUrl?t.scriptUrl:"//c.amazon-adsystem.com/aax2/apstag.js"}).catch(n=>i.t.error("failed to load apstag.js",n)),r()})),vi=(t,e)=>W("a9-configure",(i,r)=>new Promise(o=>{let n=[e.supplyChainStartNode];t.schainNode&&n.push(t.schainNode),i.e.apstag.init({pubID:t.pubID,adServer:"googletag",bidTimeout:t.timeout,gdpr:{cmpTimeout:t.cmpTimeout},schain:{complete:1,ver:"1.0",nodes:n}}),o()})),hi=(t,e)=>jt("a9-publisher-audiences",(i,r)=>new Promise(o=>{var a,d;let n=(a=e==null?void 0:e.hem)==null?void 0:a.sha256,s=n!==void 0?{enabled:!!((d=t.publisherAudience)!=null&&d.enabled),sha256Email:n}:t.publisherAudience;if(s!==void 0&&s.enabled){let u={hashedRecords:[{type:"email",record:s.sha256Email}]};if(i.t.debug("A9","Enable publisher audiences"),i.e.apstag.rpa(u),i.e.__tcfapi){let l=!0;i.e.__tcfapi("addEventListener",2,c=>{if(l){l=!1;return}c.eventStatus===x.status.EventStatus.USER_ACTION_COMPLETE&&(i.t.debug("A9","Update publisher audience token"),i.e.apstag.upa(u))})}}o()})),Si=()=>$("a9-clear-targeting",J,(t,e)=>t.g===0?(t.t.debug("A9","skip ad slot clearing for first pipeline run"),Promise.resolve()):new Promise(i=>{t.t.debug("A9","clear a9 targetings"),e.forEach(({adSlot:r})=>{r.getTargetingKeys().filter(o=>o==="amznp"||o==="amznsz"||o==="amznbid").forEach(o=>r.clearTargeting(o))}),i()})),Tn=(t,e,i)=>{let r=He(t),o=e?Ut(r,e):r;return K(o,i)},Ai=t=>Ye("a9-fetch-bids",(e,i)=>new Promise(r=>{var n;if(!bi(e.n)||t.enabled===!1){e.t.debug("A9","Skip any due to missing consent"),r();return}let o=i.filter(Mn).filter(s=>!e.p.isSlotThrottled(s.adSlot)).filter(s=>{let a=s.moliSlot.a9.mediaType==="video",d=e.u.filterSlot(s.moliSlot.a9),u=s.filterSupportedSizes(s.moliSlot.sizes).filter(oe.isFixedSize).length>0;return d&&(a||u)}).map(({moliSlot:s,priceRule:a,filterSupportedSizes:d})=>{var u,l;if(s.a9.mediaType==="video")return{slotID:s.domId,mediaType:"video"};{let c=t.supportedSizes?s.sizes.filter(g=>{var m;return(m=t.supportedSizes)==null?void 0:m.some(h=>Je(h,g))}):s.sizes,p=Tn(s.adUnitPath,(u=s.a9.slotNamePathDepth)!=null?u:t.slotNamePathDepth,e.m);return v({slotID:s.domId,slotName:p,sizes:d(c).filter(oe.isFixedSize)},t.enableFloorPrices&&a?{floor:{value:Math.ceil((l=e.e.pbjs)!=null&&l.convertCurrency?e.e.pbjs.convertCurrency(a.floorprice,"EUR",t.floorPriceCurrency||"USD")*100:a.floorprice*100*1.19),currency:t.floorPriceCurrency||"USD"}}:{})}});e.t.debug("A9",`Fetch '${o.length}' A9 slots: ${o.map(s=>`[slotID] ${s.slotID}`)}`),o.length===0?r():e.e.apstag.fetchBids(v({slots:o},((n=e.b)==null?void 0:n.timeout)&&{bidTimeout:e.b.timeout}),s=>{e.e.apstag.setDisplayBids(),r()})}));var Pi=(t,e)=>e?new Promise(i=>t.setTimeout(i,e)):Promise.resolve(),Ci=t=>Number(de(se.debugDelay,t.localStorage))||void 0;var Ri=(t,e,i)=>{let r=new Map;i==null||i.info(`Bidders disabling feature is ${t.enabled?"enabled":"disabled"}`);let o=(l,c)=>{var p,g,m,h;return(p=t.excludedPositions)!=null&&p.includes(l)?!1:(h=(m=(g=r.get(l))==null?void 0:g.get(c))==null?void 0:m.disabled)!=null?h:!1},n=l=>{var c,p;(c=l.bidderRequests)==null||c.forEach(g=>{var m;(m=g==null?void 0:g.bids)==null||m.forEach(h=>{var R,O,S;let f=h.bidder,I=h.adUnitCode;r.get(I)||r.set(I,new Map);let C=(R=r.get(I))==null?void 0:R.get(f);if(C){let k=C.bidRequestCount+1;(O=r.get(I))==null||O.set(f,w(v({},C),{bidRequestCount:k}))}else(S=r.get(I))==null||S.set(f,{disabled:!1,bidRequestCount:1,bidReceivedCount:0})})}),(p=l.bidsReceived)==null||p.forEach(g=>{var I,C,R;let m=g.bidderCode,h=g.adUnitCode,f=(I=r.get(h))==null?void 0:I.get(m);f?(C=r.get(h))==null||C.set(m,w(v({},f),{bidReceivedCount:f.bidReceivedCount+1})):(R=r.get(h))==null||R.set(m,{disabled:!1,bidRequestCount:1,bidReceivedCount:1})}),s()},s=()=>{r.forEach((l,c)=>{l.forEach((p,g)=>{a(p)&&(d(c,g),e.setTimeout(()=>{u(c,g)},t.reactivationPeriod))})})},a=l=>l.bidRequestCount>t.minBidRequests&&l.bidReceivedCount/l.bidRequestCount<t.minRate&&!l.disabled,d=(l,c)=>{var g;let p=(g=r.get(l))==null?void 0:g.get(c);p&&(p.disabled=!0,i==null||i.info(`Bidder ${c} for position ${l} is now disabled.`))},u=(l,c)=>{var g;let p=(g=r.get(l))==null?void 0:g.get(c);p&&(p.disabled=!1,i==null||i.info(`Bidder ${c} for position ${l} is now enabled.`))};return{isBidderDisabled:o,onAuctionEnd:n}};var Ei=(t,e)=>{let i=new Set;function r(n){let s=n.slot.getSlotElementId();(!t.includedDomIds||t.includedDomIds.length===0||t.includedDomIds.includes(s))&&(i.add(s),e.setTimeout(()=>{i.delete(s)},t.throttle*1e3))}function o(n){return i.has(n)}return{onSlotRequested:r,isThrottled:o}};var At;(B=>{let t;(_e=>{let It;(ue=>(ue[ue.Unknown=0]="Unknown",ue[ue.ProfessionallyProduced=1]="ProfessionallyProduced",ue[ue.Prosumer=2]="Prosumer",ue[ue.UGC=3]="UGC"))(It=_e.ContentQuality||(_e.ContentQuality={}))})(t=B.firstpartydata||(B.firstpartydata={}));let e;(Q=>{let It;(ye=>(ye[ye.NO=0]="NO",ye[ye.YES=1]="YES"))(It=Q.Skip||(Q.Skip={}));let _e;(H=>(H[H.VAST_1=1]="VAST_1",H[H.VAST_2=2]="VAST_2",H[H.VAST_3=3]="VAST_3",H[H.VAST_1_WRAPPER=4]="VAST_1_WRAPPER",H[H.VAST_2_WRAPPER=5]="VAST_2_WRAPPER",H[H.VAST_3_WRAPPER=6]="VAST_3_WRAPPER",H[H.VAST_4=7]="VAST_4",H[H.VAST_4_WRAPPER=8]="VAST_4_WRAPPER",H[H.DAAST_1=9]="DAAST_1",H[H.DAAST_1_WRAPPER=10]="DAAST_1_WRAPPER"))(_e=Q.Protocol||(Q.Protocol={}));let Wr;(F=>(F[F.AutoPlaySoundOff=1]="AutoPlaySoundOff",F[F.AutoPlaySoundOn=2]="AutoPlaySoundOn",F[F.ClickToPlay=3]="ClickToPlay",F[F.MousOver=4]="MousOver",F[F.InViewportSoundsOn=5]="InViewportSoundsOn",F[F.InViewportSoundsOff=6]="InViewportSoundsOff"))(Wr=Q.PlaybackMethod||(Q.PlaybackMethod={}));let $r;(F=>(F[F.VPAID_1=1]="VPAID_1",F[F.VPAID_2=2]="VPAID_2",F[F.MRAID_1=3]="MRAID_1",F[F.ORMMA=4]="ORMMA",F[F.MRAID_2=5]="MRAID_2",F[F.MRAID_3=6]="MRAID_3"))($r=Q.Api||(Q.Api={}));let Hr;(pe=>(pe[pe.InStream=1]="InStream",pe[pe.InBanner=2]="InBanner",pe[pe.InArticle=3]="InArticle",pe[pe.InFeed=4]="InFeed",pe[pe.Interstitial=5]="Interstitial"))(Hr=Q.Placement||(Q.Placement={}));let Kr;(be=>(be[be.Instream=1]="Instream",be[be.AccompanyingContent=2]="AccompanyingContent",be[be.Interstitial=3]="Interstitial",be[be.NoContentStandalone=4]="NoContentStandalone"))(Kr=Q.Plcmt||(Q.Plcmt={}));let ue;(V=>(V[V.AudioAdAutoPlay=1]="AudioAdAutoPlay",V[V.AudioAdUserInitiated=2]="AudioAdUserInitiated",V[V.ExpandableAutomatic=3]="ExpandableAutomatic",V[V.ExpandableOnClick=4]="ExpandableOnClick",V[V.ExpandableOnRollover=5]="ExpandableOnRollover",V[V.InBannerVideoAdAutoPlay=6]="InBannerVideoAdAutoPlay",V[V.InBannerVideoAdClick=7]="InBannerVideoAdClick",V[V.Pop=8]="Pop",V[V.ProvocativeOrSuggestiveImagery=9]="ProvocativeOrSuggestiveImagery",V[V.ShakyFlashingFlickering=10]="ShakyFlashingFlickering",V[V.Surveys=11]="Surveys",V[V.TextOnly=12]="TextOnly",V[V.UserInteractive=13]="UserInteractive",V[V.WindowsDialogOrAlertStyle=14]="WindowsDialogOrAlertStyle",V[V.HasAudioOnOffButton=15]="HasAudioOnOffButton",V[V.HasSkipButton=16]="HasSkipButton",V[V.AdobeFlash=16]="AdobeFlash"))(ue=Q.CreativeAttributes||(Q.CreativeAttributes={}));let Yr;(ye=>(ye[ye.LinerInStream=1]="LinerInStream",ye[ye.NonLinearOverlay=2]="NonLinearOverlay"))(Yr=Q.Linearity||(Q.Linearity={}))})(e=B.video||(B.video={})),B.Adagio="adagio",B.AdaptMx="amx",B.Adform="adf",B.AdUp="aduptech",B.Criteo="criteo",B.CWire="cwire",B.ConnectAd="connectad",B.AppNexusAst="appnexusAst",B.AppNexus="appnexus",B.GumGum="gumgum",B.Equativ="equativ",B.ImproveDigital="improvedigital",B.IndexExchange="ix",B.InMobi="inmobi",B.Invibes="invibes",B.NanoInteractive="nanointeractive",B.NextMillennium="nextMillennium",B.PubMatic="pubmatic",B.Ogury="ogury",B.OneTag="onetag",B.OpenX="openx",B.SmartAdServer="smartadserver",B.Smartx="smartx",B.SmileWanted="smilewanted",B.Unruly="unruly",B.Taboola="taboola",B.Teads="teads",B.TheTradeDesk="ttd",B.Triplelift="triplelift",B.Yieldlab="yieldlab",B.SeedingAlliance="seedingAlliance",B.Seedtag="seedtag",B.Spotx="spotx",B.ShowHeroes="showheroesBs",B.StroeerCore="stroeerCore",B.StailaMedia="stailamedia",B.Xaxis="xhb",B.DSPX="dspx",B.RichAudience="ra",B.Rubicon="rubicon",B.Recognified="rads",B.Visx="visx",B.Vlyby="vlyby",B.Orbidder="orbidder"})(At||(At={}));var Pt=(t,e)=>Math.max(t.wait-(e-t.ts),0);var Be;(e=>{let t;(r=>{let i;(d=>(d[d.TOP_ANCHOR=2]="TOP_ANCHOR",d[d.BOTTOM_ANCHOR=3]="BOTTOM_ANCHOR",d[d.REWARDED=4]="REWARDED",d[d.INTERSTITIAL=5]="INTERSTITIAL"))(i=r.OutOfPageFormat||(r.OutOfPageFormat={}))})(t=e.enums||(e.enums={}))})(Be||(Be={}));var Mi="h5v-fc",Ti="h5v-pi",xn=t=>!!t.conditions&&!!t.conditions.pacingInterval,xi=(t,e,i,r)=>{var R,O,S,k;let o=new Map,n=new Map,s=new Map,a=new Map,d=0,u=0,l=null;try{let A=e.localStorage.getItem(Ti);A&&(l=JSON.parse(A),u=l.requestAds)}catch(A){r.debug("fc","failed to parse localStorage data, starting fresh",A)}let c=(O=(R=t.bidders)==null?void 0:R.filter(xn))!=null?O:[],p=(S=c.filter(A=>{var y,E,P;return!((y=A.conditions.pacingInterval)!=null&&y.events)||((P=(E=A.conditions.pacingInterval)==null?void 0:E.events)==null?void 0:P.includes("bidWon"))}))!=null?S:[],g=(k=c.filter(A=>{var y,E;return(E=(y=A.conditions.pacingInterval)==null?void 0:y.events)==null?void 0:E.includes("bidRequested")}))!=null?k:[],m=t.positions||[],h=()=>{var y;if(t.persistent===!0){let E={bCaps:Array.from(s.entries()).reduce((P,[T,U])=>w(v({},P),{[T]:U}),{}),pCaps:Array.from(o.entries()).reduce((P,[T,U])=>w(v({},P),{[T]:U}),{}),pLastImpAdRequests:Array.from(n.entries()).reduce((P,[T,U])=>w(v({},P),{[T]:U}),{}),requestAds:d};e.sessionStorage.setItem(Mi,JSON.stringify(E))}let A={createdAt:(y=l==null?void 0:l.createdAt)!=null?y:Date.now(),ts:Date.now(),requestAds:u};e.localStorage.setItem(Ti,JSON.stringify(A))},f=(A,y,E,P)=>{var U;let T=y.bidders;if((!T||T.includes(P.bidder))&&y.domId===P.adUnitCode){let D=`${P.adUnitCode}:${P.bidder}`,re=(U=s.get(D))!=null?U:[];re.push({ts:A,wait:E}),s.set(D,re),e.setTimeout(()=>{r.debug("fc",`removing ${D} at ${A}`);let b=s.get(D);b&&s.set(D,b.filter(M=>M.ts!==A))},E),h()}},I=(A,y,E)=>{var T;let P=(T=o.get(y))!=null?T:[];P.push({ts:A,wait:E.intervalInMs}),o.set(y,P),e.setTimeout(()=>{let U=o.get(y);U&&o.set(y,U.filter(D=>D.ts!==A))},E.intervalInMs),h()},C=A=>{m.filter(y=>y.adUnitPath===A).forEach(y=>{y.conditions.pacingInterval&&I(i(),A,y.conditions.pacingInterval),y.conditions.pacingRequestAds&&(n.set(A,d),h())})};if(t.persistent===!0){let A=e.sessionStorage.getItem(Mi);if(A)try{let y=JSON.parse(A);d=y.requestAds,Object.entries(y.bCaps).forEach(([E,P])=>{P==null||P.forEach(T=>{let[U,D]=E.split(":"),re=Pt(T,i());f(i(),{domId:U,bidders:[D]},re,{bidder:D,adUnitCode:U})})}),Object.entries(y.pCaps).forEach(([E,P])=>{P==null||P.forEach(T=>{let U=Pt(T,i());I(T.ts,E,{intervalInMs:U})})})}catch(y){r.error("fc","failed to parse fc state",y)}}return{onSlotRequested(A){m.filter(y=>y.adUnitPath===A.slot.getAdUnitPath()).forEach(y=>{var E;if(y.conditions.adRequestLimit){let P=y.adUnitPath,T=(E=a.get(P))!=null?E:0;a.set(P,T+1)}})},onAuctionEnd(A){g.forEach(y=>{var E;(E=A.bidderRequests)==null||E.forEach(P=>{var T;(T=P==null?void 0:P.bids)==null||T.forEach(U=>{f(i(),y,y.conditions.pacingInterval.intervalInMs,U)})})}),h()},onBidWon(A){p.forEach(y=>f(i(),y,y.conditions.pacingInterval.intervalInMs,A)),h()},onSlotRenderEnded(A){let[y]=A.slot.getTargeting(me);!A.isEmpty&&y!==Be.enums.OutOfPageFormat.INTERSTITIAL.toString()&&C(A.slot.getAdUnitPath())},onImpressionViewable(A){let[y]=A.slot.getTargeting(me);y===Be.enums.OutOfPageFormat.INTERSTITIAL.toString()&&C(A.slot.getAdUnitPath())},beforeRequestAds(){a.clear()},afterRequestAds(){d++,u++,h()},updateAdUnitPaths(A){var y;m=((y=t.positions)!=null?y:[]).map(E=>w(v({},E),{adUnitPath:K(E.adUnitPath,A)}))},isAdUnitCapped(A){let y=A.getAdUnitPath(),E=Se(A,e);return m.filter(P=>P.adUnitPath===y).some(P=>{var T,U,D;return P.adUnitPath===y&&P.conditions.delay&&d<P.conditions.delay.minRequestAds-(E?1:0)||P.conditions.pacingRequestAds&&n.has(y)&&d-((T=n.get(y))!=null?T:0)<P.conditions.pacingRequestAds.requestAds||P.conditions.pacingInterval&&((U=o.get(y))!=null?U:[]).length>=P.conditions.pacingInterval.maxImpressions||P.conditions.adRequestLimit&&((D=a.get(y))!=null?D:0)>=P.conditions.adRequestLimit.maxAdRequests})},isBidderCapped(A,y){return t.bidders?t.bidders.filter(E=>E.domId===A&&(!E.bidders||E.bidders.includes(y))).some(({conditions:{pacingInterval:E,delay:P}})=>{var T;return E&&((T=s.get(`${A}:${y}`))!=null?T:[]).length>=E.maxImpressions||P&&d<P.minRequestAds}):!1},getTotalNumAdRequests(){return u}}};var ki=()=>{let t=new Map,e=o=>o.reduce((n,s)=>{let{adUnitCode:a,cpm:d}=s;return n[a]||(n[a]=[]),n[a].push(d),n},{}),i=o=>{let n=e(o);t.forEach((s,a)=>{n[a]||t.delete(a)}),Object.entries(n).forEach(([s,a])=>{var u;let d=(u=r(s))!=null?u:[];t.set(s,Array.from(new Set([...a,...d])))})},r=o=>{var n;return(n=t.get(o))!=null?n:null};return{groupReceivedBidsByAdUnitCode:e,onAuctionEnd:i,getLastBidCpms:r}};var Qe=(t,e,i,r={})=>{var l,c,p,g,m,h,f,I,C,R,O,S,k,A;let o=(l=r.biddersDisabling)!=null&&l.enabled?Ri(r.biddersDisabling,t):void 0,n=(c=r.adRequestThrottling)!=null&&c.enabled?Ei(r.adRequestThrottling,t):void 0,s=(p=r.frequencyCap)!=null&&p.enabled?xi(r.frequencyCap,t,t.Date.now,e):void 0,a=(g=r.previousBidCpms)!=null&&g.enabled?ki():void 0,d=(m=r.interstitial)!=null&&m.enabled?ni(r.interstitial,t,t.Date.now,e):void 0;t.pbjs=t.pbjs||{que:[]},t.googletag=t.googletag||{},t.googletag.cmd=t.googletag.cmd||[],((h=r.biddersDisabling)!=null&&h.enabled||(f=r.previousBidCpms)!=null&&f.enabled||(I=r.frequencyCap)!=null&&I.enabled||(C=r.interstitial)!=null&&C.enabled)&&t.pbjs.que.push(()=>{t.pbjs.onEvent("auctionEnd",y=>{var E;o==null||o.onAuctionEnd(y),d==null||d.onAuctionEnd(y),(E=r.previousBidCpms)!=null&&E.enabled&&y.bidsReceived&&(a==null||a.onAuctionEnd(y.bidsReceived)),s==null||s.onAuctionEnd(y)})}),((R=r.adRequestThrottling)!=null&&R.enabled||(O=r.frequencyCap)!=null&&O.enabled)&&t.googletag.cmd.push(()=>{t.googletag.pubads().addEventListener("slotRequested",y=>{n==null||n.onSlotRequested(y),s==null||s.onSlotRequested(y)})}),(S=r.frequencyCap)!=null&&S.enabled&&(t.pbjs.que.push(()=>{t.pbjs.onEvent("bidWon",y=>{r.frequencyCap&&(s==null||s.onBidWon(y))})}),i.addEventListener("beforeRequestAds",()=>{s==null||s.beforeRequestAds()}),i.addEventListener("afterRequestAds",()=>{s==null||s.afterRequestAds()})),((k=r.frequencyCap)!=null&&k.enabled||(A=r.interstitial)!=null&&A.enabled)&&t.googletag.cmd.push(()=>{t.googletag.pubads().addEventListener("slotRenderEnded",y=>{s==null||s.onSlotRenderEnded(y),d==null||d.onSlotRenderEnded(y)}),t.googletag.pubads().addEventListener("impressionViewable",y=>{s==null||s.onImpressionViewable(y)})});let u=W("GlobalAuctionContext",y=>(s==null||s.updateAdUnitPaths(y.m),d==null||d.updateAdUnitPaths(y.m),Promise.resolve()));return{isSlotThrottled(y){return!!(n!=null&&n.isThrottled(y.getSlotElementId())||s!=null&&s.isAdUnitCapped(y))},isBidderFrequencyCappedOnSlot(y,E){var P;return(P=s==null?void 0:s.isBidderCapped(y,E))!=null?P:!1},getLastBidCpmsOfAdUnit(y){var E;return(E=a==null?void 0:a.getLastBidCpms(y))!=null?E:[]},isBidderDisabled(y,E){var P;return(P=o==null?void 0:o.isBidderDisabled(y,E))!=null?P:!1},interstitialChannel:()=>d==null?void 0:d.interstitialChannel(),hasMinimumRequestAds(y){return s?s.getTotalNumAdRequests()>=y:!0},configureStep(){return u}}};var we=t=>t!==null&&typeof t=="object"&&!Array.isArray(t);function Ze(t,...e){if(!e.length)return t;let i=e.shift();if(we(t)&&we(i))for(let r in i)we(i[r])?(t[r]||Object.assign(t,{[r]:{}}),Ze(t[r],i[r])):Array.isArray(i[r])?t[r]?Array.isArray(t[r])&&(t[r]=t[r].concat(i[r])):Object.assign(t,{[r]:i[r]}):Object.assign(t,{[r]:i[r]});return Ze(t,...e)}var Oi=(t,e)=>e.pubads().getSlots().find(i=>i.getSlotElementId()===t.domId||i.getAdUnitPath()===t.adUnitPath),kn=t=>{try{let e=typeof t=="string"?JSON.parse(t):we(t)?t:null;switch(e==null?void 0:e.event){case"h5.adunit.passback":return e.passbackOrigin&&(e.domId||e.adUnitPath)?e:null;case"h5.adunit.refresh":return e;default:return null}}catch(e){return null}},On=(t,e)=>{let i=e.i.slots.find(o=>o.domId===t.domId&&o.behaviour.loaded==="backfill"),r=Oi(t,e.e.googletag);i&&r&&(e.t.debug("bridge",`Refresh ad slot ${t.domId}`),e.e.googletag.destroySlots([r]),e.e.moli.refreshAdSlot(t.domId,{loaded:"backfill"}).catch(o=>e.t.error("bridge",`failed to refresh ${t.domId}`,o)))},Bn=(t,e)=>{let i=Oi(t,e.e.googletag),r="passback";i&&i.getTargeting(r).length===0&&(e.t.debug("passback",`Process passback for ad slot ${i.getAdUnitPath()}`),i.setTargeting(r,"true"),i.setTargeting("passbackOrigin",t.passbackOrigin),e.e.googletag.pubads().refresh([i]))},Bi=()=>z("bridge",t=>{var e;return(e=t.i.bridge)!=null&&e.enabled&&(t.t.debug("bridge","add message listener"),t.e.addEventListener("message",i=>{let r=kn(i.data);if(r)switch(r.event){case"h5.adunit.passback":Bn(r,t);break;case"h5.adunit.refresh":On(r,t);break}})),Promise.resolve()});var wn=t=>t.behaviour.loaded==="manual",qn=t=>t.behaviour.loaded==="infinite",Dn=t=>t.behaviour.loaded==="backfill",Ct=t=>e=>!!t.document.getElementById(e.domId)||e.position==="interstitial"||e.position==="out-of-page"||e.position==="out-of-page-interstitial"||e.position==="out-of-page-top-anchor"||e.position==="out-of-page-bottom-anchor",qi=(t,e)=>t?typeof t=="string"?t:t[e]||"default":"default",wi=(t,e,i,r,o)=>{let{loaded:n}=v({loaded:"manual"},o);return e.slots.filter(Ct(t)).filter(s=>qi(s.behaviour.bucket,i)===r&&(s.behaviour.loaded===n||s.behaviour.loaded==="infinite")).map(s=>o!=null&&o.sizesOverride?w(v({},s),{sizes:o.sizesOverride}):s)},et=class t{constructor(e,i,r,o){this.assetService=e;this.eventService=i;this.window=r;this.adPipelineConfig=o;this.requestAdsCalls=0;this.adPipeline=new Ce({init:[()=>Promise.reject("AdPipeline not initialized yet")],configure:[],defineSlots:()=>Promise.resolve([]),prepareRequestAds:[],requestBids:[],requestAds:()=>Promise.resolve()},ce(),this.window,Qe(this.window,ce(),this.eventService));this.initialize=(e,i)=>{var p;let r=t.getEnvironment(i),o=e.adServer||"gam",n=o==="gam",s=((p=e.spa)==null?void 0:p.enabled)===!0;this.logger.setLogger(j(i,this.window)),this.logger.debug("AdService",`Initializing with environment ${r} and ad server ${o}`);let a=n?[Kt(),Bi()]:[],d=n?[Xt()]:[];n&&s&&d.push(Yt(),Jt());let u=[];n&&u.push(Qt(),Zt());let l=[];e.prebid&&r==="production"&&(a.push(li(this.assetService)),d.push(ci(e.prebid,e.schain)),s&&(d.push(ui(e.prebid)),e.prebid.clearAllAuctions&&d.push(pi())),u.push(mi(e.prebid)),l.push(gi(e.prebid,o))),e.a9&&e.a9.enabled!==!1&&r==="production"&&n&&(a.push(Ii(e.a9,this.assetService)),d.push(vi(e.a9,e.schain)),d.push(hi(e.a9,i.audience)),u.push(Si()),l.push(Ai(e.a9)));let c=Qe(this.window,this.logger,this.eventService,e.globalAuctionContext);if(d.push(c.configureStep()),a.push(...i.adPipelineConfig.initSteps),d.push(...i.adPipelineConfig.configureSteps),u.push(...i.adPipelineConfig.prepareRequestAdsSteps),l.push(...i.adPipelineConfig.requestBidsSteps),r==="test"){let g=Ci(this.window);g&&d.push(()=>Pi(this.window,g))}return this.adPipeline=new Ce({init:a,configure:d,defineSlots:n?ei():fi(),prepareRequestAds:u,requestBids:l,requestAds:n?ti():yi()},this.logger,this.window,c),new Promise(g=>{je(this.window,()=>{this.logger.debug("DOM","dom ready"),g(e)})})};this.requestAds=(e,i)=>Ne(this,null,function*(){var d;this.requestAdsCalls=this.requestAdsCalls+1;let{refreshSlots:r,refreshInfiniteSlots:o,refreshBuckets:n}=i,s=St(this.window,i,e.labelSizeConfig,e.targeting),a=n.flatMap(u=>wi(this.window,e,s,u.bucket,u.options).map(l=>l.domId));this.logger.info("AdService",`RequestAds[${this.requestAdsCalls}]`,r,n),this.eventService.emit("beforeRequestAds",{runtimeConfig:i});try{let u=e.slots.map(l=>wn(l)?r.includes(l.domId)||a.includes(l.domId)?l:null:qn(l)?o.some(c=>c.artificialDomId===l.domId)?l:null:Dn(l)?null:l).filter(G).filter(Ct(this.window));if((d=e.buckets)!=null&&d.enabled){let l=new Map;u.forEach(p=>{let g=qi(p.behaviour.bucket,s),m=l.get(g);m?m.push(p):l.set(g,[p])});let c=l.size===0?this.adPipeline.run([],e,i,this.requestAdsCalls).then(()=>[]):Promise.all(Array.from(l.entries()).map(([p,g])=>(this.logger.debug("AdPipeline",`running bucket ${p}, slots:`,g),this.adPipeline.run(g,e,i,this.requestAdsCalls).then(()=>g))));return this.eventService.emit("afterRequestAds",{state:"finished"}),c.then(p=>Ie(p))}else return yield this.adPipeline.run(u,e,i,this.requestAdsCalls),this.eventService.emit("afterRequestAds",{state:"finished"}),u}catch(u){return this.logger.error("AdPipeline","slot filtering failed",u),this.eventService.emit("afterRequestAds",{state:"error"}),Promise.reject(u)}});this.getAdPipeline=()=>this.adPipeline;this.setLogger=e=>{this.logger.setLogger(e)};this.logger=new We(ce()),o&&(this.adPipeline=new Ce(o,this.logger,r,Qe(r,this.logger,this.eventService)))}static getEnvironment(e){return e.environment||"production"}refreshAdSlots(e,i,r,o){if(e.length===0)return Promise.resolve();let{loaded:n}=v({loaded:"manual"},o),s=new Set(["infinite"]);n==="eager"?(s.add("manual"),s.add("eager")):s.add(n);let a=i.slots.filter(d=>e.some(u=>u===d.domId)&&s.has(d.behaviour.loaded)).filter(Ct(this.window)).map(d=>o!=null&&o.sizesOverride?w(v({},d),{sizes:o.sizesOverride}):d);if(e.length!==a.length){let d=a.filter(l=>e.every(c=>c!==l.domId)),u=e.filter(l=>a.every(c=>c.domId!==l));d.length&&this.logger.warn("AdService","The following slots do not exist on the page DOM.",d),u.length&&this.logger.warn("AdService","The following slots are not configured in the ad-tag config.",d)}return this.logger.debug("AdService","refresh ad slots",a),this.adPipeline.run(a,i,r,this.requestAdsCalls,{options:o})}refreshBucket(e,i,r,o){var a;if(!((a=i.buckets)!=null&&a.enabled))return Promise.resolve();let n=St(this.window,r,i.labelSizeConfig,i.targeting),s=wi(this.window,i,n,e,o);return s.length===0?(this.logger.warn("AdService","No slots found in bucket",e),Promise.resolve()):(this.logger.debug("AdService","refresh ad buckets",s,i.targeting),this.adPipeline.run(s,i,r,this.requestAdsCalls,{bucketName:e,options:o}))}};var Di=()=>{let t=new Map,e=new Map;return{addEventListener(i,r,o={}){var s;let n=o.once?e:t;n.has(i)||n.set(i,new Set),(s=n.get(i))==null||s.add(r)},removeEventListener(i,r){var o,n;(o=t.get(i))==null||o.delete(r),(n=e.get(i))==null||n.delete(r)},emit(i,r){var n;(n=t.get(i))==null||n.forEach(s=>{try{s(r)}catch(a){console.error(`Error in event listener for ${String(i)}:`,a)}});let o=e.get(i);o&&(o.forEach(s=>{try{s(r)}catch(a){console.error(`Error in one-time event listener for ${String(i)}:`,a)}finally{o.delete(s)}}),o.size===0&&e.delete(i))}}};var ve={moliEnv:"moliEnv",moliPubCode:"moliPubCode",moliVersion:"moliVersion",abTest:"ABtest"};var qe=(t,e,i,r=o=>!0)=>[{source:"queryParam",value:Pe(t.location.search).get(e)},{source:"sessionStorage",value:de(i,t.sessionStorage)},{source:"localStorage",value:de(i,t.localStorage)}].map(({source:o,value:n})=>n&&r(n)?{source:o,value:n}:void 0).filter(G);var Ln=t=>!!["production","test"].find(i=>i===t),Un=t=>{let e=Number(t);return!isNaN(e)&&e>=1&&e<=100},Li=t=>qe(t,ve.moliEnv,se.moliEnv,Ln)[0]||void 0,Ui=(t,e,i)=>[{source:"queryParam",value:Pe(t.location.search).get(e)},{source:"sessionStorage",value:de(i,t.sessionStorage)},{source:"localStorage",value:de(i,t.localStorage)}].map(({source:r,value:o})=>o&&Un(o)?{source:r,value:o}:void 0).filter(G),_i=(t,e)=>ke(se.moliEnv,t,e);var De=(t,e,i)=>{switch(t){case"none":return!0;case"href":return i.href===e;case"path":try{let r=new URL(e);return i.pathname===r.pathname}catch(r){return!0}}},Vi=(t,e,i)=>{switch(t){case"none":return!0;case"href":return i.href!==e;case"path":try{let r=new URL(e);return i.pathname!==r.pathname}catch(r){return!0}}};var Ni=t=>{let e=ze(t),i=Di(),r=new et(e,i,t),o=t,n={state:"configurable",initialize:!1,runtimeConfig:D(),modules:[]};function s(b,M){switch(n.state){case"configurable":case"configured":{n.runtimeConfig.keyValues[b]=M;break}case"spa-finished":case"spa-requestAds":{n.nextRuntimeConfig.keyValues[b]=M;break}default:{j(n.runtimeConfig,t).error("MoliGlobal",`Setting key-value after configuration: ${b} : ${M}`);break}}}function a(b){switch(n.state){case"configurable":case"configured":{n.runtimeConfig.labels.push(b);break}case"spa-requestAds":case"spa-finished":{n.nextRuntimeConfig.labels.push(b);break}default:{j(n.runtimeConfig,t).error("MoliGlobal",`Adding label after configure: ${b}`);break}}}function d(b){switch(n.state){case"configurable":case"configured":{n.runtimeConfig.adUnitPathVariables=b;break}case"spa-requestAds":case"spa-finished":{n.nextRuntimeConfig.adUnitPathVariables=b;break}default:{j(n.runtimeConfig,t).error("MoliGlobal",`Setting unit path variables after configuration: ${b}`);break}}}function u(){let b=he(t.location.hostname)||"unknown";switch(n.state){case"configurable":return w(v({},n.runtimeConfig.adUnitPathVariables),{domain:b,device:"unknown"});case"configured":case"requestAds":case"spa-requestAds":case"spa-finished":case"finished":case"error":let M=xe(n.config.labelSizeConfig||[],[],t);return w(v({},f().adUnitPathVariables),{domain:n.config.domain||b,device:M.getDeviceLabel()})}}function l(b,M){let _=(M||{}).removeNetworkChildId||!1,N=K(b,u());return _?He(N):N}function c(b){switch(n.state){case"configurable":case"configured":{n.runtimeConfig.logger=b;break}default:{b.error("Setting a custom logger is not allowed after configuration");break}}}function p(b){switch(n.state){case"configurable":case"configured":{n.runtimeConfig.hooks.beforeRequestAds.push(b);break}default:{j(n.runtimeConfig,t).error("MoliGlobal","Trying to add a hook beforeRequestAds. Already configured.",n.config);break}}}function g(b){switch(n.state){case"configurable":case"configured":{n.runtimeConfig.hooks.afterRequestAds.push(b);break}default:{j(n.runtimeConfig,t).error("MoliGlobal","Trying to add a hook afterRequestAds. Already configured.",n.config);break}}}function m(){switch(n.state){case"configurable":return null;case"configured":return n.config;case"requestAds":return n.config;case"spa-requestAds":case"spa-finished":return n.config;case"finished":return n.config;case"error":return n.config}}function h(){return n.runtimeConfig}function f(){var b,M,q,_,N,X,L;return{keyValues:v(v({},(M=(b=n.config)==null?void 0:b.targeting)==null?void 0:M.keyValues),n.runtimeConfig.keyValues),labels:[...(N=(_=(q=n.config)==null?void 0:q.targeting)==null?void 0:_.labels)!=null?N:[],...n.runtimeConfig.labels],adUnitPathVariables:v(v({},(L=(X=n.config)==null?void 0:X.targeting)==null?void 0:L.adUnitPathVariables),n.runtimeConfig.adUnitPathVariables)}}function I(b){switch(n.state){case"configurable":case"configured":{n.modules.push(b);return}default:j(n.runtimeConfig,t).error("Registering a module is only allowed within the ad tag before the ad tag is configured")}}function C(b){var M;switch(n.state){case"configurable":{let q=n.initialize,_=Li(t),N=n.modules;_&&(n.runtimeConfig.environment=_.value),(_==null?void 0:_.source)==="queryParam"&&_i(_.value,t.sessionStorage);let X=j(n.runtimeConfig,t);return X.debug("MoliGlobal","configure modules",(M=b.modules)!=null?M:{}),N.forEach(L=>{var ee;try{L.o((ee=b.modules)!=null?ee:{}),X.debug("MoliGlobal",`configure ${L.moduleType} module ${L.name}`,L.i()),n.runtimeConfig.adPipelineConfig.initSteps.push(...L.s()),n.runtimeConfig.adPipelineConfig.configureSteps.push(...L.a()),n.runtimeConfig.adPipelineConfig.prepareRequestAdsSteps.push(...L.d()),L.A&&n.runtimeConfig.adPipelineConfig.requestBidsSteps.push(...L.A()),L.I&&n.runtimeConfig.adPipelineConfig.prebidBidsBackHandler.push(...L.I())}catch(Y){X.error("MoliGlobal",`failed to configure ${L.moduleType} module ${L.name}`,Y)}}),n={state:"configured",config:b,runtimeConfig:n.runtimeConfig,modules:N},q||b.requestAds===!0?R():Promise.resolve(n)}case"configured":return j(n.runtimeConfig,t).error("MoliGlobal","Trying to configure moli tag twice. Already configured.",n.config),Promise.resolve(n);case"requestAds":return j(n.runtimeConfig,t).error("MoliGlobal","Trying to configure moli tag twice. Already requesting ads."),Promise.resolve(n);case"finished":return j(n.runtimeConfig,t).error("MoliGlobal","Trying to configure moli tag twice. Already finished."),Promise.resolve(n);case"error":return j(n.runtimeConfig,t).error("MoliGlobal","Trying to configure moli tag twice. Already finished, but with an error.",n.error),Promise.resolve(n)}return Promise.resolve(null)}function R(){var b;switch(n.state){case"configurable":return n.initialize=!0,Promise.resolve(n);case"configured":{P(),T(n.config.domain);let{refreshInfiniteSlots:M}=n.runtimeConfig,q=n.config;M.length>0&&M.forEach(L=>{q=$e(q,L.idOfConfiguredSlot,L.artificialDomId,j(n.runtimeConfig,t))});let _=j(n.runtimeConfig,t);n.runtimeConfig.hooks&&n.runtimeConfig.hooks.beforeRequestAds&&n.runtimeConfig.hooks.beforeRequestAds.forEach(L=>{try{L(q,n.runtimeConfig)}catch(ee){_.error("MoliGlobal","beforeRequestAds hook failed",ee)}});let N=n.runtimeConfig.hooks.afterRequestAds;if(((b=q.spa)==null?void 0:b.enabled)===!0){let L=n.runtimeConfig,ee=r.initialize(q,L);return n={state:"spa-requestAds",config:q,initialized:ee,modules:n.modules,href:t.location.href,runtimeConfig:Object.freeze(D(n.runtimeConfig,{keepTargeting:!0})),nextRuntimeConfig:D(n.runtimeConfig)},ee.then(()=>r.requestAds(q,L)).then(()=>{var ne,le;let Y=(le=(ne=q.spa)==null?void 0:ne.validateLocation)!=null?le:"href";if(n.state==="spa-requestAds"&&De(Y,n.href,t.location)){let{config:Ae,runtimeConfig:Ue}=n;n.runtimeConfig.refreshSlots.length>0&&r.refreshAdSlots(Ue.refreshSlots,Ae,Ue),n.runtimeConfig.refreshBuckets.length>0&&n.runtimeConfig.refreshBuckets.forEach(Te=>{r.refreshBucket(Te.bucket,Ae,Ue,Te.options)}),N.forEach(Te=>Te("spa-finished"));let bt=w(v({},n),{state:"spa-finished",nextRuntimeConfig:D(n.runtimeConfig),runtimeConfig:D(n.runtimeConfig,{keepTargeting:!0})});return n=bt,bt}else return n.state==="spa-finished"||n.state==="spa-requestAds"?(j(n.runtimeConfig,t).debug("MoliGlobal","A previous requestAds() was slower than the following requestAds() call"),n):Promise.reject(`reached invalid state [${n.state}]`)})}else return n={state:"requestAds",config:q,modules:n.modules,runtimeConfig:Object.freeze(n.runtimeConfig)},r.initialize(q,n.runtimeConfig).then(L=>r.requestAds(L,n.runtimeConfig)).then(()=>(n={state:"finished",config:q,runtimeConfig:n.runtimeConfig,modules:n.modules},N.forEach(L=>L("finished")),Promise.resolve(n))).catch(L=>(j(n.runtimeConfig,t).error("MoliGlobal",L),n={state:"error",config:q,runtimeConfig:n.runtimeConfig,error:L,modules:n.modules},N.forEach(ee=>ee("error")),Promise.resolve(n)))}case"spa-requestAds":case"spa-finished":{n.state==="spa-requestAds"&&j(n.runtimeConfig,t).debug("MoliGlobal","requestAds is being called while the previous requestAds() hasn't finished yet"),P(),T(n.config.domain);let{modules:M}=n,q=n.nextRuntimeConfig.hooks.afterRequestAds,_=n.nextRuntimeConfig.hooks.beforeRequestAds,N=n;_.forEach(Y=>{try{Y(N.config,n.runtimeConfig)}catch(ne){j(n.runtimeConfig,t).error("MoliGlobal","beforeRequestAds hook failed",ne)}});let{initialized:X,href:L,nextRuntimeConfig:ee}=n;return n=w(v({},N),{state:"spa-requestAds",runtimeConfig:D(n.nextRuntimeConfig,{keepTargeting:!0}),nextRuntimeConfig:D(n.runtimeConfig)}),X.then(Y=>{var le,Ae;let ne=(Ae=(le=Y.spa)==null?void 0:le.validateLocation)!=null?Ae:"href";return Vi(ne,L,t.location)?r.requestAds(Y,ee).then(()=>Y):Promise.reject(`You are trying to refresh ads on the same page, which is not allowed. Using ${ne} for validation.`)}).then(Y=>{let ne=n.runtimeConfig;return n.runtimeConfig.refreshSlots.length>0&&r.refreshAdSlots(n.runtimeConfig.refreshSlots,Y,n.runtimeConfig),n.runtimeConfig.refreshBuckets.length>0&&n.runtimeConfig.refreshBuckets.forEach(le=>{r.refreshBucket(le.bucket,Y,ne,le.options)}),n={state:"spa-finished",config:Y,initialized:X,modules:M,href:t.location.href,runtimeConfig:n.runtimeConfig,nextRuntimeConfig:D(n.runtimeConfig)},q.forEach(le=>le("spa-finished")),n})}case"requestAds":return j(n.runtimeConfig,t).error("MoliGlobal","Trying to requestAds twice. Already requesting ads."),Promise.reject();case"finished":return j(n.runtimeConfig,t).error("MoliGlobal","Trying to requestAds twice. Already finished."),Promise.reject();case"error":return j(n.runtimeConfig,t).error("MoliGlobal","Trying to requestAds twice. Already finished, but with an error.",n.error),Promise.reject()}}function O(b,M){var _,N;let q=typeof b=="string"?[b]:b;switch(n.state){case"configurable":case"configured":return n.runtimeConfig.refreshSlots.push(...q),Promise.resolve("queued");case"spa-requestAds":return n.runtimeConfig.refreshSlots.push(...q),Promise.resolve("queued");case"spa-finished":let X=(N=(_=n.config.spa)==null?void 0:_.validateLocation)!=null?N:"href";return De(X,n.href,t.location)?r.refreshAdSlots(q,n.config,n.runtimeConfig,M).then(()=>"refreshed"):(n.nextRuntimeConfig.refreshSlots.push(...q),Promise.resolve("queued"));case"finished":case"requestAds":return r.refreshAdSlots(q,n.config,n.runtimeConfig,M).then(()=>"refreshed");default:return j(n.runtimeConfig,t).error("MoliGlobal",`refreshAdSlot is not allowed in state ${n.state}`,n.config),Promise.reject(`not allowed in state ${n.state}`)}}function S(b,M){var q,_;switch(n.state){case"configurable":case"configured":return n.runtimeConfig.refreshInfiniteSlots.push({artificialDomId:b,idOfConfiguredSlot:M}),Promise.resolve("queued");case"spa-requestAds":return n.runtimeConfig.refreshInfiniteSlots.push({artificialDomId:b,idOfConfiguredSlot:M}),Promise.resolve("queued");case"spa-finished":let N=(_=(q=n.config.spa)==null?void 0:q.validateLocation)!=null?_:"href";return De(N,n.href,t.location)?(n=w(v({},n),{config:$e(n.config,M,b,j(n.runtimeConfig,t))}),r.refreshAdSlots([b],n.config,n.runtimeConfig).then(()=>"refreshed")):(n.runtimeConfig.refreshInfiniteSlots.push({artificialDomId:b,idOfConfiguredSlot:M}),Promise.resolve("queued"));case"finished":case"requestAds":return n=w(v({},n),{config:$e(n.config,M,b,j(n.runtimeConfig,t))}),r.refreshAdSlots([b],n.config,n.runtimeConfig).then(()=>"refreshed");default:return j(n.runtimeConfig,t).error("MoliGlobal",`refreshInfiniteAdSlot is not allowed in state ${n.state}`,n.config),Promise.reject(`not allowed in state ${n.state}`)}}function k(b,M){var q,_;switch(n.state){case"configurable":return n.runtimeConfig.refreshBuckets.push({bucket:b,options:M}),Promise.resolve("queued");case"configured":return n.runtimeConfig.refreshBuckets.push({bucket:b,options:M}),Promise.resolve("queued");case"spa-requestAds":return n.runtimeConfig.refreshBuckets.push({bucket:b,options:M}),Promise.resolve("queued");case"spa-finished":{let N=(_=(q=n.config.spa)==null?void 0:q.validateLocation)!=null?_:"href";return De(N,n.href,t.location)?r.refreshBucket(b,n.config,n.runtimeConfig,M).then(()=>"refreshed"):(n.nextRuntimeConfig.refreshBuckets.push({bucket:b,options:M}),Promise.resolve("queued"))}case"finished":case"requestAds":return r.refreshBucket(b,n.config,n.runtimeConfig,M).then(()=>"refreshed");default:return j(n.runtimeConfig,t).error("MoliGlobal",`refreshAdSlot is not allowed in state ${n.state}`,n.config),Promise.reject(`not allowed in state ${n.state}`)}}function A(){t.dispatchEvent(new CustomEvent("h5v.trigger-delay"))}function y(){return n.state}function E(b){switch(n.state){case"configurable":{j(n.runtimeConfig,t).error("MoliGlobal","Cannot open console before configuration");break}default:e.loadScript({assetUrl:b!=null?b:`https://highfivve.github.io/moli-ad-tag/assets/bundle/v${Oe.version}/console.js`,loadMethod:1,name:"moli-debugger"}).catch(M=>console.error("failed to load moli debugger",M))}}function P(){let b=Ui(t,ve.abTest,se.abTest),M=b.length>0?Number(b[0].value):Math.floor(Math.random()*100)+1;s(ve.abTest,M.toString())}function T(b){let M=b||he(t.location.hostname);M&&a(M)}function U(b){switch(n.state){case"configurable":case"configured":{n.runtimeConfig.audience=b;break}case"spa-finished":case"spa-requestAds":{n.nextRuntimeConfig.audience=b;break}default:{j(n.runtimeConfig,t).error("MoliGlobal",`Setting audience targeting after configuration: ${JSON.stringify(b)}`);break}}}function D(b,M){var q,_,N,X,L,ee,Y,ne;return{environment:(q=b==null?void 0:b.environment)!=null?q:"production",hooks:{beforeRequestAds:(_=b==null?void 0:b.hooks.beforeRequestAds)!=null?_:[],afterRequestAds:(N=b==null?void 0:b.hooks.afterRequestAds)!=null?N:[]},logger:(X=b==null?void 0:b.logger)!=null?X:void 0,adUnitPathVariables:(M==null?void 0:M.keepTargeting)===!0?(L=b==null?void 0:b.adUnitPathVariables)!=null?L:{}:{},labels:(M==null?void 0:M.keepTargeting)===!0?(ee=b==null?void 0:b.labels)!=null?ee:[]:[],keyValues:(M==null?void 0:M.keepTargeting)===!0?(Y=b==null?void 0:b.keyValues)!=null?Y:{}:{},refreshSlots:[],refreshInfiniteSlots:[],refreshBuckets:[],adPipelineConfig:{initSteps:[],configureSteps:[],prepareRequestAdsSteps:[],requestBidsSteps:[],prebidBidsBackHandler:(ne=b==null?void 0:b.adPipelineConfig.prebidBidsBackHandler)!=null?ne:[]}}}return{que:{push(b){b(o.moli)}},version:Oe.version,setTargeting:s,addLabel:a,setLogger:c,setAdUnitPathVariables:d,resolveAdUnitPath:l,beforeRequestAds:p,afterRequestAds:g,getConfig:m,getRuntimeConfig:h,getPageTargeting:f,registerModule:I,configure:C,requestAds:R,refreshAdSlot:O,refreshBucket:k,refreshInfiniteAdSlot:S,triggerDelay:A,getState:y,openConsole:E,setAudience:U,addEventListener:i.addEventListener,removeEventListener:i.removeEventListener}};var ji=t=>{let e=t,i=e.moli?[...e.moli.que]:[],r=Ni(t);return e.moli=r,i.forEach(o=>o(r)),r};ji(window);var _n=t=>t==="android"?"aaid":t==="ios"?"idfa":void 0,zi=(t,e,i,r,o,n,s,a,d)=>{let u=_n(typeof n=="string"?n:n[0]),l=o.reduce((g,m)=>v(v({},g),m),{}),c=o.length?`&kv=${JSON.stringify(l)}`:"",p=d?`&gdpr_consent=${d}`:"";s(`https://api.theadex.com/collector/v1/ifa/c/${t}/t/${e}/request?&ifa=${r}&ifa_type=${u}${c}${p}&appName=${i}`).catch(g=>a.error(g))};var Fi=(t,e,i)=>{let r=t[e.key],o=Rt(t,e.valueType,e.valueKey);if(!r||Array.isArray(r)||o===void 0&&e.defaultValue===void 0||e.valueType==="number"&&Number.isNaN(o)&&e.defaultValue===void 0){i.warn("Adex DMP",`values for key ${e.key}/valueKey ${e.valueKey} were empty or key was an array. Key/Value:`,r,o);return}let n=Hi(o,e,i);return{[e.attribute]:{[r]:n}}},Gi=(t,e,i)=>{let r=Rt(t,e.adexValueType,e.key);if(r===void 0&&e.defaultValue===void 0||e.adexValueType==="number"&&(Number.isNaN(r)&&e.defaultValue===void 0||Array.isArray(r))){i.warn("Adex DMP",`value for key ${e.key} was empty or key was an array. Value:`,r);return}let o=Hi(r,e,i);return{[e.attribute]:o}},Wi=(t,e,i)=>{let r=Rt(t,"string",e.key);if(r===void 0&&(e.defaultValue===void 0||e.defaultValue.length===0)||typeof r=="number"){i.warn("Adex DMP",`value for key "${e.key}" was empty or number. Value:`,r);return}let o=Nn(r,e,i);return{[e.attribute]:o}},$i=t=>Object.fromEntries(t.sort().map(e=>[e,1])),Vn=t=>t.sort().join(","),Rt=(t,e,i)=>e==="number"?Number(t[i]):t[i],Hi=(t,e,i)=>t!==void 0&&!Number.isNaN(t)?Array.isArray(t)?Vn(t):t:Ki(e,i),Nn=(t,e,i)=>t===void 0?Ki(e,i):Array.isArray(t)?$i(t):{[t]:1},Ki=(t,e)=>(e.warn("Adex DMP","using defaultValue",t.defaultValue,"as fallback for key",t.key),t.adexValueType==="list"?t.defaultValue?$i(t.defaultValue):void 0:t.defaultValue);var Yi=(t,e)=>{var i;e.Utiq||(e.Utiq={queue:[]}),(i=e.Utiq).queue||(i.queue=[]),e.Utiq.queue.push(()=>{var r,o;(o=(r=e.Utiq)==null?void 0:r.API)==null||o.addEventListener("onIdsAvailable",({mtid:n})=>{e._adexc.push([`/${t.adexCustomerId}/${t.adexTagId}/`,"cm","_cm",[308,n]])})})};var fe=x.responses.TCPurpose,tt=class{constructor(){this.name="the-adex-dmp";this.description="Moli DMP module for The Adex.";this.moduleType="dmp";this.adexConfig=null;this.isLoaded=!1;this.hasRequiredConsent=e=>!e.gdprApplies||e.vendor.consents[44]&&[fe.STORE_INFORMATION_ON_DEVICE,fe.SELECT_BASIC_ADS,fe.CREATE_PERSONALISED_ADS_PROFILE,fe.SELECT_PERSONALISED_ADS,fe.CREATE_PERSONALISED_CONTENT_PROFILE,fe.SELECT_PERSONALISED_CONTENT,fe.MEASURE_AD_PERFORMANCE,fe.MEASURE_CONTENT_PERFORMANCE,fe.APPLY_MARKET_RESEARCH,fe.DEVELOP_IMPROVE_PRODUCTS].every(i=>e.purpose.consents[i]);this.getOrInitAdexQueue=e=>{let i=e;return i._adexc=i._adexc||[],i};this.getAdexKeyValues=(e,i)=>{var o;let r=v(v({},(o=e.i.targeting)==null?void 0:o.keyValues),e.l.keyValues);if(Object.keys(r).length>0)return i.mappingDefinitions.map(n=>{switch(n.adexValueType){case"map":return Fi(r,n,e.t);case"list":return Wi(r,n,e.t);default:return Gi(r,n,e.t)}}).filter(G)};this.configureAdexC=(e,i)=>{var n;let r=this.getOrInitAdexQueue(e.e),o=this.getAdexKeyValues(e,i);o?r._adexc.push([`/${i.adexCustomerId}/${i.adexTagId}/`,"ut","_kv",[o.reduce((s,a)=>v(v({},s),a),{}),i.spaMode?1:0]]):e.t.warn("Adex DMP","targeting key/values are empty"),(n=i.enabledPartners)!=null&&n.includes("utiq")&&Yi(i,e.e)}}i(){return this.adexConfig}o(e){e!=null&&e.adex&&e.adex.enabled&&(this.adexConfig=e.adex)}s(){let e=this.adexConfig;return e?[z("DMP module setup",i=>this.track(i,e))]:[]}a(){let e=this.adexConfig;return e!=null&&e.spaMode?[W("DMP module setup",i=>(this.configureAdexC(i,e),Promise.resolve()))]:[]}track(e,i){var u,l;let{adexCustomerId:r,adexTagId:o,appConfig:n,appName:s}=i;this.configureAdexC(e,i);let a=this.getAdexKeyValues(e,i),d=v(v({},(u=e.i.targeting)==null?void 0:u.keyValues),e.l.keyValues);if(this.hasRequiredConsent(e.n)&&!this.isLoaded&&Object.keys(d).length>0){this.isLoaded=!0;let c=G(n)&&G(d[n.advertiserIdKey])&&(d[n.clientTypeKey]==="android"||d[n.clientTypeKey]==="ios");if(n!=null&&n.advertiserIdKey&&c){let p=e.n.gdprApplies?e.n.tcString:void 0,g=d[n.advertiserIdKey];typeof g=="string"&&a&&zi(r,n.adexMobileTagId?n.adexMobileTagId:o,s,g,a,(l=d[n.clientTypeKey])!=null?l:"",e.e.fetch,e.t,p)}else e.c.loadScript({name:this.name,assetUrl:`https://dmp.theadex.com/d/${r}/${o}/s/adex.js`,loadMethod:1}).catch(p=>e.t.error("failed to load adex",p))}return Promise.resolve()}d(){return[]}};window.moli.registerModule(new tt);var ie=(t,e)=>{let{advertiserId:i,companyIds:r}=t;return!!i&&e.includes(i)||!!r&&e.some(o=>r.includes(o))};var Re=class Re{constructor(e,i,r,o,n,s,a,d){this.userActivityService=e;this.refreshInterval=i;this.refreshIntervalOverrides=r;this.useIntersectionObserver=o;this.disableAdVisibilityChecks=n;this.viewabilityOverrides=s;this.window=a;this.logger=d;this.isSlotTracked=e=>this.visibilityRecords.has(e);this.removeSlotTracking=e=>{var r;(r=this.logger)==null||r.debug("AdVisibilityService",`removing slot visibility tracking for ${e.getSlotElementId()}`,e),this.visibilityRecords.delete(e.getSlotElementId());let i=this.observedDomElementForSlot(e);this.intersectionObserver&&i&&this.intersectionObserver.unobserve(i.target)};this.handleGoogletagAdVisibilityChanged=e=>{var o;let i=e.slot,r=this.visibilityRecordForGoogletagEvent(e);r&&((o=this.logger)==null||o.debug("AdVisibilityService",`Visibility of slot ${i.getSlotElementId()} changed. Visible area: ${e.inViewPercentage}%`),this.updateVisibilityRecord(r,e.inViewPercentage/100))};this.updateVisibilityRecord=(e,i)=>{var r,o,n;if(e.latestStartVisible){let s=this.window.performance.now()-e.latestStartVisible;(r=this.logger)==null||r.debug("AdVisibilityService",`added ${Math.round(s)}ms visibility to ${e.slot.getSlotElementId()}`),e.durationVisibleSum+=s}i>=this.minimalAdVisibilityRatio?(e.latestStartVisible=this.window.performance.now(),(o=this.logger)==null||o.debug("AdVisibilityService",`ad ${e.slot.getSlotElementId()} visible`)):(e.latestStartVisible=void 0,(n=this.logger)==null||n.debug("AdVisibilityService",`ad ${e.slot.getSlotElementId()} not visible`))};this.visibilityRecordForGoogletagEvent=e=>this.visibilityRecords.get(e.slot.getSlotElementId());var l;this.minimalAdVisibilityRatio=n?0:.5,this.visibilityRecords=new Map,(o||Object.values(s).some(c=>(c==null?void 0:c.variant)==="css"))&&"IntersectionObserver"in this.window&&(this.intersectionObserver=new this.window.IntersectionObserver(c=>this.handleObservedAdVisibilityChanged(c),{threshold:this.minimalAdVisibilityRatio})),o||this.window.googletag.cmd.push(()=>{this.window.googletag.pubads().addEventListener("slotVisibilityChanged",this.handleGoogletagAdVisibilityChanged)}),this.userActivityService.addUserActivityChangedListener(c=>this.handleUserActivityChanged(c)),this.setUpdateTimer(!0),(l=this.logger)==null||l.debug("AdVisibilityService","initialized")}trackSlot(e,i,r,o){var a;let n=e.getSlotElementId(),s=this.observedDomElementForSlot(e);if(s){(a=this.logger)==null||a.debug("AdVisibilityService",`tracking slot ${e.getSlotElementId()}`,e),this.isSlotTracked(n)&&this.removeSlotTracking(e);let d=s.viewabilityOverride;this.visibilityRecords.set(e.getSlotElementId(),{slot:e,latestStartVisible:this.disableAdVisibilityChecks||(d==null?void 0:d.variant)==="disabled"&&(d.disableAllAdVisibilityChecks||!(d.disabledAdVisibilityCheckAdvertiserIds&&d.disabledAdVisibilityCheckAdvertiserIds.length>0)||ie({advertiserId:r,companyIds:o},d.disabledAdVisibilityCheckAdvertiserIds))?this.window.performance.now():void 0,durationVisibleSum:0,refreshCallback:i}),this.intersectionObserver&&(s.targetOverride||this.useIntersectionObserver)&&this.intersectionObserver.observe(s.target)}}setUpdateTimer(e){e?this.visibilityUpdateTimer=this.window.setInterval(()=>this.updateAdVisibilityDuration(),Re.updateVisibilityInterval):(this.window.clearInterval(this.visibilityUpdateTimer),this.visibilityUpdateTimer=void 0)}updateAdVisibilityDuration(){this.visibilityRecords.forEach(e=>{var i;if(e.latestStartVisible){let r=this.window.performance.now(),o=Math.round(r-e.latestStartVisible);e.durationVisibleSum+=o,e.latestStartVisible=r,(i=this.logger)==null||i.debug("AdVisibilityService",`added ${o}ms visibility to ${e.slot.getSlotElementId()}, now totalling at ${e.durationVisibleSum}ms`)}}),Array.from(this.visibilityRecords.values()).filter(e=>{let i=this.refreshIntervalOverrides[e.slot.getSlotElementId()]||this.refreshInterval;return e.durationVisibleSum>i}).forEach(e=>{var i;(i=this.logger)==null||i.debug("AdVisibilityService",`refreshing ad ${e.slot.getSlotElementId()} after ${e.durationVisibleSum}ms visibility`),e.latestStartVisible=this.window.performance.now(),e.durationVisibleSum=-Re.consecutiveDurationToRefresh,e.refreshCallback(e.slot)})}handleObservedAdVisibilityChanged(e){e.forEach(i=>{var o;let r=this.visibilityRecordForEntry(i);r&&((o=this.logger)==null||o.debug("AdVisibilityService",`Visibility of slot ${r.slot.getSlotElementId()} changed. Visible area: ${i.intersectionRatio*100}%`),this.updateVisibilityRecord(r,i.intersectionRatio))})}handleUserActivityChanged(e){this.visibilityRecords.forEach(i=>{i.latestStartVisible&&(i.latestStartVisible=this.window.performance.now())}),this.setUpdateTimer(e)}visibilityRecordForEntry(e){return this.visibilityRecords.get(e.target.id)}observedDomElementForSlot(e){let i=e.getSlotElementId(),r=this.viewabilityOverrides[i],o=this.window.document.getElementById(i),n=r&&r.variant==="css"?this.window.document.querySelector(r.cssSelector):null;return n?{target:n,targetOverride:!0,viewabilityOverride:r}:o?{target:o,targetOverride:!1,viewabilityOverride:r}:null}};Re.updateVisibilityInterval=1e3,Re.consecutiveDurationToRefresh=1500;var it=Re;var jn=new Map([["strict",{userActivityDuration:10*1e3,userBecomingInactiveDuration:5*1e3}],["moderate",{userActivityDuration:12*1e3,userBecomingInactiveDuration:8*1e3}],["lax",{userActivityDuration:15*1e3,userBecomingInactiveDuration:12*1e3}]]),Ee=class Ee{constructor(e,i={level:"strict"},r){this.window=e;this.userActivityLevelControl=i;this.logger=r;this.isActive=!0;this.handleUserInteraction=()=>this.userActive();this.handleUserIdle=()=>this.userInactive();this.handleUserBecomingIdle=()=>this.userBecomingInactive();this.handlePageVisibilityChanged=()=>{this.window.document.hidden?this.userInactive():this.userActive()};var o;switch(this.listener=[],this.window.document.addEventListener("visibilitychange",this.handlePageVisibilityChanged),(o=this.logger)==null||o.debug("UserActivityService","initialized"),i.level){case"custom":this.userActivityDuration=i.userActivityDuration,this.userBecomingInactiveDuration=i.userBecomingInactiveDuration;break;default:let{userActivityDuration:n,userBecomingInactiveDuration:s}=jn.get(i.level);this.userActivityDuration=n,this.userBecomingInactiveDuration=s}this.userActive()}addUserActivityChangedListener(e){this.listener.push(e)}userActive(){var e;this.isActive||(this.isActive=!0,this.listener.forEach(i=>i(this.isActive)),(e=this.logger)==null||e.debug("UserActivityService","user has become active")),Ee.observedEvents.forEach(i=>this.window.removeEventListener(i,this.handleUserInteraction)),this.userInactiveTimer&&this.window.clearTimeout(this.userInactiveTimer),this.userBecomingIdleTimer&&this.window.clearTimeout(this.userBecomingIdleTimer),this.userInactiveTimer=this.window.setTimeout(this.handleUserIdle,this.userActivityDuration),this.userBecomingIdleTimer=this.window.setTimeout(this.handleUserBecomingIdle,this.userBecomingInactiveDuration)}userInactive(){var e;this.isActive=!1,Ee.observedEvents.forEach(i=>this.window.addEventListener(i,this.handleUserInteraction)),this.listener.forEach(i=>i(this.isActive)),(e=this.logger)==null||e.debug("UserActivityService","user has become inactive")}userBecomingInactive(){var e;Ee.observedEvents.forEach(i=>this.window.addEventListener(i,this.handleUserInteraction)),(e=this.logger)==null||e.debug("UserActivityService","user will shortly become inactive")}};Ee.observedEvents=["mousemove","touchstart","scroll","keypress"];var rt=Ee;var nt=class{constructor(){this.name="moli-ad-reload";this.description="Moli implementation of an ad reload module.";this.moduleType="ad-reload";this.moduleConfig=null;this.refreshIntervalMs=2e4;this.reloadKeyValue="native-ad-reload";this.initialized=!1;this.initialize=(e,i,r,o)=>{if(e.r==="test"){e.t.info("AdReload","disabled in environment test");return}this.initialized||(e.t.debug("AdReload","initialize moli ad reload module"),this.setupAdVisibilityService(i,e.e,e.t),this.setupSlotRenderListener(i,r,o,e.e,e.t),this.initialized=!0)};this.setupAdVisibilityService=(e,i,r)=>{var o,n,s;this.adVisibilityService=new it(new rt(i,e.userActivityLevelControl,r),(o=e.refreshIntervalMs)!=null?o:this.refreshIntervalMs,(n=e.refreshIntervalMsOverrides)!=null?n:{},!1,!!e.disableAdVisibilityChecks,(s=e.viewabilityOverrides)!=null?s:{},i,r)};this.setupSlotRenderListener=(e,i,r,o,n)=>o.googletag.pubads().addEventListener("slotRenderEnded",s=>{var S;let{slot:a,campaignId:d,advertiserId:u,companyIds:l,yieldGroupIds:c,isEmpty:p}=s,g=a.getSlotElementId(),m=i.indexOf(g)>-1,h=!d||e.excludeOrderIds.indexOf(d)===-1,f=!!d&&e.includeOrderIds.indexOf(d)>-1,I=ie(s,e.includeAdvertiserIds),C=!!c&&e.includeYieldGroupIds.some(k=>c.indexOf(k)>-1),R=!p&&m&&h&&(f||I||C);R||this.logTrackingDisallowedReason(g,{slotIsEmpty:p,slotIsMonitored:m,orderIdNotExcluded:h,orderIdIncluded:f,advertiserIdIncluded:I,yieldGroupIdIncluded:C},n,c,d,u);let O=!!((S=this.adVisibilityService)!=null&&S.isSlotTracked(g));R?this.adVisibilityService.trackSlot(a,r,u,l):O&&this.adVisibilityService.removeSlotTracking(a)});this.reloadAdSlot=(e,i)=>r=>{let o=r.getSlotElementId(),n=i.i.slots.find(s=>s.domId===o);if(n&&n.behaviour.loaded!=="infinite"){i.t.debug("AdReload","fired slot reload",n.domId);let s=this.maybeOptimizeSlotForCls(e,n,r,i.t,i.e);r.setTargeting(this.reloadKeyValue,"true");let d=(()=>{var l,c;if(((c=(l=e.viewabilityOverrides)==null?void 0:l[o])==null?void 0:c.refreshBucket)===!0){let p=n.behaviour.loaded,g=n.behaviour.bucket,m=typeof g=="string"?g:g==null?void 0:g[i.u.getDeviceLabel()];return m&&p!=="infinite"?{name:m,loaded:p}:void 0}})();d?i.e.moli.refreshBucket(d.name,{loaded:d.loaded}).then(u=>i.t.debug("AdReload",`refreshBucket '${d.name}' result`,u)).catch(u=>i.t.error("AdReload",`refreshBucket '${d.name}' failed`,u)):i.e.moli.refreshAdSlot(o,v({loaded:n.behaviour.loaded},s&&{sizesOverride:s})).catch(u=>i.t.error("AdReload",`refreshing ${o} failed`,u))}};this.maybeOptimizeSlotForCls=(e,i,r,o,n)=>{let s=i.domId;if(e.optimizeClsScoreDomIds.indexOf(s)>-1){let a=n.document.getElementById(s);if(a&&a.style){let d=a.scrollHeight;a.style.setProperty("height",`${d}px`);let u=i.sizes.filter(l=>l!=="fluid"&&l[1]<=d);return o.debug("AdReload",`CLS optimization: slot ${s} received fixed height ${d}px`,"new sizes:",u),u.length<i.sizes.filter(l=>l!=="fluid").length&&n.googletag.destroySlots([r]),u}o.warn("AdReload",`CLS optimization: slot ${s} to be optimized but not found in DOM.`)}return i.sizes};this.logTrackingDisallowedReason=(e,i,r,o,n,s)=>{let{slotIsEmpty:a,slotIsMonitored:d,orderIdNotExcluded:u,orderIdIncluded:l,advertiserIdIncluded:c,yieldGroupIdIncluded:p}=i;a&&r.debug("AdReload",e,"slot not tracked: reported empty"),d||r.debug("AdReload",e,"slot not tracked: excluded by DOM id"),u||r.debug("AdReload",e,"slot not tracked: excluded by order id",n),l||c||p||r.debug("AdReload",e,"slot not tracked: neither order id",n,"nor advertiser id",s,"nor yieldGroup id",o,"included")}}i(){return this.moduleConfig}isInitialized(){return this.initialized}o(e){var i;(i=e==null?void 0:e.adReload)!=null&&i.enabled&&(this.moduleConfig=e.adReload)}s(){return[]}a(){let e=this.moduleConfig;return e?[W(this.name,i=>{let r=i.i.slots.filter(n=>e.excludeAdSlotDomIds.indexOf(n.domId)===-1).map(n=>n.domId).filter(G),o=this.reloadAdSlot(e,i);return i.t.debug("AdReload","monitoring slots",r),this.initialize(i,e,r,o),Promise.resolve()})]:[]}d(){return[]}};window.moli.registerModule(new nt);var Xi=(t,e)=>i=>{switch(i.matchType){case"exact":return t===i.pattern;case"contains":return t.indexOf(i.pattern)>-1;case"regex":try{return RegExp(i.pattern).test(t)}catch(r){return e.error(`Invalid regex pattern: ${i.pattern}`,r),!1}default:return!1}},Ji=(t,e,i)=>t.urls.some(Xi(e,i)),Qi=()=>{let t=null,e=null,i=()=>t,r=u=>{u!=null&&u.blocklist&&u.blocklist.enabled&&(t=u.blocklist)},o=(u,l,c)=>{switch(u.provider){case"static":return()=>Promise.resolve(u.blocklist);case"dynamic":let p;return()=>(p||(p=n(l,u.endpoint,3).catch(g=>(c.error("Blocklist URLs","Fetching blocklisted urls failed",g),{urls:[]}))),p)}},n=(u,l,c,p=null)=>c<=0?Promise.reject(p):(e||(e=u.loadJson("blocklist-urls.json",l).catch(g=>new Promise(h=>setTimeout(h,100/c)).then(()=>n(u,l,c-1,g)))),e);return{name:"Blocklist URLs",description:"",moduleType:"policy",i,o:r,s:()=>t?[z("blocklist-urls-init",u=>{switch(t==null?void 0:t.mode){case"key-value":let l=t.key,c=t.isBlocklistedValue||"true";return o(t.blocklist,u.c,u.t)().then(p=>{Ji(p,u.e.location.href,u.t)&&u.e.googletag.pubads().setTargeting(l,c)});case"block":return o(t.blocklist,u.c,u.t)().then(p=>{if(u.t.debug("Blocklist URLs","using blocklist",p),Ji(p,u.e.location.href,u.t))return Promise.reject("blocklisted url found. Abort ad pipeline run")});default:return Promise.resolve()}})]:[],a:()=>{let u=t;return u?[W("blocklist-labels",l=>Ne(void 0,null,function*(){var g;let c=yield o(u.blocklist,l.c,l.t)(),p=Xi(l.e.location.href,l.t);(g=c.labels)==null||g.forEach(m=>{(m.reverseMatch===!0?!p(m):p(m))&&l.u.addLabel(m.label)})}))]:[]},d:()=>[]}};window.moli.registerModule(Qi());var ot=class{constructor(){this.name="cleanup";this.description="cleanup out-of-page formats on navigation or ad-reload";this.moduleType="creatives";this.cleanupConfig=null;this.cleanUp=(e,i)=>{i.forEach(r=>{"cssSelectors"in r.deleteMethod?r.deleteMethod.cssSelectors.forEach(o=>{let n=e.e.document.querySelectorAll(o);e.t.debug("Cleanup Module",`Remove elements with selector ${o} from dom`,n),n.forEach(s=>{try{s.remove()}catch(a){e.t.error("Cleanup Module",`Error removing element with selector ${o}`,a)}})}):r.deleteMethod.jsAsString.forEach(o=>{try{e.t.debug("Cleanup Module",`Try to execute string as JS: '${o}'`),new Function(o)()}catch(n){e.t.error("Cleanup Module",`Error executing JS string: '${o}'`,n)}})})};this.hasBidderWonLastAuction=(e,i)=>{var n;return((n=e.e.pbjs.getAllWinningBids().filter(s=>s.adUnitCode===i.domId).at(-1))==null?void 0:n.bidder)===i.bidder}}o(e){e!=null&&e.cleanup&&e.cleanup.enabled&&(this.cleanupConfig=e.cleanup)}i(){return this.cleanupConfig}s(){return[]}a(){let e=this.cleanupConfig;return e?[te("destroy-out-of-page-ad-format",i=>(i.l.environment==="test"||i.e.pbjs.que.push(()=>{let r=e.configs.filter(o=>this.hasBidderWonLastAuction(i,o));this.cleanUp(i,r)}),Promise.resolve()))]:[]}d(){let e=this.cleanupConfig;return e?[$("cleanup-before-ad-reload",Ke,(i,r)=>(i.l.environment==="test"||i.e.pbjs.que.push(()=>{let o=e.configs.filter(n=>r.map(s=>s.moliSlot.domId).includes(n.domId)).filter(n=>this.hasBidderWonLastAuction(i,n));this.cleanUp(i,o)}),Promise.resolve()))]:[]}};window.moli.registerModule(new ot);var st=class{constructor(){this.name="confiant";this.description="ad fraud detection and protection module";this.moduleType="ad-fraud";this.gvlid="56";this.confiantConfig=null}i(){return this.confiantConfig}o(e){e!=null&&e.confiant&&e.confiant.enabled&&(this.confiantConfig=e.confiant)}s(){let e=this.confiantConfig;return e?[z("confiant-init",i=>this.loadConfiant(i,e))]:[]}loadConfiant(e,i){var r;return e.r==="test"||e.n.gdprApplies&&(!e.n.purpose.consents[1]||!(!((r=this.confiantConfig)!=null&&r.checkGVLID)||e.n.vendor.consents[this.gvlid]))||e.c.loadScript({name:this.name,loadMethod:1,assetUrl:i.assetUrl}).catch(o=>e.t.error("failed to load confiant",o)),Promise.resolve()}a(){return[]}d(){return[]}};window.moli.registerModule(new st);var Le="custom",zn=(t,e)=>{if(t.r==="test"||!e.consent)return!0;switch(e.consent.cmpApi){case"tcf":return!t.n.gdprApplies||t.n.vendor.consents[e.consent.vendorId]}},Zi=()=>{let t=null,e=(i,r)=>{var o,n;if(r.inlineJs&&r.inlineJs.code)try{let s=i.e.document.createElement("script");s.type="text/javascript",s.innerHTML=r.inlineJs.code,i.e.document.head.appendChild(s),(o=i.t)==null||o.info(Le,"Injected inline JS")}catch(s){(n=i.t)==null||n.error(Le,"Failed to inject inline JS",s)}return r.scripts&&r.scripts.filter(s=>i.u.filterSlot(s)&&zn(i,s)).forEach(s=>{var a,d;try{let u=i.e.document.createElement("script");u.type="text/javascript",u.src=s.src,s.attributes&&Object.entries(s.attributes).forEach(([l,c])=>{u.setAttribute(l,c)}),i.e.document.head.appendChild(u),(a=i.t)==null||a.info(Le,`Injected script from URL: ${s.src}`)}catch(u){(d=i.t)==null||d.error(Le,"Failed to inject script from config",s,u)}}),Promise.resolve()};return{name:Le,description:"Injects custom inline JavaScript code",moduleType:"custom",i:()=>null,o:i=>{var r;(r=i==null?void 0:i.custom)!=null&&r.enabled&&(t=i.custom)},s:()=>{let i=t;return i?[z("custom-init",r=>e(r,i))]:[]},a:()=>[],d:()=>[]}};window.moli.registerModule(Zi());var Fn=(t,e)=>{var r;let i=(r=t.i.targeting)==null?void 0:r.keyValues[e];return i?`&device_id=${typeof i=="string"?i:i[0]}`:""},er=(t,e,i,r,o)=>{let n=Fn(t,e.advertiserIdKey),s=t.n.gdprApplies?`gdpr=1&gdpr_consent=${t.n.tcString}`:"gdpr=0",a=e.linkOrKeyword.link?`&link=${encodeURIComponent(e.linkOrKeyword.link)}`:"",d=e.linkOrKeyword.keywords?`&keywords=${encodeURIComponent(e.linkOrKeyword.keywords)}`:"",u="",l=v(v({},e.additionalIdentifier),i);Object.entries(l).forEach(([m,h])=>{u+=`&${m}=${encodeURIComponent(h)}`});let c="",p=v(v({},e.customKeywords),r);Object.entries(p).forEach(([m,h])=>{c+=`&${m}=${encodeURIComponent(h)}`});let g=o.createElement("img");g.src=`https://aps.xplosion.de/data?sid=${e.sid}${n}&os=${e.os}&app_id=${e.appId}${d}${a}${u}${c}&${s}`,g.width=1,g.height=1,o.body.append(g)};var Gn=(t,e)=>{var r;if(e.os==="web")return;let i=(r=t.i.targeting)==null?void 0:r.keyValues[e.advertiserIdKey];if(i)return typeof i=="string"?i:i[0]},tr=(t,e,i)=>{try{let o="moli_emetriq",n=t.getItem(o),s=n?Number.parseInt(n,10):0,a=e-864e5>s;return a&&(t.setItem(o,e.toString()),i.debug("emetriq",`eligible for login event tracking. Last tracked at ${new Date(s)}`)),a}catch(r){return i.error("emetriq","could not access session storage",r),!1}},ir=(t,e,i,r)=>{var u,l;if(!e.login){r.warn("emetriq","login configuration missing!");return}let o=new URL(`https://xdn-ttp.de/lns/import-event-${e.login.partner}`),n=(l=(u=t.l.audience)==null?void 0:u.hem)==null?void 0:l.sha256,s=n!==void 0?t.e.btoa(n):e.login.guid;if(s===void 0){r.warn("emetriq","no guid provided for login event tracking");return}o.searchParams.append("guid",s),t.n.gdprApplies?(o.searchParams.append("gdpr","1"),o.searchParams.append("gdpr_consent",t.n.tcString)):o.searchParams.append("gdpr","0");let a=Gn(t,e);if(a)switch(e.os){case"android":o.searchParams.append("adid",a);break;case"ios":o.searchParams.append("idfa",a);break}let d=i.createElement("img");d.src=o.href,d.width=1,d.height=1,i.body.append(d)};var at=class t{constructor(){this.name="emetriq";this.description="Provides Emetriq data collection functionality to Moli.";this.moduleType="dmp";this.gvlid="213";this.emetriqConfig=null}i(){return this.emetriqConfig}o(e){e!=null&&e.emetriq&&e.emetriq.enabled&&(this.emetriqConfig=e.emetriq)}s(){let e=this.emetriqConfig;return e?[z("load-emetriq",i=>{var o;let r=t.staticCustomParams(v(v({},(o=i.i.targeting)==null?void 0:o.keyValues),i.l.keyValues),e.customMappingDefinition);return i.r==="test"||this.checkIfConsentIsMissing(i)||t.syncDelay(i,e.syncDelay).then(n=>{switch(e.os){case"web":this.loadEmetriqScript(i,e,n,r);break}}),Promise.resolve()})]:[]}a(){let e=this.emetriqConfig;return e?[te("track-emetriq",i=>{var o;let r=t.staticCustomParams(v(v({},(o=i.i.targeting)==null?void 0:o.keyValues),i.l.keyValues),e.customMappingDefinition);return i.r==="test"||this.checkIfConsentIsMissing(i)||(e.login&&tr(i.e.sessionStorage,Date.now(),i.t)&&ir(i,e,i.e.document,i.t),t.syncDelay(i,e.syncDelay).then(n=>{switch(e.os){case"android":case"ios":er(i,e,n,r,i.e.document);break}})),Promise.resolve()})]:[]}d(){return[]}checkIfConsentIsMissing(e){return e.n.gdprApplies&&!e.n.vendor.consents[this.gvlid]?(e.t.warn(this.name,"missing consent"),!0):!1}loadEmetriqScript(e,i,r,o){let n=e.e;return n._enqAdpParam=v(v(v({},i._enqAdpParam),r),o),e.c.loadScript({name:this.name,loadMethod:1,assetUrl:`https://ups.xplosion.de/loader/${i._enqAdpParam.sid}/default.js`}).catch(s=>e.t.error("failed to load emetriq",s))}static syncDelay(e,i){return i?typeof i=="number"?new Promise(r=>e.e.setTimeout(()=>r({}),i)):e.e.pbjs?new Promise(r=>{e.e.pbjs.que.push(()=>{let o=()=>{r(t.prebidIdentifiers(e)),e.e.pbjs.offEvent("auctionEnd",o)};e.e.pbjs.onEvent("auctionEnd",o)})}):(e.t.error("emetriq","No sync delay, because window.pbjs is not defined!"),Promise.resolve({})):Promise.resolve({})}static staticCustomParams(e,i){let r={};return(i!=null?i:[]).forEach(({param:o,key:n})=>{let s=e[n];s&&(r[o]=typeof s=="string"?s:s.join(","))}),r}static prebidIdentifiers(e){let i={},r=e.e.pbjs.getUserIds();return r.amxId&&(i.id_amxid=r.amxId),r.idl_env&&(i.id_liveramp=r.idl_env),r.IDP&&(i.id_zeotap=r.IDP),r.pubcid&&(i.id_sharedid=r.pubcid),r.id5id&&(i.id_id5=r.id5id.uid),i}};window.moli.registerModule(new at);var Et="geoedge",Wn="845",rr=()=>{let t=null,e=(i,r)=>i.r==="test"?Promise.resolve():i.n.gdprApplies&&(!i.n.purpose.consents[1]||!(!r.checkGVLID||i.n.vendor.consents[Wn]))?(i.t.warn(Et,"no gdpr consent, geoedge will not be loaded"),Promise.resolve()):(i.e.grumi={key:r.key,cfg:r.cfg},i.c.loadScript({name:Et,loadMethod:1,assetUrl:`https://rumcdn.geoedge.be/${r.key}/grumi-ip.js`}).catch(o=>i.t.error("failed to load geoedge",o)),Promise.resolve());return{name:Et,description:"ad fraud detection and protection module",moduleType:"ad-fraud",i:()=>null,o:i=>{i!=null&&i.geoedge&&i.geoedge.enabled&&(t=i.geoedge)},s:()=>{let i=t;return i?[z("geoedge-init",r=>e(r,i))]:[]},a:()=>[],d:()=>[]}};window.moli.registerModule(rr());var dt=class{constructor(){this.name="identitylink";this.description="Provides LiveRamp's ATS (authenticated traffic solution) functionality to Moli.";this.moduleType="identity";this.gvlid="97";this.identityLinkConfig=null}i(){return this.identityLinkConfig}o(e){e!=null&&e.identitylink&&e.identitylink.enabled&&(this.identityLinkConfig=e.identitylink)}s(){let e=this.identityLinkConfig;return e?[z(this.name,i=>(this.loadAts(i,e),Promise.resolve()))]:[]}a(){return[]}d(){return[]}loadAts(e,i){if(e.r==="test"||e.n.gdprApplies&&!e.n.vendor.consents[this.gvlid])return Promise.resolve();let r=e.e;return r.addEventListener("envelopeModuleReady",()=>{var d,u,l,c,p,g;let o=[...i.hashedEmailAddresses],n=(u=(d=e.l.audience)==null?void 0:d.hem)==null?void 0:u.sha1,s=(c=(l=e.l.audience)==null?void 0:l.hem)==null?void 0:c.sha256,a=(g=(p=e.l.audience)==null?void 0:p.hem)==null?void 0:g.md5;n!==void 0&&(o[0]=n),s!==void 0&&(o[1]=s),a!==void 0&&(o[2]=a),r.atsenvelopemodule.setAdditionalData({type:"emailHashes",id:o})}),e.c.loadScript({name:this.name,loadMethod:1,assetUrl:`https://launchpad-wrapper.privacymanager.io/${i.launchPadId}/launchpad-liveramp.js`}).catch(o=>e.t.error("failed to load emetriq",o))}};window.moli.registerModule(new dt);var nr=t=>{let e=t.filter(r=>r.behaviour.loaded==="infinite");return{configuredInfiniteSlots:e,findSlot:r=>{let o=r.getAttribute("data-h5-slot-dom-id");return{configuredInfiniteSlot:o?e.find(s=>s.domId===o):e[0],configSlotDomId:o}}}};var or=()=>{let t=!1,e=[],i=null,r="moli-lazy-load",o="Moli implementation of an ad lazy load module.",n="lazy-load",s=()=>i,a=p=>{p!=null&&p.lazyload&&p.lazyload.enabled&&(i=p.lazyload)},d=()=>[],u=()=>{let p=i;return p?[te("lazy-module-configuration",g=>(t=!1,e.forEach(m=>m.disconnect()),e.length=0,c(g,p),Promise.resolve()))]:[]},l=()=>[$("lazy-module-delay",J,(p,g)=>new Promise((m,h)=>{var I,C,R;let f=(C=(I=p.S)==null?void 0:I.options)==null?void 0:C.delay;if(f){(R=p.t)==null||R.debug(r,"delaying slots",g);let O=new Promise(k=>{p.e.addEventListener("h5v.trigger-delay",()=>k(!0),{once:!0})}),S=new Promise(k=>{var A;p.e.setTimeout(()=>k(!1),(A=f.timeoutMs)!=null?A:3e4)});return Promise.race([O,S]).then(k=>k?m():h(new Error("Delay timeout exceeded")))}else m()}))],c=(p,g)=>{var O;if(t)return;t=!0,(O=p.t)==null||O.debug(r,"initialize moli lazy load module");let m=g.slots,h=g.buckets,f=g.infiniteSlots,I=p.e;m.forEach(S=>{let k=new I.IntersectionObserver(A=>{var y;(y=p.t)==null||y.debug(r,"lazy-load slots called with",A),A.forEach(E=>{var P;E.isIntersecting&&((P=p.t)==null||P.debug(r,`Trigger ad slot with DOM ID ${E.target.id}`),I.moli.refreshAdSlot(E.target.id),k.unobserve(E.target))})},{root:S.options.rootId?I.document.getElementById(S.options.rootId):null,threshold:S.options.threshold,rootMargin:S.options.rootMargin});e.push(k),S.domIds.forEach(A=>{var E,P;let y=p.i.slots.find(T=>T.domId===A);if(!y)(E=p.t)==null||E.warn(r,`Lazy-load non-existing slot with domID ${A}`);else if(y.behaviour.loaded!=="manual")(P=p.t)==null||P.warn(r,`Lazy-load configured for slot without manual loading behaviour. ${A}`);else if(y.behaviour.loaded==="manual"){let T=I.document.getElementById(A);T&&k.observe(T)}})}),h.forEach(S=>{var A,y,E,P;let k=new I.IntersectionObserver(T=>{T.forEach(U=>{var D,re,b;if(U.isIntersecting&&U.target.id===S.observedDomId)if(((D=p.i.slots.find(q=>q.domId===S.observedDomId))==null?void 0:D.behaviour.bucket)!==S.bucket)(re=p.t)==null||re.warn(r,`${S.observedDomId} doesn't belong to ${S.bucket}`);else{let q=p.i.slots.filter(_=>_.behaviour.bucket===S.bucket).map(_=>_.domId);(b=p.t)==null||b.debug(`Refresh ${S.bucket}`,`Trigger ad slots with DOM IDs [${q.join(", ")}]`),I.moli.refreshBucket(S.bucket),k.unobserve(U.target)}})},{root:S.options.rootId?I.document.getElementById(S.options.rootId):null,threshold:S.options.threshold,rootMargin:S.options.rootMargin});if(e.push(k),(A=p.i.buckets)!=null&&A.enabled||(y=p.t)==null||y.warn(r,"GlobalBucket config isn't enabled"),!((E=p.i.buckets)!=null&&E.bucket&&p.i.buckets.bucket[S.bucket]))(P=p.t)==null||P.error(r,`Lazy-load non-existing bucket with name ${S.bucket}`);else{let T=I.document.getElementById(S.observedDomId);T&&k.observe(T)}});let{configuredInfiniteSlots:C,findSlot:R}=nr(p.i.slots);(f||[]).forEach(S=>{var A;let k="data-h5-serial-number";if(C.length>0){let y=new I.IntersectionObserver(P=>{P.forEach(T=>{var U,D,re,b;if(T.isIntersecting){let{configuredInfiniteSlot:M,configSlotDomId:q}=R(T.target);if(M){let _=(D=(U=T.target.attributes)==null?void 0:U.getNamedItem(k))==null?void 0:D.value,N=`${M.domId}-${_}`;T.target.setAttribute("id",N),(re=p.t)==null||re.debug(r,`Trigger ad slot with newly created DOM ID ${N}`),I.moli.refreshInfiniteAdSlot(N,M.domId),y.unobserve(T.target)}else(b=p.t)==null||b.error(r,`No infinite-scrolling slot configured for ${q}`),y.unobserve(T.target)}})},{root:S.options.rootId?I.document.getElementById(S.options.rootId):null,threshold:S.options.threshold,rootMargin:S.options.rootMargin});e.push(y),I.document.querySelectorAll(S.selector).forEach((P,T)=>{P.setAttribute(k,`${T+1}`),P&&y.observe(P)})}else(A=p.t)==null||A.warn(r,"No infinite-scrolling slots configured!")})};return{name:r,description:o,moduleType:n,i:s,o:a,s:d,a:u,d:l,registerIntersectionObservers:c}};window.moli.registerModule(or());var lt=class t{constructor(){this.description="Module for passing first party data to prebid auctions";this.moduleType="prebid";this.name="prebid-first-party-data";this.moduleConfig=null;this._configureSteps=[]}i(){return this.moduleConfig}o(e){var i;if((i=e==null?void 0:e.prebidFirstPartyData)!=null&&i.enabled){let r=e.prebidFirstPartyData;this._configureSteps=[W("prebid-fpd-module-configure",o=>t.setPrebidFpdConfig(o,r,o.t))]}}s(){return[]}a(){return this._configureSteps}d(){return[]}static setPrebidFpdConfig(e,i,r){var o;if(e.i.prebid){let n=((o=e.i.targeting)==null?void 0:o.keyValues)||{},s=i.gptTargetingMappings;e.e.pbjs.que.push(()=>{var u,l,c,p,g,m,h,f,I;let a=e.e.pbjs.readConfig().ortb2||{},d=Ze({},i.staticPrebidFirstPartyData,a);if(s){let C=v({cat:[],sectioncat:[],pagecat:[]},d.site);if(s.cat){let O=t.extractKeyValueArray(s.cat,n);(u=C.cat)==null||u.push(...O),(l=C.pagecat)==null||l.push(...O),(c=C.sectioncat)==null||c.push(...O)}s.sectionCat&&(C.sectioncat=t.extractKeyValueArray(s.sectionCat,n)),s.pageCat&&(C.pagecat=t.extractKeyValueArray(s.pageCat,n)),C.cat&&(C.cat=C.cat.filter(Z)),C.sectioncat&&(C.sectioncat=C.sectioncat.filter(Z)),C.pagecat&&(C.pagecat=C.pagecat.filter(Z));let R=(p=i.iabDataProviderName)!=null?p:he(e.e.location.hostname);if(!i.iabDataProviderName&&(s.iabV2||s.iabV3)&&r.debug("PrebidFirstPartyDataModule","Targeting for iabV2 or iabV3 was defined, but iabDataProviderName was not configured. Use tld as fallback",R),C.content=w(v({},C.content),{data:(h=(m=(g=C.content)==null?void 0:g.data)==null?void 0:m.filter(O=>O.name!==R))!=null?h:[]}),s.iabV2&&R){let O=t.extractKeyValueArray(s.iabV2,n),S={name:R,ext:{segtax:6},segment:O.map(k=>({id:k})).filter(Z)};(f=C.content.data)==null||f.push(S)}if(s.iabV3&&R){let O=t.extractKeyValueArray(s.iabV3,n),S={name:R,ext:{segtax:7},segment:O.map(k=>({id:k})).filter(Z)};(I=C.content.data)==null||I.push(S)}d.site=C}e.e.pbjs.setConfig({ortb2:d})})}return Promise.resolve()}static extractKeyValueArray(e,i){let r=i[e];return r?typeof r=="string"?[r]:r:[]}};window.moli.registerModule(new lt);var ut=class{constructor(){this.name="pubstack";this.description="prebid analytics integration";this.moduleType="reporting";this.pubstackConfig=null}i(){return this.pubstackConfig}o(e){e!=null&&e.pubstack&&e.pubstack.enabled&&(this.pubstackConfig=e.pubstack)}s(){let e=this.pubstackConfig;return e?[z("pubstack-init",i=>(i.r==="test"||i.c.loadScript({name:"pubstack",loadMethod:1,assetUrl:`https://boot.pbstck.com/v1/tag/${e.tagId}`}).catch(r=>i.t.error("failed to load pubstack",r)),Promise.resolve()))]:[]}a(){return this.pubstackConfig?[W("pubstack-configure",i=>{if(i.r==="test")return Promise.resolve();let r=["0","1","2","3"],o=i.e.document.head.querySelector('meta[name="pbstck_context:pbstck_ab_test"]');return o&&o.content&&r.includes(o.content)&&i.e.googletag.pubads().setTargeting("pbstck_ab_test",o.content),Promise.resolve()})]:[]}d(){return[]}};window.moli.registerModule(new ut);var ar="footer-ad-close-button",$n="[data-ref=h5-footer-ad-container]",Hn=`[data-ref=${ar}]`,pt={adSlot:"h5-footer-ad",container:"h5-footer-ad-container",footerAdClose:"h5-footer-ad-close",isShiftedBottom:"is-shifted-bottom"},sr=(t,e,i,r)=>o=>{let n=o.slot,s=t.document.body.querySelector($n),a=t.document.getElementById(e),d=()=>{var l;n.getSlotElementId()===e&&s&&((l=t.googletag)==null||l.destroySlots([n]),s.remove())};if(!s||!a||n.getSlotElementId()!==e||o.isEmpty||ie(o,i)||t.matchMedia("(max-width: 767px)").matches){r.debug("[footer-ad]","remove footer ad container");return}if(t.document.body.querySelector(Hn))return;let u=document.createElement("button");u.classList.add(pt.footerAdClose),u.setAttribute("aria-label","Anzeige entfernen"),u.setAttribute("data-ref",ar),a.classList.add(pt.adSlot),Array.isArray(o.size)&&o.size[1]>200&&t.matchMedia("(max-height: 800px)").matches&&a.classList.add(pt.isShiftedBottom),s.classList.add(pt.container),s.style.setProperty("display","block"),s.appendChild(u),u.addEventListener("click",()=>d())},dr=(t,e,i,r,o)=>{e==="production"?t.googletag.pubads().addEventListener("slotRenderEnded",sr(t,r,o,i)):sr(t,r,o,i)({advertiserId:1,size:[728,90],isEmpty:!1,slot:{getSlotElementId:()=>r}})};var lr="[data-ref=sticky-ad]",ur="[data-ref=sticky-ad-close]",gr="h5-sticky-ad--visible",Mt=t=>{t.style.setProperty("display","none"),t.classList.remove(gr)},pr=t=>{t.style.setProperty("display","block"),t.classList.add(gr)},cr=(t,e,i,r)=>new Promise(o=>{let n=s=>{s.slot.getSlotElementId()===e&&(s.isEmpty?(t&&Mt(t),o("empty")):ie(s,i)?o("disallowed"):o("standard"),r.googletag.pubads().removeEventListener("slotRenderEnded",n))};r.googletag.cmd.push(()=>{r.googletag.pubads().addEventListener("slotRenderEnded",n)})}),mr=(t,e)=>new Promise(i=>{let r=o=>{o.slot.getSlotElementId()===t&&(i(),e.googletag.pubads().removeEventListener("slotOnload",r))};e.googletag.pubads().addEventListener("slotOnload",r)}),fr=(t,e,i,r,o,n)=>{let s=t.document.querySelector(lr),a=t.document.querySelector(ur);if(s&&a){if(i.debug("mobile-sticky-ad","Running initAdSticky with defined sticky container and close button"),n||pr(s),a.addEventListener("click",()=>{Mt(s);let d=t.googletag.pubads().getSlots().find(u=>u.getSlotElementId()===r);d&&t.googletag.destroySlots([d])},{once:!0,passive:!0}),e==="production"){let d=([u])=>(i.debug("mobile-sticky-ad",`result ${u}`),u==="disallowed"?(i.debug("mobile-sticky-ad","hide mobile sticky container"),s&&Mt(s),Promise.resolve()):u==="standard"?(n&&pr(s),Promise.all([cr(s,r,o,t),mr(r,t)]).then(d)):Promise.resolve());Promise.all([cr(s,r,o,t),mr(r,t)]).then(d)}}else i.warn("[mobile-sticky]",`Could not find adSticky container ${lr} or closeButton ${ur}`,s,a)};var ct=class{constructor(){this.name="sticky-footer-ads";this.description="sticky footer ad creatives";this.moduleType="creatives";this.stickyFooterAdConfig=null}i(){return this.stickyFooterAdConfig}o(e){var i;(i=e==null?void 0:e.stickyFooterAd)!=null&&i.enabled&&(this.stickyFooterAdConfig=e.stickyFooterAd)}d(){let e=this.stickyFooterAdConfig;return e?[$(this.name,J,(i,r)=>{var o;return e.mobileStickyDomId&&r.some(n=>{var s;return n.moliSlot.domId===((s=this.stickyFooterAdConfig)==null?void 0:s.mobileStickyDomId)})&&fr(i.e,i.r,i.t,e.mobileStickyDomId,e.disallowedAdvertiserIds,(o=e.initiallyHidden)!=null?o:!1),e.desktopFloorAdDomId&&r.some(n=>n.moliSlot.domId===e.desktopFloorAdDomId)&&dr(i.e,i.r,i.t,e.desktopFloorAdDomId,e.disallowedAdvertiserIds),Promise.resolve()})]:[]}a(){return[]}s(){return[]}};window.moli.registerModule(new ct);var Tt="[data-ref=h5v-sticky-ad]",xt="[data-ref=h5v-sticky-ad-close]",yr=".h5v-closeButtonContent",hr="h5v-footerAd--hidden",Kn="h5v-footerAd--hidden-d",Yn="h5v-footerAd--hidden-m",br=(t,e,i)=>new Promise(r=>{let o=n=>{n.slot.getSlotElementId()===t&&(n.isEmpty?r("empty"):ie(n,e)?r("disallowed"):r("standard"),i.googletag.pubads().removeEventListener("slotRenderEnded",o))};i.googletag.cmd.push(()=>{i.googletag.pubads().addEventListener("slotRenderEnded",o)})}),Ir=(t,e)=>new Promise(i=>{let r=o=>{o.slot.getSlotElementId()===t&&(i(),e.googletag.pubads().removeEventListener("slotOnload",r))};e.googletag.pubads().addEventListener("slotOnload",r)}),vr=t=>{t.classList.add(hr)},Jn=t=>{t.classList.remove(hr,Kn,Yn)},Sr=(t,e,i,r,o,n)=>{let s="sticky-ad",a=t.document.querySelector(Tt),d=t.document.querySelector(xt),u=t.document.querySelector(yr);if(a&&d){if(i.debug(s,"Running initAdSticky with defined sticky container and close button"),!u){if(n)d.textContent=n;else if(!d.querySelector("svg")){let c=t.document.createElementNS("http://www.w3.org/2000/svg","svg");c.setAttribute("width","24"),c.setAttribute("height","24");let p=t.document.createElementNS("http://www.w3.org/2000/svg","path");p.classList.add(yr),p.setAttribute("d","M7 10l5 5 5-5z"),c.appendChild(p),d.appendChild(c)}}d.addEventListener("click",()=>{a.addEventListener("transitionend",function(){var p;a.remove();let c=(p=t.googletag)==null?void 0:p.pubads().getSlots().find(g=>g.getSlotElementId()===r);c&&t.googletag.destroySlots([c])},{once:!0}),vr(a)});let l=c=>{if(i.debug(s,`result ${c}`),c==="disallowed"||c==="empty")return i.debug(s,"stickyFooter container"),vr(a),Promise.resolve();if(c==="standard"){Jn(a);let p=Ir(r,t);return br(r,o,t).then(g=>g==="empty"||g==="disallowed"?Promise.resolve(g):p.then(()=>g)).then(l)}return Promise.resolve()};if(e==="production")if(r){let c=Ir(r,t);br(r,o,t).then(p=>p==="empty"||p==="disallowed"?Promise.resolve(p):c.then(()=>p)).then(l)}else i.warn("[sticky-footer-ad]",`Could not find adSticky container ${Tt} or closeButton ${xt}`,a,d);else l("standard")}else i.warn("[sticky-footer-ad]",`Could not find adSticky container ${Tt} or closeButton ${xt}`,a,d)};var mt=class{constructor(){this.name="sticky-footer-ads-v2";this.description="sticky footer ad creatives";this.moduleType="creatives";this.stickyFooterAdConfig=null}i(){return this.stickyFooterAdConfig}o(e){e!=null&&e.stickyFooterAdV2&&e.stickyFooterAdV2.enabled&&(this.stickyFooterAdConfig=e.stickyFooterAdV2)}d(){let e=this.stickyFooterAdConfig;return e?[$(this.name,J,(i,r)=>{let o=r.find(a=>a.moliSlot.domId===e.stickyFooterDomIds.desktop),n=r.find(a=>a.moliSlot.domId===e.stickyFooterDomIds.mobile),s=n||o;return n&&o&&i.t.warn(this.name,"mobile and desktop sticky footer are called!"),s&&Sr(i.e,i.r,i.t,s.moliSlot.domId,e.disallowedAdvertiserIds,e.closingButtonText),Promise.resolve()})]:[]}a(){return[]}s(){return[]}};window.moli.registerModule(new mt);var Ar=(t,e,i,r,o,n)=>s=>{s.forEach(a=>{e&&a.target===e?i.then(d=>{a.isIntersecting||!a.isIntersecting&&a.boundingClientRect.y<0||d==="empty"||d==="disallowed"?t.classList.add(n):a.boundingClientRect.y>=0&&d==="standard"&&t.classList.remove(n)}):a.target===r&&o&&(a.isIntersecting?t.classList.remove(o):t.classList.add(o))})};var Pr=(t,e,i,r)=>new Promise(o=>{if(t.r==="test"){o("standard");return}let n=s=>{s.slot.getSlotElementId()===e.domId&&(ie(s,i)?o("disallowed"):s.isEmpty?o("empty"):r>0?t.e.setTimeout(()=>o("standard"),r):o("standard"),t.e.googletag.pubads().removeEventListener("slotRenderEnded",n))};t.e.googletag.pubads().addEventListener("slotRenderEnded",n)});var gt=class{constructor(){this.name="sticky-header-ads";this.description="sticky header ad creatives";this.moduleType="creatives";this.containerSelector='[data-ref="header-ad"]';this.buttonSelector='[data-ref="header-ad-close-button"]';this.navbarHiddenClassName="h5v-header-ad--navbarHidden";this.observer=null;this.stickyHeaderAdConfig=null}o(e){var i;(i=e==null?void 0:e.stickyHeaderAd)!=null&&i.enabled&&(this.stickyHeaderAdConfig=e.stickyHeaderAd)}i(){return this.stickyHeaderAdConfig}s(){return[]}a(){return this.stickyHeaderAdConfig?[te("sticky-header-ads:cleanup",()=>(this.observer&&(this.observer.disconnect(),this.observer=null),Promise.resolve()))]:[]}d(){let e=this.stickyHeaderAdConfig;return e?[$(this.name,J,(i,r)=>{var d,u,l;if(this.observer)return Promise.resolve();let o=r.find(c=>c.moliSlot.domId===e.headerAdDomId);if(!o)return Promise.resolve();let n=i.e.document.querySelector(this.containerSelector);if(!n)return i.t.warn(this.name,`Could not find sticky header container with selector '${this.containerSelector}'`),Promise.resolve();let s=(d=e.minVisibleDurationMs)!=null?d:0;if(e.fadeOutTrigger!==!1){let c=(u=e.fadeOutTrigger.options)!=null?u:{rootMargin:"0px"},p=i.e.document.querySelectorAll(e.fadeOutTrigger.selector),g=p.length>0?p.item(0):null,m=e.navbarConfig,h=(l=m==null?void 0:m.navbarHiddenClassName)!=null?l:this.navbarHiddenClassName,f=m?i.e.document.querySelector(m.selector):null;if(g){let I=Pr(i,o.moliSlot,e.disallowedAdvertiserIds,s);this.observer=new IntersectionObserver(Ar(n,g,I,f,h,e.fadeOutClassName),c),this.observer.observe(g),f&&this.observer.observe(f)}else i.t.error(this.name,`No DOM element found for selector ${e.fadeOutTrigger.selector}. Sticky header may never fade out`)}let a=i.e.document.querySelector(this.buttonSelector);return a&&a.addEventListener("click",()=>{n.classList.add(e.fadeOutClassName),this.observer&&this.observer.disconnect(),i.r==="production"&&i.e.googletag.destroySlots([o.adSlot]),e.destroySlot&&n&&n.remove()}),Promise.resolve()})]:[]}};window.moli.registerModule(new gt);var Xn=(t,e)=>{let i=Object.keys(t);return Ie(i.map(r=>v({adSlotId:r},t[r])).filter(r=>e.indexOf(r.adSlotId)>-1).filter(r=>G(r.bids)).map(r=>r.bids.sort((o,n)=>n.cpm-o.cpm).slice(0,1)))},ft=class{constructor(){this.name="skin";this.description="Block other ad slots if a wallpaper has won the auction";this.moduleType="prebid";this.skinModuleConfig=null;this.bidsBackHandler=[];this.getConfigEffect=(e,i,r)=>{let o=i[e.skinAdSlotDomId],n=l=>{let c=e.formatFilter.some(p=>{switch(p.bidder){case"*":return!0;case"gumgum":return l.bidder===At.GumGum&&(p.auid===void 0||typeof l.ad!="string"&&l.ad.auid===p.auid);default:return l.bidder===p.bidder}});return l.cpm>0&&c},s=Xn(i,e.blockedAdSlotDomIds),a=s.reduce((l,c)=>l+c.cpm,0),d=o?o.bids.filter(n).sort((l,c)=>c.cpm-l.cpm):[],u=d.length>0?d[0].cpm>a?"BlockOtherSlots":"BlockSkinSlot":"NoBlocking";return r.debug(this.name,"nonSkinBids",s),r.debug(this.name,"skinBids",d),e.enableCpmComparison?u:d.length>0?"BlockOtherSlots":"NoBlocking"};this.selectConfig=(e,i,r)=>e.configs.map(o=>({skinConfig:o,configEffect:this.getConfigEffect(o,i,r)})).find(({configEffect:o})=>o!=="NoBlocking");this.destroyAdSlot=(e,i)=>r=>{let o=e.map(n=>n.adSlot).filter(n=>n.getSlotElementId()===r);i.googletag.destroySlots(o)};this.runSkinConfigs=e=>(i,r,o)=>{var s;let n=this.selectConfig(e,r,i.t);if(n){let{skinConfig:a,configEffect:d}=n;if(d==="BlockOtherSlots"){if(i.t.debug("SkinModule","Skin configuration applied",a),a.blockedAdSlotDomIds.forEach(this.destroyAdSlot(o,i.e)),a.hideBlockedSlots&&a.blockedAdSlotDomIds.forEach(this.hideAdSlot(i.e,i.t)),a.hideSkinAdSlot&&this.hideAdSlot(i.e,i.t)(a.skinAdSlotDomId),a.hideBlockedSlotsSelector&&i.e.document.querySelectorAll(a.hideBlockedSlotsSelector).forEach(u=>{i.t.debug("SkinModule",`Set display:none for container with selector ${a.hideBlockedSlotsSelector}`),u.style.setProperty("display","none")}),a.targeting)try{i.e.googletag.pubads().setTargeting(a.targeting.key,(s=a.targeting.value)!=null?s:"1")}catch(u){i.t.error("SkinModule",u)}}else a.enableCpmComparison&&(i.t.debug("SkinModule","Skin configuration ignored because cpm was low",a),this.destroyAdSlot(o,i.e)(a.skinAdSlotDomId))}else e.configs.filter(a=>a.destroySkinSlot).map(a=>a.skinAdSlotDomId).filter(Z).forEach(this.destroyAdSlot(o,i.e))};this.hideAdSlot=(e,i)=>r=>{let o=e.document.getElementById(r);try{o&&(i.debug("SkinModule",`Set display:none for ${r}`),o.style.setProperty("display","none"))}catch(n){i.error("SkinModule",`Couldn't set the the wallpaper div ${r} to display:none;`,n)}}}i(){return this.skinModuleConfig}o(e){e!=null&&e.skin&&e.skin.enabled&&(this.skinModuleConfig=e.skin,this.bidsBackHandler.push(this.runSkinConfigs(e.skin)))}s(){return[]}a(){return[]}d(){return[]}I(){return this.bidsBackHandler}};window.moli.registerModule(new ft);var Qn=[x.responses.TCPurpose.STORE_INFORMATION_ON_DEVICE,x.responses.TCPurpose.SELECT_BASIC_ADS,x.responses.TCPurpose.CREATE_PERSONALISED_ADS_PROFILE,x.responses.TCPurpose.SELECT_PERSONALISED_ADS,x.responses.TCPurpose.CREATE_PERSONALISED_CONTENT_PROFILE,x.responses.TCPurpose.SELECT_PERSONALISED_CONTENT,x.responses.TCPurpose.MEASURE_AD_PERFORMANCE,x.responses.TCPurpose.MEASURE_CONTENT_PERFORMANCE,x.responses.TCPurpose.APPLY_MARKET_RESEARCH,x.responses.TCPurpose.DEVELOP_IMPROVE_PRODUCTS,x.responses.TCPurpose.USE_LIMITED_DATA_TO_SElECT_CONTENT],Cr=()=>{let t=null,e=!1,i=(o,n)=>{var d;if(n.r==="test"||e)return Promise.resolve();let s=n.e;if(s.Utiq=s.Utiq?w(v({},s.Utiq),{config:v(v({},s.Utiq.config),o.options)}):{queue:[],config:o.options},s.Utiq.queue=s.Utiq.queue||[],n.n.gdprApplies&&Qn.some(u=>n.n.gdprApplies&&!n.n.purpose.consents[u]))return Promise.resolve();let a=(d=o.delay)!=null&&d.enabled&&o.delay.minAdRequests?o.delay.minAdRequests:0;return n.p.hasMinimumRequestAds(a)?n.c.loadScript({name:"utiq",loadMethod:1,assetUrl:o.assetUrl}).then(()=>{e=!0}).catch(u=>{n.t.error("failed to load utiq",u)}):(n.t.info("Utiq",`not enough ad requests to load Utiq. ${a} required.`),Promise.resolve())},r=o=>{var n,s;return(s=(n=o==null?void 0:o.delay)==null?void 0:n.enabled)!=null?s:!1};return{name:"utiq",description:"user module",moduleType:"identity",i(){return t},o(o){o!=null&&o.utiq&&o.utiq.enabled&&(t=o.utiq)},s(){return t!=null&&t.enabled&&!r(t)?[z("utiq",o=>i(t,o))]:[]},a(){return t!=null&&t.enabled&&r(t)?[te("utiq",o=>i(t,o))]:[]},d(){return[]}}};window.moli.registerModule(Cr());var Rr=t=>{var e;return t?((e=t.dynamicFloorPrices)==null?void 0:e.strategy)!==void 0:!1};var Zn=t=>{if(t.length===0)return null;{let e=Math.max(...t);return Math.round(e*100)}},eo=t=>{if(t.length===0)return null;{let e=Math.min(...t);return Math.round(e*100)}},to=t=>{if(!t||t.length===0)return null;if(t.length===1)return Math.round(t[0]*100);{let e=t.sort()[t.length-2];return Math.round(e*100)}},io=(t,e)=>{switch(t){case"max":return Zn(e);case"min":return eo(e);case"second-highest":return to(e);default:return null}},yt=t=>Math.floor(t),ro=t=>{let e=yt(t.priceInCents),i=yt(t.roundingStepsInCents),r=t.maxPriceRuleInCents!==void 0?yt(t.maxPriceRuleInCents):void 0,o=t.minPriceRuleInCents!==void 0?yt(t.minPriceRuleInCents):void 0,n=Math.floor(e/i)*i;return r!==void 0&&n>r?r:o!==void 0&&n<o?o:n},Er=({strategy:t,previousCpms:e,standardRule:i,roundingStepsInCents:r=5,maxPriceRuleInCents:o=500,minPriceRuleInCents:n=5})=>{let s=Array.isArray(e)?e==null?void 0:e.filter(u=>u>0&&!isNaN(u)):[];if(!s||s.length===0||!t)return i;let a=io(t,s);if(a===null)return i;let d=ro({priceInCents:a,roundingStepsInCents:r,maxPriceRuleInCents:o,minPriceRuleInCents:n});return w(v({},i),{floorprice:d/100,priceRuleId:d})};var Mr=t=>{let e={rules:{},browser:"None"},i=Promise.resolve(e),r=!1,o="mobile",n={},s=(m,h,f,I,C)=>{switch(o=m,n=h,t.provider){case"none":C.warn("YieldOptimizationService","Yield optimization is disabled!"),r=!1,i=Promise.resolve(e);break;case"static":C.warn("YieldOptimizationService","Yield optimization is static!"),r=!0,i=Promise.resolve({rules:t.config.rules,browser:"None"});break;case"dynamic":r=!0;let R=t.excludedAdUnitPaths,S=f.filter(k=>R.indexOf(k)<0).map(k=>K(k,n));i=l(t.configEndpoint,3,S,I).then(k=>(C.info("YieldOptimizationService",`loaded pricing rules for device ${o}`,k),k)).catch(k=>(C.error("YieldOptimizationService","failed to initialize service",k),e));break;default:r=!1,i=Promise.reject("Unknown config provider")}return Promise.resolve()},a=m=>i.then(h=>h.rules[K(m,n)]),d=()=>i.then(m=>m.browser||"None"),u=(m,h,f,I,C)=>{let R=K(m.getAdUnitPath(),n);return i.then(O=>{let S=O.rules[R];if(h==="gam")if(S)if(m.setTargeting("upr_model",S.model||"static"),S.main){m.setTargeting("upr_main","true");let k=C==null?void 0:C.getLastBidCpmsOfAdUnit(m.getSlotElementId());if(k&&(k==null?void 0:k.length)>0&&Rr(I)&&I.dynamicFloorPrices){let{strategy:A,roundingStepsInCents:y,maxPriceRuleInCents:E,minPriceRuleInCents:P}=I.dynamicFloorPrices,T=Er({strategy:A,previousCpms:k,standardRule:S,roundingStepsInCents:y,maxPriceRuleInCents:E,minPriceRuleInCents:P});return f.debug("YieldOptimizationService",`set dynamic price rule id ${T.priceRuleId} for ${R} based on previous bid cpms on same position. Stategy is '${A}'. Main traffic share ${S.main}. Cpm is ${T.floorprice}.`),m.setTargeting("upr_id",T.priceRuleId.toFixed(0)),T}else m.setTargeting("upr_id",S.priceRuleId.toFixed(0))}else f.debug("YieldOptimizationService",`set price rule id ${S.priceRuleId} for ${R}. Main traffic share ${S.main}. cpm is ${S.floorprice}`),m.setTargeting("upr_id",S.priceRuleId.toFixed(0));else r&&f.warn("YieldOptimizationService",`No price rule found for ${R}`);return S})},l=(m,h,f,I,C=null)=>h<=0?Promise.reject(C):I(m,{method:"POST",mode:"cors",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify({device:o,key:"adUnitPath",adUnitPaths:f})}).then(R=>R.ok?R.json():R.text().then(O=>Promise.reject(`${R.statusText}: ${O}`))).then(R=>typeof R!="object"||R===null?Promise.reject("Invalid response"):c(R)?g(R.rules)?R:Promise.reject("At least one rule object was not valid"):Promise.reject("response is missing rules property")).catch(R=>new Promise(S=>setTimeout(S,100/h)).then(()=>l(m,h-1,f,I,R))),c=m=>m.hasOwnProperty("rules"),p=m=>typeof m=="object"&&m!==null,g=m=>p(m)?Object.keys(m).every(h=>{let f=m[h];return typeof f=="object"&&f!==null&&typeof f.main=="boolean"&&typeof f.floorprice=="number"&&typeof f.priceRuleId=="number"}):!1;return{init:s,getPriceRule:a,getBrowser:d,setTargeting:u}};var Tr=t=>{let e="YieldOptimization",i="Provides floors and UPR ids",r="yield",o=null,n=[],s=[],a=()=>o,d=m=>{var h;if((h=m==null?void 0:m.yieldOptimization)!=null&&h.enabled){o=m.yieldOptimization;let f=t!=null?t:Mr(m.yieldOptimization);n.push(p(f)),s.push(g(f))}},u=()=>n,l=()=>[],c=()=>s,p=m=>z("yield-optimization-init",h=>{let f=h.i.slots.filter(I=>h.u.filterSlot(I)).map(I=>I.adUnitPath).filter(Z);return m.init(h.u.getDeviceLabel(),h.m,f,h.e.fetch,h.t)}),g=m=>$("yield-optimization",Ke,(h,f)=>{h.t.debug("YieldOptimizationService",h.g,"applying price rules");let I=h.i.adServer||"gam",C=f.map(R=>m.setTargeting(R.adSlot,I,h.t,o,h.p).then(O=>R.priceRule=O));return Promise.all(C).then(()=>m.getBrowser()).then(R=>{h.r==="production"&&I==="gam"&&h.e.googletag.pubads().setTargeting("upr_browser",R)})});return{name:e,description:i,moduleType:r,i:a,o:d,s:u,a:l,d:c}};window.moli.registerModule(Tr());var xr,Me=(xr=window.document.currentScript)!=null?xr:document.getElementById("moli-ad-tag"),kr,kt=(kr=qe(window,ve.moliPubCode,se.moliPubCode)[0])==null?void 0:kr.value,Or,Ot=(Or=qe(window,ve.moliVersion,se.moliVersion)[0])==null?void 0:Or.value,Br,wr,qr,Dr;if(Me){let t=kt!=null?kt:Me.getAttribute("data-publisher-code"),e=(Br=Ot!=null?Ot:Me.getAttribute("data-version"))!=null?Br:"production",i=((wr=Me.getAttribute("data-labels"))!=null?wr:"").split(",").map(n=>n.trim()).filter(n=>n.length>0);i.length>0&&window.moli.que.push(n=>{n.beforeRequestAds(()=>i.forEach(s=>n.addLabel(s)))}),window.moli.configLabel=e;let r=(qr=Me.getAttribute("data-endpoint"))!=null?qr:"api.h5v.eu/publishers",o=(Dr=Me.getAttribute("data-endpoint-fallback"))!=null?Dr:"cdn.h5v.eu/publishers";if(t){let n=`/${t}/configs/${e}/config.json`,s=`//${r}${n}`;fetch(s,{mode:"cors"}).then(a=>a.json()).catch(a=>(console.error(`Failed to load configuration from ${s}. Using fallback`,a),fetch(`//${o}${n}`,{mode:"cors"}))).then(a=>window.moli.configure(a)).catch(a=>console.error(`Failed to load configuration from ${s}:`,a))}else console.error('No publisher code provided for ad tag configuration! Add the `data-publisher-code="yourCode"` attribute to the script tag.')}else console.error("Failed to find the current script tag for the ad tag bundle!");var Lr='[data-ref="h5v-interstitial"]',Ur='[data-ref="h5v-interstitial-close"]',zr="h5v-interstitial--hidden",_r=(t,e,i)=>new Promise(r=>{let o=n=>{n.slot.getSlotElementId()===t&&(n.isEmpty?r({result:"empty",slot:n.slot}):ie(n,e)?r({result:"disallowed",slot:n.slot}):(n.slot.setConfig({safeFrame:{forceSafeFrame:!0}}),r({result:"standard",slot:n.slot})),i.googletag.pubads().removeEventListener("slotRenderEnded",o))};i.googletag.cmd.push(()=>{i.googletag.pubads().addEventListener("slotRenderEnded",o)})}),Vr=(t,e)=>new Promise(i=>{let r=o=>{o.slot.getSlotElementId()===t&&(i(),e.googletag.pubads().removeEventListener("slotOnload",r))};e.googletag.pubads().addEventListener("slotOnload",r)}),Nr=t=>{t.classList.add(zr)},no=t=>{t.classList.remove(zr)},jr,Fr=(t,e,i,r,o,n)=>{clearTimeout(jr);let s="interstitial-module",a=t.document.querySelector(Lr),d=t.document.querySelector(Ur);if(d&&a){i.debug(s,"Running interstitial module with defined container and close button");let u=()=>{var p;Nr(a);let c=(p=t.googletag)==null?void 0:p.pubads().getSlots().find(g=>g.getSlotElementId()===r);c&&t.googletag.destroySlots([c])};d.addEventListener("click",()=>{u()});let l=({result:c,slot:p})=>{if(i.debug(s,`result ${c}`),c==="disallowed"||c==="empty"||p&&Se(p,t))return i.debug(s,"hide interstitial container"),Nr(a),Promise.resolve();if(c==="standard"){no(a),n&&(jr=t.setTimeout(()=>{u()},n));let g=Vr(r,t);return _r(r,o,t).then(m=>m.result==="empty"||m.result==="disallowed"?Promise.resolve(m):g.then(()=>m)).then(l)}return Promise.resolve()};switch(e){case"production":let c=Vr(r,t);_r(r,o,t).then(p=>p.result==="empty"||p.result==="disallowed"?Promise.resolve(p):c.then(()=>p)).then(l);break;case"test":de("test-interstitial",localStorage)?l({result:"standard",slot:null}):l({result:"empty",slot:null});break;default:i.warn(s,`Unknown environment: ${e}`);break}}else i.warn("[interstitial-module]",`Could not find interstitial container ${Lr} or closeButton ${Ur}`,s,d)};var Gr=()=>{let t=null;return{name:"interstitial-module",description:"interstitial ad creatives",moduleType:"creatives",i(){return t},o(e){e!=null&&e.interstitial&&e.interstitial.enabled&&(t=e.interstitial)},d(){let e=t;return e?[$("interstitial-module",J,(i,r)=>{let o=r.find(n=>n.moliSlot.domId===e.interstitialDomId);return o&&Fr(i.e,i.r,i.t,o.moliSlot.domId,e.disallowedAdvertiserIds,e.closeAutomaticallyAfterMs),Promise.resolve()})]:[]},a(){return[]},s(){return[]}}};window.moli.registerModule(Gr());})();
/*!
 * domready (c) Dustin Diaz 2014 - License MIT
 * @see {@link https://github.com/ded/domready}
 */
